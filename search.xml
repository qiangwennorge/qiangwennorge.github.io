<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Calculate Capital Asset Pricing Model (CAPM) with Python</title>
      <link href="/20240301/calculate-capital-asset-pricing-model-capm-with-python/"/>
      <url>/20240301/calculate-capital-asset-pricing-model-capm-with-python/</url>
      
        <content type="html"><![CDATA[<h2 id="Capital-Asset-Pricing-Model-CAPM"><a href="#Capital-Asset-Pricing-Model-CAPM" class="headerlink" title="Capital Asset Pricing Model (CAPM)"></a>Capital Asset Pricing Model (CAPM)</h2><p>CAPM is one of the most commonly used formula in finance, which describes the relationship betwwen systematic risk and expected return for assets, particularly stocks. The model is based on the relationship between an asset’s beta, the risk-free rate (typically the Treasury bill rate) and the equity risk premium.</p><p>The CAPM formula is as below:</p><p>$$r_i = r_f + \beta_i(r_m - r_f)$$</p><p>Where:</p><ul><li>$r_i$ is the expected return of a security</li><li>$r_f$ is the risk free rate</li><li>$\beta_i$ is the beta of the security relative to the market</li><li>$r_m$ is the market return which includes all securities in the market. A good representation of the U.S. market portfolio is the S&amp;P 500.</li></ul><p>The goal of the CAPM formula is to gauge whether the current price of a stock is consistent with its likely return.</p><p>The beta is a measure of how much risk the investment will add to a portfolio that looks like the market, or a measure of a portfolio’s volatility in relation to the overall market. If beta is less than 1, it indicates the portforlio is less volatile than the market, which means it reduces the risk of a portfolio. On the other hand, if a portforlio is riskier than the market, it will have a betwa greater than 1. </p><h2 id="Load-the-list-of-S-amp-P-500-companies-from-Wikepedia"><a href="#Load-the-list-of-S-amp-P-500-companies-from-Wikepedia" class="headerlink" title="Load the list of S&amp;P 500 companies from Wikepedia"></a>Load the list of S&amp;P 500 companies from Wikepedia</h2><p>S&amp;P 500 is a stock market index tracking the stock performance of 500 of the largest companies listed on stock exchanges in the United States.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the list of S&amp;P 500 stocks from Wikepedia</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    html <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> html<span class="token comment"># Load the list of S&amp;P 500 companies</span>url <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/List_of_S%26P_500_companies'</span>df <span class="token operator">=</span> load_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Symbol</th>      <th>Security</th>      <th>GICS Sector</th>      <th>GICS Sub-Industry</th>      <th>Headquarters Location</th>      <th>Date added</th>      <th>CIK</th>      <th>Founded</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>MMM</td>      <td>3M</td>      <td>Industrials</td>      <td>Industrial Conglomerates</td>      <td>Saint Paul, Minnesota</td>      <td>1957-03-04</td>      <td>66740</td>      <td>1902</td>    </tr>    <tr>      <th>1</th>      <td>AOS</td>      <td>A. O. Smith</td>      <td>Industrials</td>      <td>Building Products</td>      <td>Milwaukee, Wisconsin</td>      <td>2017-07-26</td>      <td>91142</td>      <td>1916</td>    </tr>    <tr>      <th>2</th>      <td>ABT</td>      <td>Abbott</td>      <td>Health Care</td>      <td>Health Care Equipment</td>      <td>North Chicago, Illinois</td>      <td>1957-03-04</td>      <td>1800</td>      <td>1888</td>    </tr>    <tr>      <th>3</th>      <td>ABBV</td>      <td>AbbVie</td>      <td>Health Care</td>      <td>Biotechnology</td>      <td>North Chicago, Illinois</td>      <td>2012-12-31</td>      <td>1551152</td>      <td>2013 (1888)</td>    </tr>    <tr>      <th>4</th>      <td>ACN</td>      <td>Accenture</td>      <td>Information Technology</td>      <td>IT Consulting &amp; Other Services</td>      <td>Dublin, Ireland</td>      <td>2011-07-06</td>      <td>1467373</td>      <td>1989</td>    </tr>  </tbody></table></div><h2 id="Retrieve-the-latest-stock-price-using-yfinance"><a href="#Retrieve-the-latest-stock-price-using-yfinance" class="headerlink" title="Retrieve the latest stock price using yfinance"></a>Retrieve the latest stock price using yfinance</h2><p>We retrieve the latest year’s stock price using yfinance.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yfdata <span class="token operator">=</span> yf<span class="token punctuation">.</span>download<span class="token punctuation">(</span>            <span class="token comment"># tickers list</span>            tickers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'^GSPC'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token comment"># valid periods: 1d, 5d, 1mo, 3mo, 6mo, 1y, 5y, 10y, ytd, max</span>            period <span class="token operator">=</span> <span class="token string">'1y'</span><span class="token punctuation">,</span>            <span class="token comment"># valid intervals: 1m, 2m, 5m, 15m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo</span>            interval <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># group by ticker</span>            group_by <span class="token operator">=</span> <span class="token string">'ticker'</span><span class="token punctuation">,</span>            <span class="token comment"># adjust all OHLC automatically</span>            auto_adjust <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># download pre/post regular market hours data</span>            prepost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># use threads for mass downloading</span>            threads <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># proxy URL scheme when downloading</span>            proxy <span class="token operator">=</span> <span class="token boolean">None</span>            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[*********************100%%**********************]  504 of 504 completed2 Failed downloads:['BF.B']: Exception('%ticker%: No price data found, symbol may be delisted (period=1y)')['BRK.B']: Exception('%ticker%: No data found, symbol may be delisted')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">'^GSPC'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>Price</th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2023-02-27</th>      <td>3992.360107</td>      <td>4018.050049</td>      <td>3973.550049</td>      <td>3982.239990</td>      <td>3836950000</td>    </tr>    <tr>      <th>2023-02-28</th>      <td>3977.189941</td>      <td>3997.500000</td>      <td>3968.979980</td>      <td>3970.149902</td>      <td>5043400000</td>    </tr>    <tr>      <th>2023-03-01</th>      <td>3963.340088</td>      <td>3971.729980</td>      <td>3939.050049</td>      <td>3951.389893</td>      <td>4249480000</td>    </tr>    <tr>      <th>2023-03-02</th>      <td>3938.679932</td>      <td>3990.840088</td>      <td>3928.159912</td>      <td>3981.350098</td>      <td>4244900000</td>    </tr>    <tr>      <th>2023-03-03</th>      <td>3998.020020</td>      <td>4048.290039</td>      <td>3995.169922</td>      <td>4045.639893</td>      <td>4084730000</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the available tickers</span>tickers_unavailable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'BF.B'</span><span class="token punctuation">,</span> <span class="token string">'BRK.B'</span><span class="token punctuation">]</span>tickers <span class="token operator">=</span> <span class="token punctuation">[</span>ticker <span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'^GSPC'</span><span class="token punctuation">]</span> <span class="token keyword">if</span> ticker <span class="token keyword">not</span> <span class="token keyword">in</span> tickers_unavailable<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Number of available tickers: '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Number of available tickers:  502</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Use Close as the price for each stock and create a new dataframe to store this data.</span><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npstock <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'MMM'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ticker <span class="token operator">=</span> tickers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    stock <span class="token operator">=</span> stock<span class="token punctuation">.</span>join<span class="token punctuation">(</span>             pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>                 data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                  name<span class="token operator">=</span>ticker<span class="token punctuation">,</span>                 index<span class="token operator">=</span>stock<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>stock <span class="token operator">=</span> stock<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">)</span>stock<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>MMM</th>      <th>AOS</th>      <th>ABT</th>      <th>ABBV</th>      <th>ACN</th>      <th>ADBE</th>      <th>AMD</th>      <th>AES</th>      <th>AFL</th>      <th>A</th>      <th>...</th>      <th>GWW</th>      <th>WYNN</th>      <th>XEL</th>      <th>XYL</th>      <th>YUM</th>      <th>ZBRA</th>      <th>ZBH</th>      <th>ZION</th>      <th>ZTS</th>      <th>^GSPC</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2023-02-27</th>      <td>101.759285</td>      <td>64.206650</td>      <td>97.783730</td>      <td>148.282318</td>      <td>262.200623</td>      <td>322.320007</td>      <td>78.769997</td>      <td>23.996420</td>      <td>66.643791</td>      <td>141.154373</td>      <td>...</td>      <td>668.472412</td>      <td>104.074387</td>      <td>63.236515</td>      <td>101.250412</td>      <td>124.182861</td>      <td>296.230011</td>      <td>122.350578</td>      <td>47.859604</td>      <td>163.987595</td>      <td>3982.239990</td>    </tr>    <tr>      <th>2023-02-28</th>      <td>101.261154</td>      <td>64.511368</td>      <td>99.694916</td>      <td>147.917068</td>      <td>261.511230</td>      <td>323.950012</td>      <td>78.580002</td>      <td>23.803526</td>      <td>66.565651</td>      <td>140.945908</td>      <td>...</td>      <td>661.946350</td>      <td>107.271660</td>      <td>62.433975</td>      <td>101.349144</td>      <td>124.761726</td>      <td>300.250000</td>      <td>122.916191</td>      <td>48.078060</td>      <td>165.503891</td>      <td>3970.149902</td>    </tr>    <tr>      <th>2023-03-01</th>      <td>103.582634</td>      <td>65.631935</td>      <td>98.822639</td>      <td>149.233841</td>      <td>259.581085</td>      <td>323.380005</td>      <td>78.290001</td>      <td>23.755301</td>      <td>66.536346</td>      <td>136.518066</td>      <td>...</td>      <td>664.501221</td>      <td>111.082634</td>      <td>61.176975</td>      <td>99.808891</td>      <td>123.819832</td>      <td>302.339996</td>      <td>121.139977</td>      <td>47.907097</td>      <td>166.068771</td>      <td>3951.389893</td>    </tr>    <tr>      <th>2023-03-02</th>      <td>103.291267</td>      <td>66.487114</td>      <td>100.586800</td>      <td>148.378433</td>      <td>261.225677</td>      <td>333.500000</td>      <td>80.440002</td>      <td>23.764944</td>      <td>65.989365</td>      <td>140.648071</td>      <td>...</td>      <td>677.860413</td>      <td>112.260574</td>      <td>62.211575</td>      <td>100.954201</td>      <td>126.253059</td>      <td>306.059998</td>      <td>122.042961</td>      <td>45.884064</td>      <td>167.069748</td>      <td>3981.350098</td>    </tr>    <tr>      <th>2023-03-03</th>      <td>104.569481</td>      <td>66.968750</td>      <td>102.370560</td>      <td>149.993103</td>      <td>265.105774</td>      <td>344.040009</td>      <td>81.519997</td>      <td>24.208611</td>      <td>66.848907</td>      <td>142.891754</td>      <td>...</td>      <td>690.823425</td>      <td>114.656044</td>      <td>62.946434</td>      <td>102.603035</td>      <td>127.224380</td>      <td>309.450012</td>      <td>125.248100</td>      <td>46.757858</td>      <td>169.031982</td>      <td>4045.639893</td>    </tr>  </tbody></table><p>5 rows × 502 columns</p></div><h2 id="Normalize-and-visualize-the-stock-data"><a href="#Normalize-and-visualize-the-stock-data" class="headerlink" title="Normalize and visualize the stock data"></a>Normalize and visualize the stock data</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Normalize stock data based on initial price</span><span class="token keyword">def</span> <span class="token function">normalize</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> xstock_normalized <span class="token operator">=</span> normalize<span class="token punctuation">(</span>stock<span class="token punctuation">)</span>stock_normalized<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>MMM</th>      <th>AOS</th>      <th>ABT</th>      <th>ABBV</th>      <th>ACN</th>      <th>ADBE</th>      <th>AMD</th>      <th>AES</th>      <th>AFL</th>      <th>A</th>      <th>...</th>      <th>GWW</th>      <th>WYNN</th>      <th>XEL</th>      <th>XYL</th>      <th>YUM</th>      <th>ZBRA</th>      <th>ZBH</th>      <th>ZION</th>      <th>ZTS</th>      <th>^GSPC</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2023-02-27</th>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>...</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>    </tr>    <tr>      <th>2023-02-28</th>      <td>0.995105</td>      <td>1.004746</td>      <td>1.019545</td>      <td>0.997537</td>      <td>0.997371</td>      <td>1.005057</td>      <td>0.997588</td>      <td>0.991962</td>      <td>0.998827</td>      <td>0.998523</td>      <td>...</td>      <td>0.990237</td>      <td>1.030721</td>      <td>0.987309</td>      <td>1.000975</td>      <td>1.004661</td>      <td>1.013570</td>      <td>1.004623</td>      <td>1.004565</td>      <td>1.009246</td>      <td>0.996964</td>    </tr>    <tr>      <th>2023-03-01</th>      <td>1.017918</td>      <td>1.022198</td>      <td>1.010625</td>      <td>1.006417</td>      <td>0.990009</td>      <td>1.003289</td>      <td>0.993906</td>      <td>0.989952</td>      <td>0.998388</td>      <td>0.967154</td>      <td>...</td>      <td>0.994059</td>      <td>1.067339</td>      <td>0.967431</td>      <td>0.985763</td>      <td>0.997077</td>      <td>1.020626</td>      <td>0.990105</td>      <td>1.000992</td>      <td>1.012691</td>      <td>0.992253</td>    </tr>    <tr>      <th>2023-03-02</th>      <td>1.015055</td>      <td>1.035518</td>      <td>1.028666</td>      <td>1.000648</td>      <td>0.996282</td>      <td>1.034686</td>      <td>1.021201</td>      <td>0.990354</td>      <td>0.990180</td>      <td>0.996413</td>      <td>...</td>      <td>1.014044</td>      <td>1.078657</td>      <td>0.983792</td>      <td>0.997074</td>      <td>1.016671</td>      <td>1.033184</td>      <td>0.997486</td>      <td>0.958722</td>      <td>1.018795</td>      <td>0.999777</td>    </tr>    <tr>      <th>2023-03-03</th>      <td>1.027616</td>      <td>1.043019</td>      <td>1.046908</td>      <td>1.011537</td>      <td>1.011080</td>      <td>1.067386</td>      <td>1.034912</td>      <td>1.008843</td>      <td>1.003078</td>      <td>1.012308</td>      <td>...</td>      <td>1.033436</td>      <td>1.101674</td>      <td>0.995413</td>      <td>1.013359</td>      <td>1.024492</td>      <td>1.044627</td>      <td>1.023682</td>      <td>0.976980</td>      <td>1.030761</td>      <td>1.015921</td>    </tr>  </tbody></table><p>5 rows × 502 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Plot the normalized price of several selected stocks</span><span class="token keyword">import</span> plotly<span class="token punctuation">.</span>express <span class="token keyword">as</span> pxfig <span class="token operator">=</span> px<span class="token punctuation">.</span>line<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">'Normalized Prices'</span><span class="token punctuation">)</span><span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'AMD'</span><span class="token punctuation">,</span><span class="token string">'AAPL'</span><span class="token punctuation">,</span><span class="token string">'GOOG'</span><span class="token punctuation">,</span> <span class="token string">'TSLA'</span><span class="token punctuation">,</span><span class="token string">'IBM'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>stock_normalized<span class="token punctuation">.</span>index<span class="token punctuation">,</span> y<span class="token operator">=</span>stock_normalized<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span>ticker<span class="token punctuation">)</span>fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Calculate-Capital-Asset-Pricing-Model-CAPM-with-Pythonnormalized-price.png" alt="Normalized Price"></p><h2 id="Calculate-the-daily-return"><a href="#Calculate-the-daily-return" class="headerlink" title="Calculate the daily return"></a>Calculate the daily return</h2><p>The daily return for each stock is calculated as follows:</p><ul><li>Loop to each row of the stock normalized price</li><li>Calculate the percentage change from the previous day</li><li>The first row is set to 0 as there is no previous value</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">daily_return</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>    df_daily_return <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            df_daily_return<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span> df<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>df<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>        df_daily_return<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">return</span> df_daily_returnstock_daily_return <span class="token operator">=</span> daily_return<span class="token punctuation">(</span>stock_normalized<span class="token punctuation">)</span>stock_daily_return<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>MMM</th>      <th>AOS</th>      <th>ABT</th>      <th>ABBV</th>      <th>ACN</th>      <th>ADBE</th>      <th>AMD</th>      <th>AES</th>      <th>AFL</th>      <th>A</th>      <th>...</th>      <th>GWW</th>      <th>WYNN</th>      <th>XEL</th>      <th>XYL</th>      <th>YUM</th>      <th>ZBRA</th>      <th>ZBH</th>      <th>ZION</th>      <th>ZTS</th>      <th>^GSPC</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2023-02-27</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>...</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.000000</td>    </tr>    <tr>      <th>2023-02-28</th>      <td>-0.489519</td>      <td>0.474589</td>      <td>1.954503</td>      <td>-0.246320</td>      <td>-0.262925</td>      <td>0.505710</td>      <td>-0.241202</td>      <td>-0.803845</td>      <td>-0.117251</td>      <td>-0.147686</td>      <td>...</td>      <td>-0.976265</td>      <td>3.072104</td>      <td>-1.269108</td>      <td>0.097513</td>      <td>0.466139</td>      <td>1.357050</td>      <td>0.462289</td>      <td>0.456452</td>      <td>0.924641</td>      <td>-0.303600</td>    </tr>    <tr>      <th>2023-03-01</th>      <td>2.292567</td>      <td>1.737008</td>      <td>-0.874946</td>      <td>0.890210</td>      <td>-0.738074</td>      <td>-0.175955</td>      <td>-0.369052</td>      <td>-0.202598</td>      <td>-0.044023</td>      <td>-3.141518</td>      <td>...</td>      <td>0.385963</td>      <td>3.552638</td>      <td>-2.013327</td>      <td>-1.519749</td>      <td>-0.754955</td>      <td>0.696085</td>      <td>-1.445062</td>      <td>-0.355595</td>      <td>0.341309</td>      <td>-0.472526</td>    </tr>    <tr>      <th>2023-03-02</th>      <td>-0.281289</td>      <td>1.302992</td>      <td>1.785178</td>      <td>-0.573200</td>      <td>0.633556</td>      <td>3.129444</td>      <td>2.746202</td>      <td>0.040595</td>      <td>-0.822080</td>      <td>3.025244</td>      <td>...</td>      <td>2.010409</td>      <td>1.060418</td>      <td>1.691158</td>      <td>1.147502</td>      <td>1.965136</td>      <td>1.230403</td>      <td>0.745406</td>      <td>-4.222826</td>      <td>0.602748</td>      <td>0.758219</td>    </tr>    <tr>      <th>2023-03-03</th>      <td>1.237485</td>      <td>0.724405</td>      <td>1.773354</td>      <td>1.088211</td>      <td>1.485343</td>      <td>3.160422</td>      <td>1.342608</td>      <td>1.866895</td>      <td>1.302548</td>      <td>1.595246</td>      <td>...</td>      <td>1.912342</td>      <td>2.133848</td>      <td>1.181226</td>      <td>1.633250</td>      <td>0.769345</td>      <td>1.107631</td>      <td>2.626238</td>      <td>1.904353</td>      <td>1.174500</td>      <td>1.614774</td>    </tr>  </tbody></table><p>5 rows × 502 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Plot the daily return for the selected stocks</span>fig <span class="token operator">=</span> px<span class="token punctuation">.</span>line<span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">'Daily Return'</span><span class="token punctuation">)</span><span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'AMD'</span><span class="token punctuation">,</span><span class="token string">'AAPL'</span><span class="token punctuation">,</span><span class="token string">'GOOG'</span><span class="token punctuation">,</span> <span class="token string">'TSLA'</span><span class="token punctuation">,</span><span class="token string">'IBM'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    fig<span class="token punctuation">.</span>add_scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>stock_daily_return<span class="token punctuation">.</span>index<span class="token punctuation">,</span> y<span class="token operator">=</span>stock_daily_return<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span>ticker<span class="token punctuation">)</span>fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Calculate-Capital-Asset-Pricing-Model-CAPM-with-Python-daily-return.png" alt="Daily Return"></p><h2 id="Calculate-Beta-for-AAPL"><a href="#Calculate-Beta-for-AAPL" class="headerlink" title="Calculate Beta for AAPL"></a>Calculate Beta for AAPL</h2><p>Beta is the slope of the line regression line, or the market return vs. stock return, which could be calculated using np.polyfit</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># S&amp;P 500 has ticker symbol ^GSPC</span>beta<span class="token punctuation">,</span> alpha <span class="token operator">=</span> np<span class="token punctuation">.</span>polyfit<span class="token punctuation">(</span>stock_daily_return<span class="token punctuation">[</span><span class="token string">'^GSPC'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stock_daily_return<span class="token punctuation">[</span><span class="token string">'AAPL'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>beta<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>1.0716621967198638</code></pre><h2 id="Calculate-CAPM-for-AAPL"><a href="#Calculate-CAPM-for-AAPL" class="headerlink" title="Calculate CAPM for AAPL"></a>Calculate CAPM for AAPL</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Daily return for the market</span>stock_daily_return<span class="token punctuation">[</span><span class="token string">'^GSPC'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.09994347738081993</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Annual return for the market would be the daily return multiply the number of trading days in a year</span>r_m <span class="token operator">=</span> stock_daily_return<span class="token punctuation">[</span><span class="token string">'^GSPC'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">252</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Return of the market: '</span><span class="token punctuation">,</span> r_m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>Return of the market:  25.185756299966624</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Expected return could be calculated using CAPM formula</span><span class="token comment"># Assume the risk free rate rate is 0</span>r_f <span class="token operator">=</span> <span class="token number">0</span>r_e_AAPL <span class="token operator">=</span> r_f <span class="token operator">+</span> beta <span class="token operator">*</span> <span class="token punctuation">(</span>r_m <span class="token operator">-</span> r_f<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Expected return: '</span><span class="token punctuation">,</span> r_e_AAPL<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Expected return:  26.99062292247338</code></pre><p>Apparently this is not realistic.</p><ul><li>The markets are very competitive and efficient, investors who work in the markets are rational and risk-averse. Everything can change very fast.</li></ul><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p><a href="https://www.investopedia.com/terms/c/capm.asp">https://www.investopedia.com/terms/c/capm.asp</a></p><p><a href="https://www.mlq.ai/capital-asset-pricing-model-python/">https://www.mlq.ai/capital-asset-pricing-model-python/</a></p>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yfinance </tag>
            
            <tag> plotly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Building a quantitative value investing strategy</title>
      <link href="/20240228/building-a-quantitative-value-investing-strategy/"/>
      <url>/20240228/building-a-quantitative-value-investing-strategy/</url>
      
        <content type="html"><![CDATA[<h2 id="Quantitative-Value-Strategy"><a href="#Quantitative-Value-Strategy" class="headerlink" title="Quantitative Value Strategy"></a>Quantitative Value Strategy</h2><p>Quantitative value intestment means invest in the stocks that are “cheapest” relative to common measures of business value (like earnings or assets), which focuses on identifying undervalued assets and purchasing them at a price below their intrinsic value (true worth), this strategy is a cornerstone of successful long-term investing.</p><ul><li><strong>Intrinsic value</strong>: the price level that reflects the actual worth or value of the company</li><li><strong>Margin of safety</strong>: the difference between purchase value and the true value</li></ul><p>Quantitative value investing relies on various financial ratios to assess the value of potential investments, here below are the commonly used ratios in quantitative value investing.</p><ul><li><strong>Price-to-Earnings (P/E) Ratio</strong>: a lower P/E ratio is often seen as an indicator of undervaluation.</li><li><strong>Return on Equity (ROE)</strong>: a higher ROE is generally desirable.</li><li><strong>Price-to-book (P/B) Ratio</strong>: a P/B ratio below 1 can suggest that a stock is undervalued.</li><li><strong>Price-to-Sales (P/S) Ratio</strong>: a lower P/S ratio can indicate undervaluation.</li><li><strong>Price-to-Cash Flow (P/CF) Ratio</strong>: a lower P/CF ratio may indicate that the stock is undervalued. It reflects how much cash the company generates relative to its stock price.</li><li><strong>Dividend Yield</strong>: it measures the annual dividends paid by a company as a percentage of its stock price, therefore a higher dividend yield may be attractive to income-focused investors.</li><li><strong>Earnings Yield</strong>: it is the inverse of the P/E ratio. It’s a measure of how much a company earns in relation to its stock price.</li><li><strong>Debt-to-Equity (D/E) Ratio</strong>: a lower D/E ratio indicates lower financial risk.</li><li><strong>Current Ratio</strong>: it measures a company’s ability to cover its short-term liabilities with its short-term assets. A higher current ratio is often preferred.</li><li><strong>Free Cash Flow (FCF) Yield</strong>: it compares a company’s free cash flow to its market capitalisation. A higher FCF yield can indicate value and financial health.</li><li><strong>Enterprise Value divided by Earnings Before Interest, Taxes, Depreciation, and Amortization (EV/EBITDA)</strong>, it takes into account a company’s debt and cash levels in addition to its stock price and relates that value to the firm’s cash profitability. Higher enterprise multiples are expected in high-growth industries and lower multiples in industries with slow growth.</li><li><strong>Enterprise Value divided by Gross Profit (EV/GP)</strong>, it is a profitability financial ratio that estimates the enterprise value of a company to its gross profit. Generally, the lower the ratio, the lower is the company’s net worth.</li></ul><p>The goal of this section is trying to create an investing strategy following the instruction on <a href="https://github.com/nickmccullum/algorithmic-trading-python/tree/master">https://github.com/nickmccullum/algorithmic-trading-python/tree/master</a>, with this strategy it selects the 50 stocks in S&amp;P 600 list with the highest value metric (we start with P/E ratio). From there, the trades with an equal-weight portfolio of these 50 stocks will be calculated.</p><h2 id="Load-the-list-of-S-amp-P-600-companies-from-Wikepedia"><a href="#Load-the-list-of-S-amp-P-600-companies-from-Wikepedia" class="headerlink" title="Load the list of S&amp;P 600 companies from Wikepedia"></a>Load the list of S&amp;P 600 companies from Wikepedia</h2><p>The S&amp;P 600 is an index of small-cap company stocks created by Standard &amp; Poor’s, selected by a committee based on recent profitability and other factors.</p><p>Currently there are 3 S&amp;P Small Cap 600 ETFs traded on the U.S. markets, the largest one is iShares S&amp;P Small-Cap 600 Value ETF IJS with around 7.09 Billon USD in assets.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the list of S&amp;P 600 stocks from Wikepedia</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    html <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> html<span class="token comment"># Load the list of S&amp;P 600 companies</span>url <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/List_of_S%26P_600_companies'</span>df <span class="token operator">=</span> load_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Symbol</th>      <th>Company</th>      <th>GICS Sector</th>      <th>GICS Sub-Industry</th>      <th>Headquarters Location</th>      <th>SEC filings</th>      <th>CIK</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AAON</td>      <td>AAON, Inc.</td>      <td>Industrials</td>      <td>Building Products</td>      <td>Tulsa, Oklahoma</td>      <td>view</td>      <td>824142</td>    </tr>    <tr>      <th>1</th>      <td>AAP</td>      <td>Advance Auto Parts, Inc.</td>      <td>Consumer Discretionary</td>      <td>Automotive Retail</td>      <td>Raleigh, North Carolina</td>      <td>view</td>      <td>1158449</td>    </tr>    <tr>      <th>2</th>      <td>AAT</td>      <td>American Assets Trust</td>      <td>Real Estate</td>      <td>Diversified REITs</td>      <td>San Diego, California</td>      <td>view</td>      <td>1500217</td>    </tr>    <tr>      <th>3</th>      <td>ABCB</td>      <td>Ameris Bancorp</td>      <td>Financials</td>      <td>Regional Banks</td>      <td>Atlanta, Georgia</td>      <td>view</td>      <td>351569</td>    </tr>    <tr>      <th>4</th>      <td>ABG</td>      <td>Asbury Automotive Group</td>      <td>Consumer Discretionary</td>      <td>Automotive Retail</td>      <td>Duluth, Georgia</td>      <td>view</td>      <td>1144980</td>    </tr>  </tbody></table></div><h2 id="Retrieve-the-latest-stock-info-using-yfinance"><a href="#Retrieve-the-latest-stock-info-using-yfinance" class="headerlink" title="Retrieve the latest stock info using yfinance"></a>Retrieve the latest stock info using yfinance</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf<span class="token keyword">def</span> <span class="token function">retrieveQuote</span><span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">:</span>    stock_dict <span class="token operator">=</span> yf<span class="token punctuation">.</span>Ticker<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">.</span>info    stock <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">.</span>from_dict<span class="token punctuation">(</span>stock_dict<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span>    stock <span class="token operator">=</span> stock<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>    stock <span class="token operator">=</span> stock<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'index'</span><span class="token punctuation">:</span> <span class="token string">'Item'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'Value'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>     <span class="token keyword">return</span> stock<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="P-E-Ratio"><a href="#P-E-Ratio" class="headerlink" title="P/E Ratio"></a>P/E Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'trailingPE'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>40</th>      <td>trailingPE</td>      <td>41.000004</td>    </tr>  </tbody></table></div><h3 id="Return-on-Equity-ROE"><a href="#Return-on-Equity-ROE" class="headerlink" title="Return on Equity (ROE)"></a>Return on Equity (ROE)</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token string">'returnOnEquity'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>122</th>      <td>returnOnEquity</td>      <td>0.28097</td>    </tr>  </tbody></table></div><h3 id="P-B-Ratio"><a href="#P-B-Ratio" class="headerlink" title="P/B Ratio"></a>P/B Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'priceToBook'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>70</th>      <td>priceToBook</td>      <td>10.003571</td>    </tr>  </tbody></table></div><h3 id="P-S-Ratio"><a href="#P-S-Ratio" class="headerlink" title="P/S Ratio"></a>P/S Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'priceToSalesTrailing12Months'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>54</th>      <td>priceToSalesTrailing12Months</td>      <td>6.116228</td>    </tr>  </tbody></table></div><h3 id="Price-to-Cash-Flow-P-CF-Ratio"><a href="#Price-to-Cash-Flow-P-CF-Ratio" class="headerlink" title="Price-to-Cash Flow (P/CF) Ratio"></a>Price-to-Cash Flow (P/CF) Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">price <span class="token operator">=</span> yf<span class="token punctuation">.</span>Ticker<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>history<span class="token punctuation">(</span>period<span class="token operator">=</span><span class="token string">'1d'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>price<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>84.05000305175781</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'totalCashPerShare'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>113</th>      <td>totalCashPerShare</td>      <td>0.035</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Price-to-Cash Flow (P/CF) Ratio for AAON is: '</span><span class="token punctuation">,</span> price<span class="token operator">/</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'totalCashPerShare'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>Price-to-Cash Flow (P/CF) Ratio for AAON is:  2401.4286586216517</code></pre><h3 id="EV-EBITDA"><a href="#EV-EBITDA" class="headerlink" title="EV/EBITDA"></a>EV/EBITDA</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'enterpriseToEbitda'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>87</th>      <td>enterpriseToEbitda</td>      <td>26.208</td>    </tr>  </tbody></table></div><h3 id="Dividend-Yield"><a href="#Dividend-Yield" class="headerlink" title="Dividend Yield"></a>Dividend Yield</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'dividendYield'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>35</th>      <td>dividendYield</td>      <td>0.0038</td>    </tr>  </tbody></table></div><h3 id="Debt-to-Equity-D-E-Ratio"><a href="#Debt-to-Equity-D-E-Ratio" class="headerlink" title="Debt-to-Equity (D/E) Ratio"></a>Debt-to-Equity (D/E) Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'debtToEquity'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>119</th>      <td>debtToEquity</td>      <td>8.581</td>    </tr>  </tbody></table></div><h3 id="Current-Ratio"><a href="#Current-Ratio" class="headerlink" title="Current Ratio"></a>Current Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'currentRatio'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>117</th>      <td>currentRatio</td>      <td>3.027</td>    </tr>  </tbody></table></div><h3 id="Free-Cash-Flow-FCF-Yield"><a href="#Free-Cash-Flow-FCF-Yield" class="headerlink" title="Free Cash Flow (FCF) Yield"></a>Free Cash Flow (FCF) Yield</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'freeCashflow'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>123</th>      <td>freeCashflow</td>      <td>16578000</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'marketCap'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>51</th>      <td>marketCap</td>      <td>6828633600</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"FCF Yield for AAON is: "</span><span class="token punctuation">,</span> retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'freeCashflow'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'marketCap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>FCF Yield for AAON is:  0.002427718482362269</code></pre><h2 id="Retrieve-the-latest-stock-price-using-yfinance"><a href="#Retrieve-the-latest-stock-price-using-yfinance" class="headerlink" title="Retrieve the latest stock price using yfinance"></a>Retrieve the latest stock price using yfinance</h2><p>We retrieve the latest day’s stock price using yfinance.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>data <span class="token operator">=</span> yf<span class="token punctuation">.</span>download<span class="token punctuation">(</span>            <span class="token comment"># tickers list</span>            tickers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token comment"># valid periods: 1d, 5d, 1mo, 3mo, 6mo, 1y, 5y, 10y, ytd, max</span>            period <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># valid intervals: 1m, 2m, 5m, 15m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo</span>            interval <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># group by ticker</span>            group_by <span class="token operator">=</span> <span class="token string">'ticker'</span><span class="token punctuation">,</span>            <span class="token comment"># adjust all OHLC automatically</span>            auto_adjust <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># download pre/post regular market hours data</span>            prepost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># use threads for mass downloading</span>            threads <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># proxy URL scheme when downloading</span>            proxy <span class="token operator">=</span> <span class="token boolean">None</span>            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[*********************100%%**********************]  602 of 602 completed2 Failed downloads:['MOG.A', 'CWEN.A']: Exception('%ticker%: No data found, symbol may be delisted')</code></pre><h2 id="Calculate-PE-ratio-and-remove-the-highest-PE-ratio-stocks"><a href="#Calculate-PE-ratio-and-remove-the-highest-PE-ratio-stocks" class="headerlink" title="Calculate PE ratio and remove the highest PE ratio stocks"></a>Calculate PE ratio and remove the highest PE ratio stocks</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the available tickers</span>tickers_unavailable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'MOG.A'</span><span class="token punctuation">,</span> <span class="token string">'CWEN.A'</span><span class="token punctuation">]</span>tickers <span class="token operator">=</span> <span class="token punctuation">[</span>ticker <span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> ticker <span class="token keyword">not</span> <span class="token keyword">in</span> tickers_unavailable<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Number of available tickers: '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Number of available tickers:  600</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Create the format of the dataframe that stores the stock price, market cap and number of shares to buy</span>my_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> <span class="token string">'Price'</span><span class="token punctuation">,</span> <span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">,</span> <span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">]</span>final_dataframe <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> my_columns<span class="token punctuation">)</span>final_dataframe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>Price-to-Earnings Ratio</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Input the value of the portforlio, i.e. example here is 1M USD</span>portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>    val <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span><span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"That's not a number! \n Try again:"</span><span class="token punctuation">)</span>    portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Enter the value of your portfolio:1000000</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Retrieve the PE ratio</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ticker <span class="token operator">=</span> tickers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        trailingPE <span class="token operator">=</span> retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'trailingPE'</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> trailingPE<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        pe_ratio <span class="token operator">=</span> retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'trailingPE'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        pe_ratio <span class="token operator">=</span> <span class="token string">"NA"</span>    final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">.</span>append<span class="token punctuation">(</span>            pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>            <span class="token punctuation">[</span>                ticker<span class="token punctuation">,</span>                data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                pe_ratio<span class="token punctuation">,</span>                <span class="token string">'NA'</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>                index <span class="token operator">=</span> my_columns<span class="token punctuation">)</span><span class="token punctuation">,</span>                ignore_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>Price-to-Earnings Ratio</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AAON</td>      <td>84.050003</td>      <td>41.000004</td>      <td>NA</td>    </tr>    <tr>      <th>1</th>      <td>AAP</td>      <td>61.099998</td>      <td>17.761627</td>      <td>NA</td>    </tr>    <tr>      <th>2</th>      <td>AAT</td>      <td>21.530001</td>      <td>25.630955</td>      <td>NA</td>    </tr>    <tr>      <th>3</th>      <td>ABCB</td>      <td>45.880001</td>      <td>11.794345</td>      <td>NA</td>    </tr>    <tr>      <th>4</th>      <td>ABG</td>      <td>214.619995</td>      <td>7.467641</td>      <td>NA</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># remove none PE ratio stocks</span>final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span>final_dataframe<span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'NA'</span><span class="token punctuation">]</span>final_dataframe<span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">]</span> <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Remove the high stocks, only keep the lowest 50</span>final_dataframe<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span>final_dataframe<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>Price-to-Earnings Ratio</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>VTLE</td>      <td>46.610001</td>      <td>1.393840</td>      <td>NA</td>    </tr>    <tr>      <th>1</th>      <td>BFH</td>      <td>36.779999</td>      <td>2.495251</td>      <td>NA</td>    </tr>    <tr>      <th>2</th>      <td>AMCX</td>      <td>12.430000</td>      <td>2.536735</td>      <td>NA</td>    </tr>    <tr>      <th>3</th>      <td>CPE</td>      <td>31.280001</td>      <td>3.039845</td>      <td>NA</td>    </tr>    <tr>      <th>4</th>      <td>CCOI</td>      <td>78.790001</td>      <td>3.492465</td>      <td>NA</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Calculate the number of shares to buy</span><span class="token keyword">import</span> mathposition_size <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>final_dataframe<span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    final_dataframe<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>position_size <span class="token operator">/</span> final_dataframe<span class="token punctuation">[</span><span class="token string">'Price'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>Price-to-Earnings Ratio</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>VTLE</td>      <td>46.610001</td>      <td>1.393840</td>      <td>35</td>    </tr>    <tr>      <th>1</th>      <td>BFH</td>      <td>36.779999</td>      <td>2.495251</td>      <td>45</td>    </tr>    <tr>      <th>2</th>      <td>AMCX</td>      <td>12.430000</td>      <td>2.536735</td>      <td>134</td>    </tr>    <tr>      <th>3</th>      <td>CPE</td>      <td>31.280001</td>      <td>3.039845</td>      <td>53</td>    </tr>    <tr>      <th>4</th>      <td>CCOI</td>      <td>78.790001</td>      <td>3.492465</td>      <td>21</td>    </tr>  </tbody></table></div><h2 id="Save-the-output-in-Excel-using-XlsxWriter"><a href="#Save-the-output-in-Excel-using-XlsxWriter" class="headerlink" title="Save the output in Excel using XlsxWriter"></a>Save the output in Excel using XlsxWriter</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Initiate the XlsxWriter object, save the output in xlsx format.</span><span class="token keyword">import</span> xlsxwriterwriter <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'quantitative value.xlsx'</span><span class="token punctuation">,</span> engine <span class="token operator">=</span> <span class="token string">'xlsxwriter'</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token string">'Recommended Trades'</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Create-the-formats"><a href="#Create-the-formats" class="headerlink" title="Create the formats:"></a>Create the formats:</h3><ul><li>String format for tickers</li><li>$xx.xx format for stock prices</li><li>$xx,xxx for market capitalization</li><li>Integer format for the number of shares to buy</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">background_color <span class="token operator">=</span> <span class="token string">'#0a0a23'</span>font_color <span class="token operator">=</span> <span class="token string">'#ffffff'</span>string_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>dollar_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$0.00'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>capital_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$#,##0'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>integer_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>float_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0.000'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>percent_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0.0%'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Apply the formats to the columns of the output file</span>column_formats <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> string_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Stock Price'</span><span class="token punctuation">,</span> dollar_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">,</span> float_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">,</span> integer_format<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">for</span> column <span class="token keyword">in</span> column_formats<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_column<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">1'</span></span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> string_format<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Save the output</span>writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yfinance </tag>
            
            <tag> xlsxwriter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Building a quantitative momentum investing strategy</title>
      <link href="/20240226/building-a-quantitative-momentum-investing-strategy/"/>
      <url>/20240226/building-a-quantitative-momentum-investing-strategy/</url>
      
        <content type="html"><![CDATA[<h2 id="Quantitative-Momentum-Strategy"><a href="#Quantitative-Momentum-Strategy" class="headerlink" title="Quantitative Momentum Strategy"></a>Quantitative Momentum Strategy</h2><p>Quantitative Momentum is an investment strategy which selects for investment the stocks whose price appreciated the most during a period (usually the recent year, ignoring the most recent month). </p><p>The goal of this section is trying to create an investing strategy following the instruction on <a href="https://github.com/nickmccullum/algorithmic-trading-python/tree/master">https://github.com/nickmccullum/algorithmic-trading-python/tree/master</a>, with this strategy it selects the 50 stocks in S&amp;P 600 list with the highest price momentum. From there, the trades with an equal-weight portfolio of these 50 stocks will be calculated.</p><h2 id="Load-the-list-of-S-amp-P-600-companies-from-Wikepedia"><a href="#Load-the-list-of-S-amp-P-600-companies-from-Wikepedia" class="headerlink" title="Load the list of S&amp;P 600 companies from Wikepedia"></a>Load the list of S&amp;P 600 companies from Wikepedia</h2><p>The S&amp;P 600 is an index of small-cap company stocks created by Standard &amp; Poor’s, selected by a committee based on recent profitability and other factors.</p><p>Currently there are 3 S&amp;P Small Cap 600 ETFs traded on the U.S. markets, the largest one is iShares S&amp;P Small-Cap 600 Value ETF IJS with around 7.09 Billon USD in assets.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the list of S&amp;P 600 stocks from Wikepedia</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    html <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> html<span class="token comment"># Load the list of S&amp;P 600 companies</span>url <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/List_of_S%26P_600_companies'</span>df <span class="token operator">=</span> load_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Symbol</th>      <th>Company</th>      <th>GICS Sector</th>      <th>GICS Sub-Industry</th>      <th>Headquarters Location</th>      <th>SEC filings</th>      <th>CIK</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AAON</td>      <td>AAON, Inc.</td>      <td>Industrials</td>      <td>Building Products</td>      <td>Tulsa, Oklahoma</td>      <td>view</td>      <td>824142</td>    </tr>    <tr>      <th>1</th>      <td>AAP</td>      <td>Advance Auto Parts, Inc.</td>      <td>Consumer Discretionary</td>      <td>Automotive Retail</td>      <td>Raleigh, North Carolina</td>      <td>view</td>      <td>1158449</td>    </tr>    <tr>      <th>2</th>      <td>AAT</td>      <td>American Assets Trust</td>      <td>Real Estate</td>      <td>Diversified REITs</td>      <td>San Diego, California</td>      <td>view</td>      <td>1500217</td>    </tr>    <tr>      <th>3</th>      <td>ABCB</td>      <td>Ameris Bancorp</td>      <td>Financials</td>      <td>Regional Banks</td>      <td>Atlanta, Georgia</td>      <td>view</td>      <td>351569</td>    </tr>    <tr>      <th>4</th>      <td>ABG</td>      <td>Asbury Automotive Group</td>      <td>Consumer Discretionary</td>      <td>Automotive Retail</td>      <td>Duluth, Georgia</td>      <td>view</td>      <td>1144980</td>    </tr>  </tbody></table></div><h2 id="Retrieve-the-latest-stock-price-using-yfinance"><a href="#Retrieve-the-latest-stock-price-using-yfinance" class="headerlink" title="Retrieve the latest stock price using yfinance"></a>Retrieve the latest stock price using yfinance</h2><p>We retrieve the latest year’s stock price using yfinance.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>data <span class="token operator">=</span> yf<span class="token punctuation">.</span>download<span class="token punctuation">(</span>            <span class="token comment"># tickers list</span>            tickers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token comment"># valid periods: 1d, 5d, 1mo, 3mo, 6mo, 1y, 5y, 10y, ytd, max</span>            period <span class="token operator">=</span> <span class="token string">'1y'</span><span class="token punctuation">,</span>            <span class="token comment"># valid intervals: 1m, 2m, 5m, 15m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo</span>            interval <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># group by ticker</span>            group_by <span class="token operator">=</span> <span class="token string">'ticker'</span><span class="token punctuation">,</span>            <span class="token comment"># adjust all OHLC automatically</span>            auto_adjust <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># download pre/post regular market hours data</span>            prepost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># use threads for mass downloading</span>            threads <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># proxy URL scheme when downloading</span>            proxy <span class="token operator">=</span> <span class="token boolean">None</span>            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[*********************100%%**********************]  602 of 602 completed2 Failed downloads:['MOG.A', 'CWEN.A']: Exception('%ticker%: No data found, symbol may be delisted')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">'AAON'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>Price</th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2023-02-24</th>      <td>52.804963</td>      <td>54.090144</td>      <td>52.440610</td>      <td>53.970898</td>      <td>367500</td>    </tr>    <tr>      <th>2023-02-27</th>      <td>53.970902</td>      <td>55.037468</td>      <td>53.281940</td>      <td>53.984154</td>      <td>653700</td>    </tr>    <tr>      <th>2023-02-28</th>      <td>57.634324</td>      <td>62.536555</td>      <td>56.309398</td>      <td>60.257679</td>      <td>1987800</td>    </tr>    <tr>      <th>2023-03-01</th>      <td>60.085437</td>      <td>60.681652</td>      <td>59.515718</td>      <td>59.999317</td>      <td>566400</td>    </tr>    <tr>      <th>2023-03-02</th>      <td>59.793949</td>      <td>60.708151</td>      <td>59.436218</td>      <td>60.522659</td>      <td>792450</td>    </tr>  </tbody></table></div><h2 id="Calculate-1-year-return-and-remove-the-lowest-momentum-stocks"><a href="#Calculate-1-year-return-and-remove-the-lowest-momentum-stocks" class="headerlink" title="Calculate 1-year return and remove the lowest momentum stocks"></a>Calculate 1-year return and remove the lowest momentum stocks</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the available tickers</span>tickers_unavailable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'MOG.A'</span><span class="token punctuation">,</span> <span class="token string">'CWEN.A'</span><span class="token punctuation">]</span>tickers <span class="token operator">=</span> <span class="token punctuation">[</span>ticker <span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> ticker <span class="token keyword">not</span> <span class="token keyword">in</span> tickers_unavailable<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Number of available tickers: '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Number of available tickers:  600</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Create the format of the dataframe that stores the stock price, market cap and number of shares to buy</span>my_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> <span class="token string">'Price'</span><span class="token punctuation">,</span> <span class="token string">'One-Year Price Return'</span><span class="token punctuation">,</span> <span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">]</span>final_dataframe <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> my_columns<span class="token punctuation">)</span>final_dataframe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>One-Year Price Return</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Input the value of the portforlio, i.e. example here is 1M USD</span>portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>    val <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span><span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"That's not a number! \n Try again:"</span><span class="token punctuation">)</span>    portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Enter the value of your portfolio:1000000</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Calculate the 1-year return</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ticker <span class="token operator">=</span> tickers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">.</span>append<span class="token punctuation">(</span>            pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>            <span class="token punctuation">[</span>                ticker<span class="token punctuation">,</span>                data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token string">'NA'</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>                index <span class="token operator">=</span> my_columns<span class="token punctuation">)</span><span class="token punctuation">,</span>                ignore_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>One-Year Price Return</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AAON</td>      <td>84.050003</td>      <td>30.079105</td>      <td>NA</td>    </tr>    <tr>      <th>1</th>      <td>AAP</td>      <td>61.099998</td>      <td>-74.325050</td>      <td>NA</td>    </tr>    <tr>      <th>2</th>      <td>AAT</td>      <td>21.530001</td>      <td>-2.397324</td>      <td>NA</td>    </tr>    <tr>      <th>3</th>      <td>ABCB</td>      <td>45.880001</td>      <td>-1.409645</td>      <td>NA</td>    </tr>    <tr>      <th>4</th>      <td>ABG</td>      <td>214.619995</td>      <td>-6.620010</td>      <td>NA</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Remove the low-momentum stocks, only keep the top 50</span>final_dataframe<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'One-Year Price Return'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span>final_dataframe<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>One-Year Price Return</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AMR</td>      <td>389.880005</td>      <td>234.812805</td>      <td>NA</td>    </tr>    <tr>      <th>1</th>      <td>IBP</td>      <td>234.089996</td>      <td>122.137169</td>      <td>NA</td>    </tr>    <tr>      <th>2</th>      <td>POWL</td>      <td>161.710007</td>      <td>118.683826</td>      <td>NA</td>    </tr>    <tr>      <th>3</th>      <td>WDFC</td>      <td>267.000000</td>      <td>97.170700</td>      <td>NA</td>    </tr>    <tr>      <th>4</th>      <td>ANF</td>      <td>122.820000</td>      <td>93.830000</td>      <td>NA</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Calculate the number of shares to buy</span><span class="token keyword">import</span> mathposition_size <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>final_dataframe<span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    final_dataframe<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>position_size <span class="token operator">/</span> final_dataframe<span class="token punctuation">[</span><span class="token string">'Price'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>One-Year Price Return</th>      <th>Number of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AMR</td>      <td>389.880005</td>      <td>234.812805</td>      <td>4</td>    </tr>    <tr>      <th>1</th>      <td>IBP</td>      <td>234.089996</td>      <td>122.137169</td>      <td>7</td>    </tr>    <tr>      <th>2</th>      <td>POWL</td>      <td>161.710007</td>      <td>118.683826</td>      <td>10</td>    </tr>    <tr>      <th>3</th>      <td>WDFC</td>      <td>267.000000</td>      <td>97.170700</td>      <td>6</td>    </tr>    <tr>      <th>4</th>      <td>ANF</td>      <td>122.820000</td>      <td>93.830000</td>      <td>13</td>    </tr>  </tbody></table></div><h2 id="Save-the-output-in-Excel-using-XlsxWriter"><a href="#Save-the-output-in-Excel-using-XlsxWriter" class="headerlink" title="Save the output in Excel using XlsxWriter"></a>Save the output in Excel using XlsxWriter</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Initiate the XlsxWriter object, save the output in xlsx format.</span><span class="token keyword">import</span> xlsxwriterwriter <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'quantitative momentum.xlsx'</span><span class="token punctuation">,</span> engine <span class="token operator">=</span> <span class="token string">'xlsxwriter'</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token string">'Recommended Trades'</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Create-the-formats"><a href="#Create-the-formats" class="headerlink" title="Create the formats:"></a>Create the formats:</h3><ul><li>String format for tickers</li><li>$xx.xx format for stock prices</li><li>$xx,xxx for market capitalization</li><li>Integer format for the number of shares to buy</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">background_color <span class="token operator">=</span> <span class="token string">'#0a0a23'</span>font_color <span class="token operator">=</span> <span class="token string">'#ffffff'</span>string_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>dollar_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$0.00'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>capital_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$#,##0'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>integer_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>percent_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0.0%'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Apply the formats to the columns of the output file</span>column_formats <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> string_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Stock Price'</span><span class="token punctuation">,</span> dollar_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'One-Year Price Return'</span><span class="token punctuation">,</span> dollar_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">,</span> integer_format<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">for</span> column <span class="token keyword">in</span> column_formats<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_column<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">1'</span></span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> string_format<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Save the output</span>writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yfinance </tag>
            
            <tag> xlsxwriter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Building an equal-weight S&amp;P 600 index fund</title>
      <link href="/20240225/building-an-equal-weight-s-p-600-index-fund/"/>
      <url>/20240225/building-an-equal-weight-s-p-600-index-fund/</url>
      
        <content type="html"><![CDATA[<h2 id="Load-the-list-of-S-amp-P-600-companies-from-Wikepedia"><a href="#Load-the-list-of-S-amp-P-600-companies-from-Wikepedia" class="headerlink" title="Load the list of S&amp;P 600 companies from Wikepedia"></a>Load the list of S&amp;P 600 companies from Wikepedia</h2><p>The S&amp;P 600 is an index of small-cap company stocks created by Standard &amp; Poor’s, selected by a committee based on recent profitability and other factors. </p><p>Currently there are 3 S&amp;P Small Cap 600 ETFs traded on the U.S. markets, the largest one is iShares S&amp;P Small-Cap 600 Value ETF IJS with around 7.09 Billon USD in assets.</p><p>The goal of this section is trying to create an index fund following the instruction on <a href="https://github.com/nickmccullum/algorithmic-trading-python/tree/master">https://github.com/nickmccullum/algorithmic-trading-python/tree/master</a>, with this fund it tells how many shares of each S&amp;P 600 constituent you should purchase to get an equal-weight version of the index fund.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the list of S&amp;P 600 stocks from Wikepedia</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    html <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> html<span class="token comment"># Load the list of S&amp;P 600 companies</span>url <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/List_of_S%26P_600_companies'</span>df <span class="token operator">=</span> load_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Symbol</th>      <th>Company</th>      <th>GICS Sector</th>      <th>GICS Sub-Industry</th>      <th>Headquarters Location</th>      <th>SEC filings</th>      <th>CIK</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AAON</td>      <td>AAON, Inc.</td>      <td>Industrials</td>      <td>Building Products</td>      <td>Tulsa, Oklahoma</td>      <td>view</td>      <td>824142</td>    </tr>    <tr>      <th>1</th>      <td>AAP</td>      <td>Advance Auto Parts, Inc.</td>      <td>Consumer Discretionary</td>      <td>Automotive Retail</td>      <td>Raleigh, North Carolina</td>      <td>view</td>      <td>1158449</td>    </tr>    <tr>      <th>2</th>      <td>AAT</td>      <td>American Assets Trust</td>      <td>Real Estate</td>      <td>Diversified REITs</td>      <td>San Diego, California</td>      <td>view</td>      <td>1500217</td>    </tr>    <tr>      <th>3</th>      <td>ABCB</td>      <td>Ameris Bancorp</td>      <td>Financials</td>      <td>Regional Banks</td>      <td>Atlanta, Georgia</td>      <td>view</td>      <td>351569</td>    </tr>    <tr>      <th>4</th>      <td>ABG</td>      <td>Asbury Automotive Group</td>      <td>Consumer Discretionary</td>      <td>Automotive Retail</td>      <td>Duluth, Georgia</td>      <td>view</td>      <td>1144980</td>    </tr>  </tbody></table></div><h2 id="Retrieve-the-latest-stock-price-using-yfinance"><a href="#Retrieve-the-latest-stock-price-using-yfinance" class="headerlink" title="Retrieve the latest stock price using yfinance"></a>Retrieve the latest stock price using yfinance</h2><p>We retrieve the latest day’s stock price using yfinance.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>data <span class="token operator">=</span> yf<span class="token punctuation">.</span>download<span class="token punctuation">(</span>            <span class="token comment"># tickers list</span>            tickers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token comment"># valid periods: 1d, 5d, 1mo, 3mo, 6mo, 1y, 5y, 10y, ytd, max</span>            period <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># valid intervals: 1m, 2m, 5m, 15m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo</span>            interval <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># group by ticker</span>            group_by <span class="token operator">=</span> <span class="token string">'ticker'</span><span class="token punctuation">,</span>            <span class="token comment"># adjust all OHLC automatically</span>            auto_adjust <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># download pre/post regular market hours data</span>            prepost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># use threads for mass downloading</span>            threads <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># proxy URL scheme when downloading</span>            proxy <span class="token operator">=</span> <span class="token boolean">None</span>            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[*********************100%%**********************]  602 of 602 completed2 Failed downloads:['MOG.A', 'CWEN.A']: Exception('%ticker%: No data found, symbol may be delisted')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">'AAON'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>Price</th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2024-02-23</th>      <td>82.639999</td>      <td>84.379997</td>      <td>82.230003</td>      <td>84.050003</td>      <td>226500</td>    </tr>  </tbody></table></div><h2 id="Buid-the-index-fund"><a href="#Buid-the-index-fund" class="headerlink" title="Buid the index fund"></a>Buid the index fund</h2><p>In this section, I will use the closing price of the latest day as the price of each stock, and based on this price to build an equal-weight index fund by calculate how much shares to buy.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the available tickers</span>tickers_unavailable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'MOG.A'</span><span class="token punctuation">,</span> <span class="token string">'CWEN.A'</span><span class="token punctuation">]</span>tickers <span class="token operator">=</span> <span class="token punctuation">[</span>ticker <span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> ticker <span class="token keyword">not</span> <span class="token keyword">in</span> tickers_unavailable<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Number of available tickers: '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Number of available tickers:  600</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Create the format of the dataframe that stores the stock price, market cap and number of shares to buy</span>my_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> <span class="token string">'Price'</span><span class="token punctuation">,</span><span class="token string">'Market Capitalization'</span><span class="token punctuation">,</span> <span class="token string">'Number Of Shares to Buy'</span><span class="token punctuation">]</span>final_dataframe <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> my_columns<span class="token punctuation">)</span>final_dataframe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>Market Capitalization</th>      <th>Number Of Shares to Buy</th>    </tr>  </thead>  <tbody>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Input the value of the portforlio, i.e. example here is 10M USD</span>portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>    val <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span><span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"That's not a number! \n Try again:"</span><span class="token punctuation">)</span>    portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Enter the value of your portfolio:10000000</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Calculate the number of shares to buy</span><span class="token keyword">import</span> mathposition_size <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ticker <span class="token operator">=</span> tickers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">.</span>append<span class="token punctuation">(</span>            pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>            <span class="token punctuation">[</span>                ticker<span class="token punctuation">,</span>                data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Volume'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>position_size <span class="token operator">/</span> data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>                index <span class="token operator">=</span> my_columns<span class="token punctuation">)</span><span class="token punctuation">,</span>                ignore_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Ticker</th>      <th>Price</th>      <th>Market Capitalization</th>      <th>Number Of Shares to Buy</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>AAON</td>      <td>84.050003</td>      <td>1.903733e+07</td>      <td>198</td>    </tr>    <tr>      <th>1</th>      <td>AAP</td>      <td>61.099998</td>      <td>1.026358e+08</td>      <td>272</td>    </tr>    <tr>      <th>2</th>      <td>AAT</td>      <td>21.530001</td>      <td>5.802335e+06</td>      <td>774</td>    </tr>    <tr>      <th>3</th>      <td>ABCB</td>      <td>45.880001</td>      <td>1.286475e+07</td>      <td>363</td>    </tr>    <tr>      <th>4</th>      <td>ABG</td>      <td>214.619995</td>      <td>1.983089e+07</td>      <td>77</td>    </tr>  </tbody></table></div><h2 id="Save-the-output-in-Excel-using-XlsxWriter"><a href="#Save-the-output-in-Excel-using-XlsxWriter" class="headerlink" title="Save the output in Excel using XlsxWriter"></a>Save the output in Excel using XlsxWriter</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Initiate the XlsxWriter object, save the output in xlsx format.</span><span class="token keyword">import</span> xlsxwriterwriter <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'recommended trades.xlsx'</span><span class="token punctuation">,</span> engine <span class="token operator">=</span> <span class="token string">'xlsxwriter'</span><span class="token punctuation">)</span>final_dataframe<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token string">'Recommended Trades'</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Create-the-formats"><a href="#Create-the-formats" class="headerlink" title="Create the formats:"></a>Create the formats:</h3><ul><li>String format for tickers</li><li>$xx.xx format for stock prices</li><li>$xx,xxx for market capitalization</li><li>Integer format for the number of shares to buy</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">background_color <span class="token operator">=</span> <span class="token string">'#0a0a23'</span>font_color <span class="token operator">=</span> <span class="token string">'#ffffff'</span>string_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>dollar_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$0.00'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>capital_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$#,##0'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>integer_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span>percent_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>        <span class="token punctuation">{</span>            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0.0%'</span><span class="token punctuation">,</span>            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Apply the formats to the columns of the output file</span>column_formats <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> string_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Stock Price'</span><span class="token punctuation">,</span> dollar_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Market Capitalization'</span><span class="token punctuation">,</span> capital_format<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">,</span> integer_format<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">for</span> column <span class="token keyword">in</span> column_formats<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_column<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">1'</span></span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> string_format<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Save the output</span>writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yfinance </tag>
            
            <tag> xlsxwriter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Read S&amp;P 500 list of companies from Wikipedia and retrieve stock data using yfinance</title>
      <link href="/20240224/read-s-p-500-list-of-companies-from-wikipedia-and-retrieve-stock-data-using-yfinance/"/>
      <url>/20240224/read-s-p-500-list-of-companies-from-wikipedia-and-retrieve-stock-data-using-yfinance/</url>
      
        <content type="html"><![CDATA[<h2 id="Load-the-list-of-S-amp-P-500-companies-from-Wikepedia"><a href="#Load-the-list-of-S-amp-P-500-companies-from-Wikepedia" class="headerlink" title="Load the list of S&amp;P 500 companies from Wikepedia"></a>Load the list of S&amp;P 500 companies from Wikepedia</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    html <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Load the list of S&amp;P 500 companies</span>url <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/List_of_S%26P_500_companies'</span>df <span class="token operator">=</span> load_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Symbol</th>      <th>Security</th>      <th>GICS Sector</th>      <th>GICS Sub-Industry</th>      <th>Headquarters Location</th>      <th>Date added</th>      <th>CIK</th>      <th>Founded</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>MMM</td>      <td>3M</td>      <td>Industrials</td>      <td>Industrial Conglomerates</td>      <td>Saint Paul, Minnesota</td>      <td>1957-03-04</td>      <td>66740</td>      <td>1902</td>    </tr>    <tr>      <th>1</th>      <td>AOS</td>      <td>A. O. Smith</td>      <td>Industrials</td>      <td>Building Products</td>      <td>Milwaukee, Wisconsin</td>      <td>2017-07-26</td>      <td>91142</td>      <td>1916</td>    </tr>    <tr>      <th>2</th>      <td>ABT</td>      <td>Abbott</td>      <td>Health Care</td>      <td>Health Care Equipment</td>      <td>North Chicago, Illinois</td>      <td>1957-03-04</td>      <td>1800</td>      <td>1888</td>    </tr>    <tr>      <th>3</th>      <td>ABBV</td>      <td>AbbVie</td>      <td>Health Care</td>      <td>Biotechnology</td>      <td>North Chicago, Illinois</td>      <td>2012-12-31</td>      <td>1551152</td>      <td>2013 (1888)</td>    </tr>    <tr>      <th>4</th>      <td>ACN</td>      <td>Accenture</td>      <td>Information Technology</td>      <td>IT Consulting &amp; Other Services</td>      <td>Dublin, Ireland</td>      <td>2011-07-06</td>      <td>1467373</td>      <td>1989</td>    </tr>  </tbody></table></div><h2 id="Examing-the-data"><a href="#Examing-the-data" class="headerlink" title="Examing the data"></a>Examing the data</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Check the unique business Sectors of S&amp;P 500 companies</span>sector_unique <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'GICS Sector'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>sector_unique<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>array(['Industrials', 'Health Care', 'Information Technology',       'Utilities', 'Financials', 'Materials', 'Consumer Discretionary',       'Real Estate', 'Communication Services', 'Consumer Staples',       'Energy'], dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Group by Sector</span>sector <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'GICS Sector'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>Count<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'Symbol'</span><span class="token punctuation">,</span> <span class="token string">'size'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltsns<span class="token punctuation">.</span>set_theme<span class="token punctuation">(</span>style <span class="token operator">=</span> <span class="token string">"whitegrid"</span><span class="token punctuation">)</span><span class="token comment"># Initialize the matplotlib figure</span>f<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Sort the sector dataset</span>sector <span class="token operator">=</span> sector<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'Count'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment"># Plot the sector counts</span>sns<span class="token punctuation">.</span>set_color_codes<span class="token punctuation">(</span><span class="token string">"pastel"</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'GICS Sector'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'Count'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>sector<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Companies per Sector'</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token comment"># Add a informative axis label</span><span class="token comment">#ax.legend(ncol=2, loc='lower right', frameon=True)</span><span class="token comment">#ax.set(ylim=(0,80), ylabel="Company's Number per Sector",</span><span class="token comment">#       xlabel='Sector')</span>ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Sector'</span><span class="token punctuation">,</span> fontweight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'No. of Companies'</span><span class="token punctuation">,</span> fontweight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span>ax<span class="token punctuation">.</span>get_xticklabels<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">"right"</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'No. of Companies in S&amp;P 500 per Sector'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> fontweight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>despine<span class="token punctuation">(</span>left<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Read-S-P-500-list-of-companies-from-Wikipedia-and-retrieve-stock-data-using-yfinance-1.png" alt="No. of Companies in S&amp;P 500 per Sector"></p><h2 id="Retrieve-stock-data-using-yfinance"><a href="#Retrieve-stock-data-using-yfinance" class="headerlink" title="Retrieve stock data using yfinance"></a>Retrieve stock data using yfinance</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>data <span class="token operator">=</span> yf<span class="token punctuation">.</span>download<span class="token punctuation">(</span>            <span class="token comment"># tickers list</span>            tickers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token comment"># valid periods: 1d, 5d, 1mo, 3mo, 6mo, 1y, 5y, 10y, ytd, max</span>            period <span class="token operator">=</span> <span class="token string">'1y'</span><span class="token punctuation">,</span>            <span class="token comment"># valid intervals: 1m, 2m, 5m, 15m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo</span>            interval <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>            <span class="token comment"># group by ticker</span>            group_by <span class="token operator">=</span> <span class="token string">'ticker'</span><span class="token punctuation">,</span>            <span class="token comment"># adjust all OHLC automatically</span>            auto_adjust <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># download pre/post regular market hours data</span>            prepost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># use threads for mass downloading</span>            threads <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>            <span class="token comment"># proxy URL scheme when downloading</span>            proxy <span class="token operator">=</span> <span class="token boolean">None</span>            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[*********************100%%**********************]  503 of 503 completed2 Failed downloads:['BF.B']: Exception('%ticker%: No price data found, symbol may be delisted (period=1y)')['BRK.B']: Exception('%ticker%: No data found, symbol may be delisted')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">'AAPL'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>Price</th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2023-02-24</th>      <td>146.328931</td>      <td>146.408508</td>      <td>144.946312</td>      <td>145.931061</td>      <td>55469600</td>    </tr>    <tr>      <th>2023-02-27</th>      <td>146.925752</td>      <td>148.377992</td>      <td>146.667123</td>      <td>147.134628</td>      <td>44998500</td>    </tr>    <tr>      <th>2023-02-28</th>      <td>146.269261</td>      <td>148.288481</td>      <td>146.050427</td>      <td>146.627350</td>      <td>50547000</td>    </tr>    <tr>      <th>2023-03-01</th>      <td>146.050447</td>      <td>146.448318</td>      <td>144.240103</td>      <td>144.538513</td>      <td>55479000</td>    </tr>    <tr>      <th>2023-03-02</th>      <td>143.613439</td>      <td>145.931070</td>      <td>143.135977</td>      <td>145.135315</td>      <td>52238100</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Plot close price of AAPL</span>df_aapl <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'AAPL'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Close<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span>df_aapl<span class="token punctuation">.</span>index<span class="token punctuation">,</span> df_aapl<span class="token punctuation">.</span>Close<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df_aapl<span class="token punctuation">.</span>index<span class="token punctuation">,</span> df_aapl<span class="token punctuation">.</span>Close<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Closing Price of AAPL'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Text(0, 0.5, 'Closing Price of AAPL')</code></pre><p><img src="https://media.publit.io/file/Read-S-P-500-list-of-companies-from-Wikipedia-and-retrieve-stock-data-using-yfinance-2.png" alt="Closing Price of AAPL"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Create a function to plot the closing price of the stock</span><span class="token keyword">def</span> <span class="token function">price_plot</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>    df_symbol <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">[</span>symbol<span class="token punctuation">]</span><span class="token punctuation">.</span>Close<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span>df_symbol<span class="token punctuation">.</span>index<span class="token punctuation">,</span> df_symbol<span class="token punctuation">.</span>Close<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df_symbol<span class="token punctuation">.</span>index<span class="token punctuation">,</span> df_symbol<span class="token punctuation">.</span>Close<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> fontweight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">,</span> fontweight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Closing Price'</span><span class="token punctuation">,</span> fontweight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">price_plot<span class="token punctuation">(</span><span class="token string">'GOOGL'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://media.publit.io/file/Read-S-P-500-list-of-companies-from-Wikipedia-and-retrieve-stock-data-using-yfinance-3.png" alt="Closing Price of GOOGL"></p>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> seaborn </tag>
            
            <tag> yfinance </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Coordinates projection with Python</title>
      <link href="/20240222/coordinates-projection-with-python/"/>
      <url>/20240222/coordinates-projection-with-python/</url>
      
        <content type="html"><![CDATA[<p>Coordinates reference system tells Python how the coordinates related to places on the Earth, different coordinates projection could have different registry or EPSG geodetic parameter dataset. The most commonly used Global Positioning System which uses latitude/longitude coordinate system based on the Earth’s center of mass, it has EPSG code as EPSG:4326.</p><p>EPSG:3067 is the code for the projected coordinate system for Finland, in this note we will see how can we transform the different CRS.</p><h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>National Land Servey of Finland (<a href="https://www.maanmittauslaitos.fi/en">https://www.maanmittauslaitos.fi/en</a>) provides the latest shapefile for the Finnish administration boarders, which includes the municipalities.</p><p>OpenCellID (<a href="https://opencellid.org/">https://opencellid.org/</a>) is a collaborative community project that collects GPS positions of cell towers and their corresponding location area identity.</p><p>When download the dataset which contains the cell towers’ GPS information, it is in EPSG:4326 coded. While the shapefile for Finnish municipality, the CRS is EPSG:3067.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> contextily <span class="token keyword">as</span> ctx<span class="token keyword">from</span> geopandas <span class="token keyword">import</span> GeoDataFrame<span class="token keyword">from</span> shapely<span class="token punctuation">.</span>geometry <span class="token keyword">import</span> Point<span class="token keyword">import</span> pyproj<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dna_cell_tower <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'dna_lte.csv'</span><span class="token punctuation">)</span>dna_cell_tower<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Unnamed: 0</th>      <th>MCC</th>      <th>MCNC</th>      <th>eNB_ID</th>      <th>Longitude</th>      <th>Latitude</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>7489</td>      <td>244</td>      <td>12</td>      <td>2</td>      <td>24.607037</td>      <td>60.731043</td>    </tr>    <tr>      <th>1</th>      <td>7490</td>      <td>244</td>      <td>12</td>      <td>3</td>      <td>24.400345</td>      <td>60.997403</td>    </tr>    <tr>      <th>2</th>      <td>7491</td>      <td>244</td>      <td>12</td>      <td>4</td>      <td>24.613302</td>      <td>60.706910</td>    </tr>    <tr>      <th>3</th>      <td>7492</td>      <td>244</td>      <td>12</td>      <td>5</td>      <td>24.499218</td>      <td>60.912731</td>    </tr>    <tr>      <th>4</th>      <td>7493</td>      <td>244</td>      <td>12</td>      <td>6</td>      <td>24.510986</td>      <td>60.884484</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">finland_municipality <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">.</span>from_file<span class="token punctuation">(</span><span class="token string">'kunta1000k_2023Polygon.shp'</span><span class="token punctuation">)</span>finland_municipality<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>kunta</th>      <th>vuosi</th>      <th>nimi</th>      <th>namn</th>      <th>name</th>      <th>geometry</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>005</td>      <td>2023</td>      <td>Alajärvi</td>      <td>Alajärvi</td>      <td>Alajärvi</td>      <td>POLYGON ((366787.924 7001300.583, 364487.590 6...</td>    </tr>    <tr>      <th>1</th>      <td>009</td>      <td>2023</td>      <td>Alavieska</td>      <td>Alavieska</td>      <td>Alavieska</td>      <td>POLYGON ((382543.364 7120022.976, 382899.505 7...</td>    </tr>    <tr>      <th>2</th>      <td>010</td>      <td>2023</td>      <td>Alavus</td>      <td>Alavo</td>      <td>Alavus</td>      <td>POLYGON ((343298.204 6961570.195, 343831.847 6...</td>    </tr>    <tr>      <th>3</th>      <td>016</td>      <td>2023</td>      <td>Asikkala</td>      <td>Asikkala</td>      <td>Asikkala</td>      <td>POLYGON ((436139.680 6798279.085, 435714.468 6...</td>    </tr>    <tr>      <th>4</th>      <td>018</td>      <td>2023</td>      <td>Askola</td>      <td>Askola</td>      <td>Askola</td>      <td>POLYGON ((426631.036 6720528.076, 428821.749 6...</td>    </tr>  </tbody></table></div><p>We can use geopandas to review the shapefile’s coordinate reference system.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">finland_municipality<span class="token punctuation">.</span>crs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>&lt;Projected CRS: EPSG:3067&gt;Name: ETRS89 / TM35FIN(E,N)Axis Info [cartesian]:- E[east]: Easting (metre)- N[north]: Northing (metre)Area of Use:- name: Finland - onshore and offshore.- bounds: (19.08, 58.84, 31.59, 70.09)Coordinate Operation:- name: TM35FIN- method: Transverse MercatorDatum: European Terrestrial Reference System 1989 ensemble- Ellipsoid: GRS 1980- Prime Meridian: Greenwich</code></pre><h2 id="Data-Wrangling"><a href="#Data-Wrangling" class="headerlink" title="Data Wrangling"></a>Data Wrangling</h2><p>In the following we will transform the GPS (WGS84 or EPSG:4326) to EPSG3067, and then merge two datasets and count the number of cell towers per municipality.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">wgs84 <span class="token operator">=</span> pyproj<span class="token punctuation">.</span>Proj<span class="token punctuation">(</span>projparams <span class="token operator">=</span> <span class="token string">'epsg:4326'</span><span class="token punctuation">)</span>finProj <span class="token operator">=</span> pyproj<span class="token punctuation">.</span>Proj<span class="token punctuation">(</span>projparams <span class="token operator">=</span> <span class="token string">'epsg:3067'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">crs_transformer</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> pyproj<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>wgs84<span class="token punctuation">,</span>finProj<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">transformed_x</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> crs_transformer<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">transformed_y</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> crs_transformer<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dna_cell_tower<span class="token punctuation">[</span><span class="token string">'Proj_Lon'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dna_cell_tower<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> transformed_x<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'Longitude'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token string">'Latitude'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>dna_cell_tower<span class="token punctuation">[</span><span class="token string">'Proj_Lat'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dna_cell_tower<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> transformed_y<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'Longitude'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token string">'Latitude'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>dna_cell_tower<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Unnamed: 0</th>      <th>MCC</th>      <th>MCNC</th>      <th>eNB_ID</th>      <th>Longitude</th>      <th>Latitude</th>      <th>Proj_Lon</th>      <th>Proj_Lat</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>7489</td>      <td>244</td>      <td>12</td>      <td>2</td>      <td>24.607037</td>      <td>60.731043</td>      <td>369501.553119</td>      <td>6.735208e+06</td>    </tr>    <tr>      <th>1</th>      <td>7490</td>      <td>244</td>      <td>12</td>      <td>3</td>      <td>24.400345</td>      <td>60.997403</td>      <td>359409.547832</td>      <td>6.765288e+06</td>    </tr>    <tr>      <th>2</th>      <td>7491</td>      <td>244</td>      <td>12</td>      <td>4</td>      <td>24.613302</td>      <td>60.706910</td>      <td>369745.411927</td>      <td>6.732509e+06</td>    </tr>    <tr>      <th>3</th>      <td>7492</td>      <td>244</td>      <td>12</td>      <td>5</td>      <td>24.499218</td>      <td>60.912731</td>      <td>364394.910111</td>      <td>6.755654e+06</td>    </tr>    <tr>      <th>4</th>      <td>7493</td>      <td>244</td>      <td>12</td>      <td>6</td>      <td>24.510986</td>      <td>60.884484</td>      <td>364913.374089</td>      <td>6.752485e+06</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">dna_cell_tower_gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">(</span>dna_cell_tower<span class="token punctuation">,</span> geometry<span class="token operator">=</span>gpd<span class="token punctuation">.</span>points_from_xy<span class="token punctuation">(</span>dna_cell_tower<span class="token punctuation">[</span><span class="token string">'Proj_Lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dna_cell_tower<span class="token punctuation">[</span><span class="token string">'Proj_Lat'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> crs<span class="token operator">=</span><span class="token string">'EPSG:3067'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>dna_cell_tower_gdf<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Unnamed: 0</th>      <th>MCC</th>      <th>MCNC</th>      <th>eNB_ID</th>      <th>Longitude</th>      <th>Latitude</th>      <th>Proj_Lon</th>      <th>Proj_Lat</th>      <th>geometry</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>7489</td>      <td>244</td>      <td>12</td>      <td>2</td>      <td>24.607037</td>      <td>60.731043</td>      <td>369501.553119</td>      <td>6.735208e+06</td>      <td>POINT (369501.553 6735208.061)</td>    </tr>    <tr>      <th>1</th>      <td>7490</td>      <td>244</td>      <td>12</td>      <td>3</td>      <td>24.400345</td>      <td>60.997403</td>      <td>359409.547832</td>      <td>6.765288e+06</td>      <td>POINT (359409.548 6765288.274)</td>    </tr>    <tr>      <th>2</th>      <td>7491</td>      <td>244</td>      <td>12</td>      <td>4</td>      <td>24.613302</td>      <td>60.706910</td>      <td>369745.411927</td>      <td>6.732509e+06</td>      <td>POINT (369745.412 6732508.849)</td>    </tr>    <tr>      <th>3</th>      <td>7492</td>      <td>244</td>      <td>12</td>      <td>5</td>      <td>24.499218</td>      <td>60.912731</td>      <td>364394.910111</td>      <td>6.755654e+06</td>      <td>POINT (364394.910 6755653.753)</td>    </tr>    <tr>      <th>4</th>      <td>7493</td>      <td>244</td>      <td>12</td>      <td>6</td>      <td>24.510986</td>      <td>60.884484</td>      <td>364913.374089</td>      <td>6.752485e+06</td>      <td>POINT (364913.374 6752484.785)</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">dna_cell_tower_gdf<span class="token punctuation">.</span>crs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>&lt;Projected CRS: EPSG:3067&gt;Name: ETRS89 / TM35FIN(E,N)Axis Info [cartesian]:- E[east]: Easting (metre)- N[north]: Northing (metre)Area of Use:- name: Finland - onshore and offshore.- bounds: (19.08, 58.84, 31.59, 70.09)Coordinate Operation:- name: TM35FIN- method: Transverse MercatorDatum: European Terrestrial Reference System 1989 ensemble- Ellipsoid: GRS 1980- Prime Meridian: Greenwich</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">merge_gdf <span class="token operator">=</span> dna_cell_tower_gdf<span class="token punctuation">.</span>sjoin<span class="token punctuation">(</span>finland_municipality<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>merge_gdf<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Unnamed: 0</th>      <th>MCC</th>      <th>MCNC</th>      <th>eNB_ID</th>      <th>Longitude</th>      <th>Latitude</th>      <th>Proj_Lon</th>      <th>Proj_Lat</th>      <th>geometry</th>      <th>index_right</th>      <th>kunta</th>      <th>vuosi</th>      <th>nimi</th>      <th>namn</th>      <th>name</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>7489</td>      <td>244</td>      <td>12</td>      <td>2</td>      <td>24.607037</td>      <td>60.731043</td>      <td>369501.553119</td>      <td>6.735208e+06</td>      <td>POINT (369501.553 6735208.061)</td>      <td>143.0</td>      <td>433</td>      <td>2023.0</td>      <td>Loppi</td>      <td>Loppi</td>      <td>Loppi</td>    </tr>    <tr>      <th>1</th>      <td>7490</td>      <td>244</td>      <td>12</td>      <td>3</td>      <td>24.400345</td>      <td>60.997403</td>      <td>359409.547832</td>      <td>6.765288e+06</td>      <td>POINT (359409.548 6765288.274)</td>      <td>41.0</td>      <td>109</td>      <td>2023.0</td>      <td>Hämeenlinna</td>      <td>Tavastehus</td>      <td>Hämeenlinna</td>    </tr>    <tr>      <th>2</th>      <td>7491</td>      <td>244</td>      <td>12</td>      <td>4</td>      <td>24.613302</td>      <td>60.706910</td>      <td>369745.411927</td>      <td>6.732509e+06</td>      <td>POINT (369745.412 6732508.849)</td>      <td>143.0</td>      <td>433</td>      <td>2023.0</td>      <td>Loppi</td>      <td>Loppi</td>      <td>Loppi</td>    </tr>    <tr>      <th>3</th>      <td>7492</td>      <td>244</td>      <td>12</td>      <td>5</td>      <td>24.499218</td>      <td>60.912731</td>      <td>364394.910111</td>      <td>6.755654e+06</td>      <td>POINT (364394.910 6755653.753)</td>      <td>54.0</td>      <td>165</td>      <td>2023.0</td>      <td>Janakkala</td>      <td>Janakkala</td>      <td>Janakkala</td>    </tr>    <tr>      <th>4</th>      <td>7493</td>      <td>244</td>      <td>12</td>      <td>6</td>      <td>24.510986</td>      <td>60.884484</td>      <td>364913.374089</td>      <td>6.752485e+06</td>      <td>POINT (364913.374 6752484.785)</td>      <td>54.0</td>      <td>165</td>      <td>2023.0</td>      <td>Janakkala</td>      <td>Janakkala</td>      <td>Janakkala</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">finland_municipality <span class="token operator">=</span> finland_municipality<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'kunta'</span><span class="token punctuation">)</span>cell_tower_count <span class="token operator">=</span> merge_gdf<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'kunta'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'namn'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>finland_municipality_cell <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>finland_municipality<span class="token punctuation">,</span> cell_tower_count<span class="token punctuation">,</span> left_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> right_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>finland_municipality_cell<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>vuosi</th>      <th>nimi</th>      <th>namn</th>      <th>name</th>      <th>geometry</th>      <th>count</th>    </tr>    <tr>      <th>kunta</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>005</th>      <td>2023</td>      <td>Alajärvi</td>      <td>Alajärvi</td>      <td>Alajärvi</td>      <td>POLYGON ((366787.924 7001300.583, 364487.590 6...</td>      <td>10</td>    </tr>    <tr>      <th>010</th>      <td>2023</td>      <td>Alavus</td>      <td>Alavo</td>      <td>Alavus</td>      <td>POLYGON ((343298.204 6961570.195, 343831.847 6...</td>      <td>18</td>    </tr>    <tr>      <th>016</th>      <td>2023</td>      <td>Asikkala</td>      <td>Asikkala</td>      <td>Asikkala</td>      <td>POLYGON ((436139.680 6798279.085, 435714.468 6...</td>      <td>15</td>    </tr>    <tr>      <th>018</th>      <td>2023</td>      <td>Askola</td>      <td>Askola</td>      <td>Askola</td>      <td>POLYGON ((426631.036 6720528.076, 428821.749 6...</td>      <td>9</td>    </tr>    <tr>      <th>019</th>      <td>2023</td>      <td>Aura</td>      <td>Aura</td>      <td>Aura</td>      <td>POLYGON ((263938.323 6730398.827, 263060.935 6...</td>      <td>3</td>    </tr>  </tbody></table></div><h2 id="Data-Visualization"><a href="#Data-Visualization" class="headerlink" title="Data Visualization"></a>Data Visualization</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">finland_municipality_cell<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">'count'</span><span class="token punctuation">,</span> scheme<span class="token operator">=</span><span class="token string">"quantiles"</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'DNA LTE Cell Towers Number by Municipalities'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Coordinates-projection-with-Python-1.png" alt="DNA LTE Cell Towers Number by Municipalities"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">finland_municipality_cell_new <span class="token operator">=</span> finland_municipality_cell<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>epsg<span class="token operator">=</span><span class="token number">3857</span><span class="token punctuation">)</span>ax <span class="token operator">=</span> finland_municipality_cell_new<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">'count'</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'k'</span> <span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">,</span>legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>scheme<span class="token operator">=</span><span class="token string">"quantiles"</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">#Add background tiles to plot</span>ctx<span class="token punctuation">.</span>add_basemap<span class="token punctuation">(</span>ax<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'DNA LTE Cell Towers Number by Municipalities'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Text(0.5, 1.0, 'DNA LTE Cell Towers Number by Municipalities')</code></pre><p><img src="https://media.publit.io/file/Coordinates-projection-with-Python-2.png" alt="DNA LTE Cell Towers Number by Municipalities with Basemap"></p>]]></content>
      
      
      <categories>
          
          <category> Data Visualization </category>
          
      </categories>
      
      
        <tags>
            
            <tag> geopandas </tag>
            
            <tag> contextily </tag>
            
            <tag> pyproj </tag>
            
            <tag> shapely </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Create 3D figure using matplotlib</title>
      <link href="/20240218/create-3d-figure-using-matplotlib/"/>
      <url>/20240218/create-3d-figure-using-matplotlib/</url>
      
        <content type="html"><![CDATA[<h3 id="Import-Python-modules"><a href="#Import-Python-modules" class="headerlink" title="Import Python modules"></a>Import Python modules</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">from</span> mpl_toolkits <span class="token keyword">import</span> mplot3d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Create-a-3D-canvas"><a href="#Create-a-3D-canvas" class="headerlink" title="Create a 3D canvas"></a>Create a 3D canvas</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Create-3D-figure-using-matplotlib-1.png" alt="3D Canvas"></p><h3 id="Create-a-3D-spiral-line"><a href="#Create-a-3D-spiral-line" class="headerlink" title="Create a 3D spiral line"></a>Create a 3D spiral line</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span><span class="token comment"># generate some random data for a 3d spiral line</span>zline <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>xline <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>zline<span class="token punctuation">)</span>yline <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>zline<span class="token punctuation">)</span>ax<span class="token punctuation">.</span>plot3D<span class="token punctuation">(</span>xline<span class="token punctuation">,</span> yline<span class="token punctuation">,</span> zline<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[&lt;mpl_toolkits.mplot3d.art3d.Line3D at 0x26088ece590&gt;]</code></pre><p><img src="https://media.publit.io/file/Create-3D-figure-using-matplotlib-2.png" alt="3D Spiral Line"></p><h3 id="Create-3D-dots"><a href="#Create-3D-dots" class="headerlink" title="Create 3D dots"></a>Create 3D dots</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>zdata <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>xdata <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>zdata<span class="token punctuation">)</span>ydata <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>zdata<span class="token punctuation">)</span>ax<span class="token punctuation">.</span>scatter3D<span class="token punctuation">(</span>xdata<span class="token punctuation">,</span> ydata<span class="token punctuation">,</span> zdata<span class="token punctuation">,</span> c<span class="token operator">=</span>zdata<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'Greens'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x2608be04bd0&gt;</code></pre><p><img src="https://media.publit.io/file/Create-3D-figure-using-matplotlib-3.png" alt="3D Dots"></p>]]></content>
      
      
      <categories>
          
          <category> Data Visualization </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Read Online Dataset and Make Geographical Visualization</title>
      <link href="/20240214/read-online-dataset-and-make-geographical-visualization/"/>
      <url>/20240214/read-online-dataset-and-make-geographical-visualization/</url>
      
        <content type="html"><![CDATA[<h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>Statistisk sentralbyrå (SSB) is the Norwegian statistics bureau, it publishes about 1000 new statistical releases every year on its web site. In this practice we are examing the household income dataset per municipality, and visualize it on the map to see which municipality makes highest median income per household.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'https://data.ssb.no/api/v0/dataset/49678.csv?lang=no'</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">'iso-8859-1'</span><span class="token punctuation">,</span> delimiter <span class="token operator">=</span> <span class="token string">';'</span><span class="token punctuation">)</span><span class="token comment"># Only select data in 2022.</span>data_2022 <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'år'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2022</span><span class="token punctuation">]</span>data_2022<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>region</th>      <th>husholdningstype</th>      <th>statistikkvariabel</th>      <th>år</th>      <th>06944: Inntekt for husholdninger, etter region, husholdningstype, statistikkvariabel og år</th>    </tr>  </thead>  <tbody>    <tr>      <th>17</th>      <td>3001 Halden (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>674000</td>    </tr>    <tr>      <th>35</th>      <td>3001 Halden (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Inntekt etter skatt, median (kr)</td>      <td>2022</td>      <td>544000</td>    </tr>    <tr>      <th>53</th>      <td>3001 Halden (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Antall husholdninger</td>      <td>2022</td>      <td>15094</td>    </tr>    <tr>      <th>71</th>      <td>3001 Halden (2020-2023)</td>      <td>0001 Aleneboende</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>381000</td>    </tr>    <tr>      <th>89</th>      <td>3001 Halden (2020-2023)</td>      <td>0001 Aleneboende</td>      <td>Inntekt etter skatt, median (kr)</td>      <td>2022</td>      <td>312000</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Select total income for whole household</span>data_2022_allhousehold <span class="token operator">=</span> data_2022<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'husholdningstype'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0000 Alle husholdninger'</span><span class="token punctuation">]</span>data_2022_allhousehold_totalincome <span class="token operator">=</span> data_2022_allhousehold<span class="token punctuation">[</span>data_2022_allhousehold<span class="token punctuation">[</span><span class="token string">'statistikkvariabel'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Samlet inntekt, median (kr)'</span><span class="token punctuation">]</span>data_2022_allhousehold_totalincome<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>region</th>      <th>husholdningstype</th>      <th>statistikkvariabel</th>      <th>år</th>      <th>06944: Inntekt for husholdninger, etter region, husholdningstype, statistikkvariabel og år</th>    </tr>  </thead>  <tbody>    <tr>      <th>17</th>      <td>3001 Halden (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>674000</td>    </tr>    <tr>      <th>287</th>      <td>3002 Moss (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>707000</td>    </tr>    <tr>      <th>557</th>      <td>3003 Sarpsborg (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>693000</td>    </tr>    <tr>      <th>827</th>      <td>3004 Fredrikstad (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>706000</td>    </tr>    <tr>      <th>1097</th>      <td>3005 Drammen (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>735000</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">kommuneKode</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">kommuneNavn</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>        end <span class="token operator">=</span> text<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> text<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span>end<span class="token punctuation">]</span>data_2022_allhousehold_totalincome<span class="token punctuation">[</span><span class="token string">'kommune kode'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_2022_allhousehold_totalincome<span class="token punctuation">[</span><span class="token string">'region'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>kommuneKode<span class="token punctuation">)</span>data_2022_allhousehold_totalincome<span class="token punctuation">[</span><span class="token string">'kommune navn'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_2022_allhousehold_totalincome<span class="token punctuation">[</span><span class="token string">'region'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>kommuneNavn<span class="token punctuation">)</span>data_2022_allhousehold_totalincome<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>region</th>      <th>husholdningstype</th>      <th>statistikkvariabel</th>      <th>år</th>      <th>06944: Inntekt for husholdninger, etter region, husholdningstype, statistikkvariabel og år</th>      <th>kommune kode</th>      <th>kommune navn</th>    </tr>  </thead>  <tbody>    <tr>      <th>17</th>      <td>3001 Halden (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>674000</td>      <td>3001</td>      <td>Halden</td>    </tr>    <tr>      <th>287</th>      <td>3002 Moss (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>707000</td>      <td>3002</td>      <td>Moss</td>    </tr>    <tr>      <th>557</th>      <td>3003 Sarpsborg (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>693000</td>      <td>3003</td>      <td>Sarpsborg</td>    </tr>    <tr>      <th>827</th>      <td>3004 Fredrikstad (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>706000</td>      <td>3004</td>      <td>Fredrikstad</td>    </tr>    <tr>      <th>1097</th>      <td>3005 Drammen (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>735000</td>      <td>3005</td>      <td>Drammen</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">len</span><span class="token punctuation">(</span>data_2022_allhousehold_totalincome<span class="token punctuation">[</span><span class="token string">'kommune navn'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>388</code></pre><p>SSB also offers map files download (<a href="https://kart.ssb.no/">https://kart.ssb.no/</a>), here we downloaded  </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpdkommune <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">'mv_kommunermednavn.shp'</span><span class="token punctuation">)</span>kommune<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>kommunenum</th>      <th>navn</th>      <th>geometry</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>4646</td>      <td>Fjaler</td>      <td>POLYGON ((-20428.772 6832597.490, -20441.771 6...</td>    </tr>    <tr>      <th>1</th>      <td>5049</td>      <td>Flatanger</td>      <td>POLYGON ((263053.690 7172624.640, 263052.270 7...</td>    </tr>    <tr>      <th>2</th>      <td>1511</td>      <td>Vanylven</td>      <td>POLYGON ((1749.084 6921564.131, -1506.094 6925...</td>    </tr>    <tr>      <th>3</th>      <td>3816</td>      <td>Nome</td>      <td>POLYGON ((148567.840 6586720.610, 148429.240 6...</td>    </tr>    <tr>      <th>4</th>      <td>4214</td>      <td>Froland</td>      <td>POLYGON ((117922.071 6509638.209, 117937.491 6...</td>    </tr>  </tbody></table></div><h2 id="Data-Visualization"><a href="#Data-Visualization" class="headerlink" title="Data Visualization"></a>Data Visualization</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Merge the data to the municipality shapfile</span>kommune_income <span class="token operator">=</span> kommune<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>data_2022_allhousehold_totalincome<span class="token punctuation">,</span> left_on<span class="token operator">=</span><span class="token string">'kommunenum'</span><span class="token punctuation">,</span> right_on<span class="token operator">=</span><span class="token string">'kommune kode'</span><span class="token punctuation">)</span>kommune_income<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'06944: Inntekt for husholdninger, etter region, husholdningstype, statistikkvariabel og år'</span><span class="token punctuation">:</span><span class="token string">'inntekt'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>kommune_income<span class="token punctuation">[</span><span class="token string">'inntekt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> kommune_income<span class="token punctuation">[</span><span class="token string">'inntekt'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>kommune_income<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>kommunenum</th>      <th>navn</th>      <th>geometry</th>      <th>region</th>      <th>husholdningstype</th>      <th>statistikkvariabel</th>      <th>år</th>      <th>inntekt</th>      <th>kommune kode</th>      <th>kommune navn</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>4646</td>      <td>Fjaler</td>      <td>POLYGON ((-20428.772 6832597.490, -20441.771 6...</td>      <td>4646 Fjaler</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>626000.0</td>      <td>4646</td>      <td></td>    </tr>    <tr>      <th>1</th>      <td>5049</td>      <td>Flatanger</td>      <td>POLYGON ((263053.690 7172624.640, 263052.270 7...</td>      <td>5049 Flatanger</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>747000.0</td>      <td>5049</td>      <td></td>    </tr>    <tr>      <th>2</th>      <td>1511</td>      <td>Vanylven</td>      <td>POLYGON ((1749.084 6921564.131, -1506.094 6925...</td>      <td>1511 Vanylven</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>751000.0</td>      <td>1511</td>      <td></td>    </tr>    <tr>      <th>3</th>      <td>3816</td>      <td>Nome</td>      <td>POLYGON ((148567.840 6586720.610, 148429.240 6...</td>      <td>3816 Nome (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>682000.0</td>      <td>3816</td>      <td>Nome</td>    </tr>    <tr>      <th>4</th>      <td>3816</td>      <td>Nome</td>      <td>POLYGON ((172731.930 6573204.140, 173183.050 6...</td>      <td>3816 Nome (2020-2023)</td>      <td>0000 Alle husholdninger</td>      <td>Samlet inntekt, median (kr)</td>      <td>2022</td>      <td>682000.0</td>      <td>3816</td>      <td>Nome</td>    </tr>  </tbody></table></div><p>Clearly to see rich Norwegians live on the west coast (where oil and gas industry is there) and capital region (Oslo).</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltkommune_income<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">'inntekt'</span><span class="token punctuation">,</span> scheme<span class="token operator">=</span><span class="token string">"quantiles"</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Househould Median Income in 2022 by Municipalities'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Read-Online-Dataset-and-Make-Geographical-Visualization-1.png" alt="Norwegian Household Median Income per Municipality"></p><p>The Python module contextily could be used to add a background and make the map looks fancy.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> contextily <span class="token keyword">as</span> ctx<span class="token comment">#Convert the data to Web Mercator</span>kommune_income_new <span class="token operator">=</span> kommune_income<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>epsg<span class="token operator">=</span><span class="token number">3857</span><span class="token punctuation">)</span>ax <span class="token operator">=</span> kommune_income_new<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">'inntekt'</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'k'</span> <span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">,</span>legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>scheme<span class="token operator">=</span><span class="token string">"quantiles"</span><span class="token punctuation">)</span><span class="token comment">#Add background tiles to plot</span>ctx<span class="token punctuation">.</span>add_basemap<span class="token punctuation">(</span>ax<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Househould Median Income in 2022 by Municipalities'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Text(0.5, 1.0, 'Househould Median Income in 2022 by Municipalities')</code></pre><p><img src="https://media.publit.io/file/Read-Online-Dataset-and-Make-Geographical-Visualization-2.png" alt="Norwegian Household Median Income per Municipality with Base Map"></p>]]></content>
      
      
      <categories>
          
          <category> Data Visualization </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> geopandas </tag>
            
            <tag> contextily </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Visualize GPS data in Python</title>
      <link href="/20240206/visualize-gps-data-in-python/"/>
      <url>/20240206/visualize-gps-data-in-python/</url>
      
        <content type="html"><![CDATA[<h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>GPS data visualization is useful especially the data contains extra information besides the coordinates, for example the velocity per sampling points used in running APPs, UE (User Equipment) measurements of signal quality of the mobile network etc., visualization of this kind of data in map can easily help to understand, and troubleshoot network problems.</p><p>The example dataset contains the coordinates and its cooresponding measured LTE cell signal strength (RSRP - Reference Signal Received Power in dBm).</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pddata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'Data_RSRP.csv'</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Longitude</th>      <th>Latitude</th>      <th>LTE Serving RSRP(dBm)</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>24.846930</td>      <td>60.656944</td>      <td>-99.50</td>    </tr>    <tr>      <th>1</th>      <td>24.846933</td>      <td>60.656943</td>      <td>-87.56</td>    </tr>    <tr>      <th>2</th>      <td>24.846933</td>      <td>60.656943</td>      <td>-86.44</td>    </tr>    <tr>      <th>3</th>      <td>24.846933</td>      <td>60.656944</td>      <td>-87.50</td>    </tr>    <tr>      <th>4</th>      <td>24.846932</td>      <td>60.656946</td>      <td>-91.75</td>    </tr>  </tbody></table></div><p>The following function tries to map the measured signal stength (LTE cell RSRP in dBm) to different colors, therefore it can easily display where the mobile network coverage is good or bad.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">color_map</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> val <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">110</span><span class="token punctuation">:</span>        color <span class="token operator">=</span> <span class="token string">"#FF333C"</span>    <span class="token keyword">elif</span> val <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">:</span>        color <span class="token operator">=</span> <span class="token string">"#FF6133"</span>    <span class="token keyword">elif</span> val <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">:</span>        color <span class="token operator">=</span> <span class="token string">"#FFFF33"</span>    <span class="token keyword">elif</span> val <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">:</span>        color <span class="token operator">=</span> <span class="token string">"#A2FF33"</span>    <span class="token keyword">elif</span> val <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">70</span><span class="token punctuation">:</span>        color <span class="token operator">=</span> <span class="token string">"#228E03"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        color <span class="token operator">=</span> <span class="token string">"#0E3B01"</span>    <span class="token keyword">return</span> colordata<span class="token punctuation">[</span><span class="token string">'color'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'LTE Serving RSRP(dBm)'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>color_map<span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Longitude</th>      <th>Latitude</th>      <th>LTE Serving RSRP(dBm)</th>      <th>color</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>24.846930</td>      <td>60.656944</td>      <td>-99.50</td>      <td>#FFFF33</td>    </tr>    <tr>      <th>1</th>      <td>24.846933</td>      <td>60.656943</td>      <td>-87.56</td>      <td>#A2FF33</td>    </tr>    <tr>      <th>2</th>      <td>24.846933</td>      <td>60.656943</td>      <td>-86.44</td>      <td>#A2FF33</td>    </tr>    <tr>      <th>3</th>      <td>24.846933</td>      <td>60.656944</td>      <td>-87.50</td>      <td>#A2FF33</td>    </tr>    <tr>      <th>4</th>      <td>24.846932</td>      <td>60.656946</td>      <td>-91.75</td>      <td>#FFFF33</td>    </tr>  </tbody></table></div><h2 id="Folium"><a href="#Folium" class="headerlink" title="Folium"></a>Folium</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> foliummymap <span class="token operator">=</span> folium<span class="token punctuation">.</span>Map<span class="token punctuation">(</span>location<span class="token operator">=</span><span class="token punctuation">[</span>data<span class="token punctuation">.</span>Latitude<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>Longitude<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zoom_start<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token keyword">for</span> coord <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Latitude'</span><span class="token punctuation">,</span><span class="token string">'Longitude'</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">:</span>    folium<span class="token punctuation">.</span>CircleMarker<span class="token punctuation">(</span>location<span class="token operator">=</span><span class="token punctuation">[</span>coord<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>coord<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> radius<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>color<span class="token operator">=</span>coord<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_to<span class="token punctuation">(</span>mymap<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imageimg_data <span class="token operator">=</span> mymap<span class="token punctuation">.</span>_to_png<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span><span class="token punctuation">)</span>img<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'folium_img.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Visualize-GPS-Data-in-Python-folium-img.png" alt="Visualization with Folium"></p><h2 id="Plotly-Express"><a href="#Plotly-Express" class="headerlink" title="Plotly Express"></a>Plotly Express</h2><p>color_continuous_scale is adjustable with built-in color scales on <a href="https://plotly.com/python/builtin-colorscales/">https://plotly.com/python/builtin-colorscales/</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> plotly<span class="token punctuation">.</span>express <span class="token keyword">as</span> pxfig_1 <span class="token operator">=</span> px<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>data<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'Longitude'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'Latitude'</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'LTE Serving RSRP(dBm)'</span><span class="token punctuation">,</span> color_continuous_scale<span class="token operator">=</span><span class="token string">'speed'</span><span class="token punctuation">)</span>fig_1<span class="token punctuation">.</span>write_image<span class="token punctuation">(</span><span class="token string">'plotly_img.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Visualize-GPS-Data-in-Python-plotly-img.png" alt="Visualization with Plotly"></p>]]></content>
      
      
      <categories>
          
          <category> Data Visualization </category>
          
      </categories>
      
      
        <tags>
            
            <tag> folium </tag>
            
            <tag> plotly </tag>
            
            <tag> GPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Confusion matrix and its metrics</title>
      <link href="/20240202/confusion-matrix-and-its-metrics/"/>
      <url>/20240202/confusion-matrix-and-its-metrics/</url>
      
        <content type="html"><![CDATA[<h1 id="Data-preparation"><a href="#Data-preparation" class="headerlink" title="Data preparation"></a>Data preparation</h1><p>Fetch MNIST dataset which contains a set of 70,000 small images of digits handwritten by high school students and employees of the US Census Bureau. RidgeClassifier is used for prediction whether the handwriten digit is 5 or not.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> fetch_openml<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> RidgeClassifier<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mnist <span class="token operator">=</span> fetch_openml<span class="token punctuation">(</span><span class="token string">'mnist_784'</span><span class="token punctuation">,</span> version<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>X<span class="token punctuation">,</span> y <span class="token operator">=</span> mnist<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mnist<span class="token punctuation">[</span><span class="token string">"target"</span><span class="token punctuation">]</span>y <span class="token operator">=</span> y<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">60000</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token number">60000</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">60000</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token number">60000</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">y_train_5 <span class="token operator">=</span> <span class="token punctuation">(</span>y_train <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>y_test_5 <span class="token operator">=</span> <span class="token punctuation">(</span>y_test <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">ridge_clf <span class="token operator">=</span> RidgeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>ridge_clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train_5<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RidgeClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">RidgeClassifier</label><div class="sk-toggleable__content"><pre>RidgeClassifier()</pre></div></div></div></div></div><h1 id="Confusion-matrix-visualization"><a href="#Confusion-matrix-visualization" class="headerlink" title="Confusion matrix visualization"></a>Confusion matrix visualization</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertools<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">def</span> <span class="token function">plot_confusion_matrix</span><span class="token punctuation">(</span>cm<span class="token punctuation">,</span> classes<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">'Confusion matrix'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Blues<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    This function prints and plots the confusion matrix.    Normalization can be applied by setting `normalize=True`.    """</span>    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> interpolation<span class="token operator">=</span><span class="token string">'nearest'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>    tick_marks <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>classes<span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>tick_marks<span class="token punctuation">,</span> classes<span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>tick_marks<span class="token punctuation">,</span> classes<span class="token punctuation">)</span>    thresh <span class="token operator">=</span> cm<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>cm<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span>cm<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>j<span class="token punctuation">,</span> i<span class="token punctuation">,</span> cm<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">,</span>                 horizontalalignment<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span>                 color<span class="token operator">=</span><span class="token string">"white"</span> <span class="token keyword">if</span> cm<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> thresh <span class="token keyword">else</span> <span class="token string">"black"</span><span class="token punctuation">)</span>    <span class="token comment"># plt.tight_layout()</span>    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True label'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predicted label'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> cross_val_predict<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npy_train_5_pred <span class="token operator">=</span> cross_val_predict<span class="token punctuation">(</span>ridge_clf<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train_5<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>cm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>plot_confusion_matrix<span class="token punctuation">(</span>cm <span class="token punctuation">,</span> classes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"5"</span><span class="token punctuation">,</span><span class="token string">"Non-5"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">'Confusion matrix'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Confusion-matrix-and-its-metrics-output-7-0.png" alt="Confusion matrix"></p><h2 id="Accuracy"><a href="#Accuracy" class="headerlink" title="Accuracy"></a>Accuracy</h2><p>Accuracy is the ratio of total correct instances to the total instances. the potential risk to use this is for skewed dataset it actually cannot reflect the model’s performance perfectly. </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_scoreaccuracy_score<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.9428833333333333</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">y_train_5<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>count     60000unique        2top       Falsefreq      54579Name: class, dtype: object</code></pre><p>As we can see this dataset is skewed where non-5 digits occupied most of it, if we predict all digits as non-5, we could still get pretty good accuracy.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">y_train_5_new_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>y_train_5<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">bool</span><span class="token punctuation">)</span>accuracy_score<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_new_pred<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.90965</code></pre><h2 id="Precision"><a href="#Precision" class="headerlink" title="Precision"></a>Precision</h2><p>Precision is defined as the ratio of true positive predictions to the total number of positive predictions made by the model, it could be used to measure how accurate a model’s positive predictions are (the ability of the model not to label as positive a sample that is negative).</p><p>Precision = TP/(TP+FP)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> precision_scoreprecision_score<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.8706319702602231</code></pre><h2 id="Recall"><a href="#Recall" class="headerlink" title="Recall"></a>Recall</h2><p>Recall is the ratio of the number of true positive instances to the sum of true positive and false negative instanes, it measures the effectiveness of the model in identifying all relevant instances from a dataset (the ability of the classifier to find all the positive samples).</p><p>Recall = TP/(TP+FN)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> recall_scorerecall_score<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.432023611879727</code></pre><h2 id="F1-Score"><a href="#F1-Score" class="headerlink" title="F1-Score"></a>F1-Score</h2><p>F1-Score is the harmonic mean of precision and recall, it is used to evaluate the overall performance. The relative contribution of precision and recall to the F1 score are equal.</p><p>F-Score = 2 * Precision * Recall / (Precision + Recall) = 2 * TP / (2 * TP + FN + FP)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> f1_scoref1_score<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.5774873628405869</code></pre><h2 id="Specificity"><a href="#Specificity" class="headerlink" title="Specificity"></a>Specificity</h2><p>Specificity is also known as the True Negative Rate, it measures the ability of a model to correctly identify negative instances.</p><p>Specificity = TN/(TN+FP)</p><p>There is no direct way in sklearn.metrics to calculate the Specificity, here below are two indirect ways.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Method 1</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrixtn<span class="token punctuation">,</span> fp<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> tp <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span>specificity <span class="token operator">=</span> tn<span class="token operator">/</span><span class="token punctuation">(</span>tn<span class="token operator">+</span>fp<span class="token punctuation">)</span>specificity<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>0.9936239212884076</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Method 2, specificity is the recall of the negative class</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> recall_scorerecall_score<span class="token punctuation">(</span>y_train_5<span class="token punctuation">,</span> y_train_5_pred<span class="token punctuation">,</span> pos_label<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>0.9936239212884076</code></pre><h2 id="Type-1-and-Type-2-error"><a href="#Type-1-and-Type-2-error" class="headerlink" title="Type 1 and Type 2 error"></a>Type 1 and Type 2 error</h2><p>Type 1 error occurs when the model predicts a positive instance, but it is actually negative. Precision is affected by false positives, as it is the ratio of true positives to the sum of true positives and false positives.</p><p>Type 1 Error = FP/(TP+FP)</p><p>Type 2 error occurs when the model fails to predict a positive instance. Recall is directly affected by false negatives, as it is the ratio of true positives to the sum of true positives and false negatives.</p><p>Type 2 Error = FN/(TP+FN)</p><p>Precision emphasizes minimizing false positives, while recall focuses on minimizing false negatives.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">type_1_error <span class="token operator">=</span> fp<span class="token operator">/</span><span class="token punctuation">(</span>tp<span class="token operator">+</span>fp<span class="token punctuation">)</span>type_1_error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.12936802973977696</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">type_2_error <span class="token operator">=</span> fn<span class="token operator">/</span><span class="token punctuation">(</span>tp<span class="token operator">+</span>fn<span class="token punctuation">)</span>type_2_error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>0.567976388120273</code></pre>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> sklearn </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Analysis with text and categorical attributes or labels</title>
      <link href="/20240131/analysis-with-text-and-categorical-attributes-or-labels/"/>
      <url>/20240131/analysis-with-text-and-categorical-attributes-or-labels/</url>
      
        <content type="html"><![CDATA[<h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>The widely used dataset: <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a> to note down several ways to handle text and categorical attributes or labels in the dataset, due to many machine learning algorithms prefers to handle numerical data.</p><p>The first step is to download the data from Kaggle and read it by using Pandas. </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdhousing <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'housing.csv'</span><span class="token punctuation">)</span>housing<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>longitude</th>      <th>latitude</th>      <th>housing_median_age</th>      <th>total_rooms</th>      <th>total_bedrooms</th>      <th>population</th>      <th>households</th>      <th>median_income</th>      <th>median_house_value</th>      <th>ocean_proximity</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-122.23</td>      <td>37.88</td>      <td>41.0</td>      <td>880.0</td>      <td>129.0</td>      <td>322.0</td>      <td>126.0</td>      <td>8.3252</td>      <td>452600.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>1</th>      <td>-122.22</td>      <td>37.86</td>      <td>21.0</td>      <td>7099.0</td>      <td>1106.0</td>      <td>2401.0</td>      <td>1138.0</td>      <td>8.3014</td>      <td>358500.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>2</th>      <td>-122.24</td>      <td>37.85</td>      <td>52.0</td>      <td>1467.0</td>      <td>190.0</td>      <td>496.0</td>      <td>177.0</td>      <td>7.2574</td>      <td>352100.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>3</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1274.0</td>      <td>235.0</td>      <td>558.0</td>      <td>219.0</td>      <td>5.6431</td>      <td>341300.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>4</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1627.0</td>      <td>280.0</td>      <td>565.0</td>      <td>259.0</td>      <td>3.8462</td>      <td>342200.0</td>      <td>NEAR BAY</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing<span class="token punctuation">.</span>dtypes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>longitude             float64latitude              float64housing_median_age    float64total_rooms           float64total_bedrooms        float64population            float64households            float64median_income         float64median_house_value    float64ocean_proximity        objectdtype: object</code></pre><h2 id="Encode-categorical-attributes"><a href="#Encode-categorical-attributes" class="headerlink" title="Encode categorical attributes"></a>Encode categorical attributes</h2><p>OrdinalEncoder can be sued to covert categorical features to integers (0 to n_categories - 1)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> OrdinalEncodero_encoder <span class="token operator">=</span> OrdinalEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>housing_o_encoded <span class="token operator">=</span> o_encoder<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npnp<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>housing_o_encoded<span class="token punctuation">,</span> return_counts<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>(array([0., 1., 2., 3., 4.]), array([9136, 6551,    5, 2290, 2658], dtype=int64))</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>housing<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> return_counts<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>(array(['&lt;1H OCEAN', 'INLAND', 'ISLAND', 'NEAR BAY', 'NEAR OCEAN'],       dtype=object), array([9136, 6551,    5, 2290, 2658], dtype=int64))</code></pre><p>One issue with OrdinalEncoder is that it makes machine learning algorithms assume two nearby values are more similar than two distant values, this is not the case for ‘ocean_proximity’ in the dataset (for example, categories 0 and 4 are clearly more similar than categories 0 and 1). To handle this issue, OneHotEncoder is used to encode only one attribute to be equal to 1 (hot), while the others will be 0 (cold).</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> OneHotEncoderoh_encoder <span class="token operator">=</span> OneHotEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>housing_oh_encoded <span class="token operator">=</span> oh_encoder<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_oh_encoded<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>(20640, 5)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>(20640, 1)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>housing_oh_encoded<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> return_counts<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>(array([[0., 0., 0., 0., 1.],        [0., 0., 0., 1., 0.],        [0., 0., 1., 0., 0.],        [0., 1., 0., 0., 0.],        [1., 0., 0., 0., 0.]]), array([2658, 2290,    5, 6551, 9136], dtype=int64))</code></pre><p>OneHotEncoder also has limitations when handling categorical attributes especially when a categorical attribute has a large number of possible categories (e.g., post code, profession, species, etc.), in this case, OneHotEncoder could introduce a large number of input features, which could slow down training and degrade performance. In this case it is probably better to replace the categorical attributes with useful numerical features related to the categories: for example, the ‘ocean_proximity’ could be replaces with the distance to the ocean. </p><h2 id="Encode-categorical-labels"><a href="#Encode-categorical-labels" class="headerlink" title="Encode categorical labels"></a>Encode categorical labels</h2><p>LabelEncoder could be used to encode target labels with value between 0 and n_classes-1. It works more or less the same as OrdinalEncoder.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>l_encoder <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>housing_l_encoded <span class="token operator">=</span> l_encoder<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>housing_l_encoded<span class="token punctuation">,</span> return_counts<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>(array([0, 1, 2, 3, 4]), array([9136, 6551,    5, 2290, 2658], dtype=int64))</code></pre><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p>Aurelien Geron, <a href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/">Hands-On Machine Learning with Scikit-Learn &amp; TensorFlow</a></p>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> pandas </tag>
            
            <tag> sklearn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Feature scaling using Scikit-Learn</title>
      <link href="/20240129/feature-scaling-using-scikit-learn/"/>
      <url>/20240129/feature-scaling-using-scikit-learn/</url>
      
        <content type="html"><![CDATA[<h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>The widely used dataset: <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a> to note down two ways to apply one of the most important transformations which is called feature scaling. This technique is used mainly when the input numerical attributes have very different scales which generate difficulty for the performance of machine learning algorithm. </p><p>For this dataset we can see the issue that the numerical attributes have very different scales, for example the total number of rooms ranges from about 2 to 39,320, while the median incomes only range from 0 to 15.</p><p>The first step is to download the data from Kaggle and read it by using Pandas. </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plthousing <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'housing.csv'</span><span class="token punctuation">)</span>housing<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>longitude</th>      <th>latitude</th>      <th>housing_median_age</th>      <th>total_rooms</th>      <th>total_bedrooms</th>      <th>population</th>      <th>households</th>      <th>median_income</th>      <th>median_house_value</th>      <th>ocean_proximity</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-122.23</td>      <td>37.88</td>      <td>41.0</td>      <td>880.0</td>      <td>129.0</td>      <td>322.0</td>      <td>126.0</td>      <td>8.3252</td>      <td>452600.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>1</th>      <td>-122.22</td>      <td>37.86</td>      <td>21.0</td>      <td>7099.0</td>      <td>1106.0</td>      <td>2401.0</td>      <td>1138.0</td>      <td>8.3014</td>      <td>358500.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>2</th>      <td>-122.24</td>      <td>37.85</td>      <td>52.0</td>      <td>1467.0</td>      <td>190.0</td>      <td>496.0</td>      <td>177.0</td>      <td>7.2574</td>      <td>352100.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>3</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1274.0</td>      <td>235.0</td>      <td>558.0</td>      <td>219.0</td>      <td>5.6431</td>      <td>341300.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>4</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1627.0</td>      <td>280.0</td>      <td>565.0</td>      <td>259.0</td>      <td>3.8462</td>      <td>342200.0</td>      <td>NEAR BAY</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'total_rooms'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>total_rooms</th>    </tr>  </thead>  <tbody>    <tr>      <th>count</th>      <td>20640.000000</td>    </tr>    <tr>      <th>mean</th>      <td>2635.763081</td>    </tr>    <tr>      <th>std</th>      <td>2181.615252</td>    </tr>    <tr>      <th>min</th>      <td>2.000000</td>    </tr>    <tr>      <th>25%</th>      <td>1447.750000</td>    </tr>    <tr>      <th>50%</th>      <td>2127.000000</td>    </tr>    <tr>      <th>75%</th>      <td>3148.000000</td>    </tr>    <tr>      <th>max</th>      <td>39320.000000</td>    </tr>  </tbody></table></div><h2 id="Normalization"><a href="#Normalization" class="headerlink" title="Normalization"></a>Normalization</h2><p>Normalization is also called min-max scaling, it applies that values in the attributes to be shifted and rescaled to the range from 0 to 1 by default (it can be changed by identify the feature_range tuple). It is calculated by subtracting the min value and dividing by the max minus the min.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScalerm_scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span>feature_range<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>housing_m_scaled <span class="token operator">=</span> m_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">m_scaler<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">m_scaler<span class="token punctuation">.</span>scale_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([1.96078431e-02, 2.54336436e-05, 1.55183116e-04, 2.80276914e-05,       1.64446637e-04, 6.89645660e-02, 2.06184717e-06])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_m_scaled<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([0.78431373, 0.02233074, 0.01986344, 0.00894083, 0.02055583,       0.53966842, 0.90226638])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_m_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with MinMaxScaler'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-8-0.png" alt="MinMaxScaler"></p><h3 id="MaxAbsScaler"><a href="#MaxAbsScaler" class="headerlink" title="MaxAbsScaler"></a>MaxAbsScaler</h3><p>MaxAbsScaler is similar to MinMaxScaler except that the values are mapped across several ranges depending on whether negative or positive values are present. If only positive values are present the range is from 0 to 1, if only negative then -1 to 0, if both negative and positive values are present, the range would be -1 to 1.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MaxAbsScalerma_scaler <span class="token operator">=</span> MaxAbsScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>housing_ma_scaled <span class="token operator">=</span> ma_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">ma_scaler<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">ma_scaler<span class="token punctuation">.</span>scale_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([5.20000e+01, 3.93200e+04, 6.44500e+03, 3.56820e+04, 6.08200e+03,       1.50001e+01, 5.00001e+05])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_ma_scaled<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([0.78846154, 0.02238047, 0.02001552, 0.00902416, 0.02071687,       0.55500963, 0.90519819])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_ma_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with MaxAbsScaler'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-14-0.png" alt="MaxAbsScaler"></p><h3 id="PowerTransformer"><a href="#PowerTransformer" class="headerlink" title="PowerTransformer"></a>PowerTransformer</h3><p>PowerTransformer applies a power transformation to each feature to make the data more Gaussian-like in order to stabilize variance and minimize skewness. By default, it applies zero-mean, unit variance normalization.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PowerTransformerp_transformer <span class="token operator">=</span> PowerTransformer<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'box-cox'</span><span class="token punctuation">)</span>housing_p_scaled <span class="token operator">=</span> p_transformer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">p_transformer<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">p_transformer<span class="token punctuation">.</span>lambdas_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([0.80939809, 0.22078296, 0.22469489, 0.23576758, 0.24492865,       0.09085449, 0.12474767])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_p_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with PowerTransformer'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-19-0.png" alt="PowerTransformer"></p><h2 id="Standardization"><a href="#Standardization" class="headerlink" title="Standardization"></a>Standardization</h2><p>Standardization removes the mean (so standardized values always have a zero mean) and scales the data to unit variance. Standardization does not bound values to a specific range, which may be a problem for some algorithms (e.g., neural networks often expect an input value ranging from 0 to 1). In addition, standardization is much less affected by outliers.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScalers_scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>housing_s_scaled <span class="token operator">=</span> s_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">s_scaler<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">s_scaler<span class="token punctuation">.</span>scale_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([1.25852527e+01, 2.18156240e+03, 4.21374759e+02, 1.13243469e+03,       3.82320491e+02, 1.89977569e+00, 1.15392820e+05])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_s_scaled<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([ 0.98214266, -0.8048191 , -0.97032521, -0.9744286 , -0.97703285,        2.34476576,  2.12963148])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_s_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with StandardScaler'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-25-0.png" alt="StandardScaler"></p><h3 id="RobustScaler"><a href="#RobustScaler" class="headerlink" title="RobustScaler"></a>RobustScaler</h3><p>The centering and scaling statistics of RobustScaler are based on the quantile range (defaults to IQR: interquantile Range). The IQR is the range between the 1st quanrtile (25th quantile) and the 3rd quartile (75th quantile). This provides good performance over outliers by defining the quantile_range.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> RobustScalerr_scaler <span class="token operator">=</span> RobustScaler<span class="token punctuation">(</span>quantile_range<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span><span class="token number">0.95</span><span class="token punctuation">)</span><span class="token punctuation">)</span>housing_r_scaled <span class="token operator">=</span> r_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">r_scaler<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">r_scaler<span class="token punctuation">.</span>scale_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([2.000000e+00, 1.360000e+02, 3.100000e+01, 7.207050e+01,       2.507050e+01, 5.601846e-01, 2.310415e+04])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_r_scaled<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([  6.        ,  -9.16911765,  -9.87096774, -11.71075544,       -11.28816737,   8.55146678,  11.81173079])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_r_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with RobustScaler'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-31-0.png" alt="RobustScaler"></p><h3 id="GuantileTransformer"><a href="#GuantileTransformer" class="headerlink" title="GuantileTransformer"></a>GuantileTransformer</h3><p>QuantileTransformer applies a non-linear fransformation so that the probability density function of each feature will be mapped to a uniform or Gaussian distribution. In this case, all the data, including outliers, will be mapped to uniform or Gaussian distribution, making outliers indistinguishable from inliers.</p><p>But contrary to RobustScaler, QuantileTransformer will also automatically collapse any outlier by setting them to the a priori defined range boundaries (0 and 1). This can result in saturation artifacts for extreme values.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> QuantileTransformergu_transformer <span class="token operator">=</span> QuantileTransformer<span class="token punctuation">(</span>output_distribution<span class="token operator">=</span><span class="token string">'uniform'</span><span class="token punctuation">)</span>housing_gu_scaled <span class="token operator">=</span> gu_transformer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">gu_transformer<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">gu_transformer<span class="token punctuation">.</span>quantiles_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([1.0000e+00, 8.0000e+00, 1.0000e+00, 3.0000e+00, 1.0000e+00,       4.9990e-01, 1.4999e+04])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_gu_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with QuantileTransformer (uniform)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-36-0.png" alt="QuantileTransformer (uniform)"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> QuantileTransformergn_transformer <span class="token operator">=</span> QuantileTransformer<span class="token punctuation">(</span>output_distribution<span class="token operator">=</span><span class="token string">'normal'</span><span class="token punctuation">)</span>housing_gn_scaled <span class="token operator">=</span> gn_transformer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'ocean_proximity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">gn_transformer<span class="token punctuation">.</span>feature_names_in_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array(['housing_median_age', 'total_rooms', 'total_bedrooms',       'population', 'households', 'median_income', 'median_house_value'],      dtype=object)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">gn_transformer<span class="token punctuation">.</span>quantiles_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([1.0000e+00, 2.0000e+00, 1.0000e+00, 5.0000e+00, 2.0000e+00,       4.9990e-01, 1.4999e+04])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>housing_gn_scaled<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Box Plot: Total Rooms with QuantileTransformer (normal)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Scaled Total Rooms)'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Feature-scaling-using-Scikit-Learn-output-40-0.png" alt="QuantileTransformer(normal)"></p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> seaborn </tag>
            
            <tag> sklearn </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Imputation of missing values using Scikit-Learn</title>
      <link href="/20240124/imputation-of-missing-values-using-scikit-learn/"/>
      <url>/20240124/imputation-of-missing-values-using-scikit-learn/</url>
      
        <content type="html"><![CDATA[<h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>The widely used dataset: <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a> to note down two ways to handle missing values in dataset by using Scikit-Learn. One type of imputation algorithm is univariate, and the other is multivariate imputation. </p><p>The first step is to download the data from Kaggle and read it by using Pandas. </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdhousing <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'housing.csv'</span><span class="token punctuation">)</span>housing<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>longitude</th>      <th>latitude</th>      <th>housing_median_age</th>      <th>total_rooms</th>      <th>total_bedrooms</th>      <th>population</th>      <th>households</th>      <th>median_income</th>      <th>median_house_value</th>      <th>ocean_proximity</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-122.23</td>      <td>37.88</td>      <td>41.0</td>      <td>880.0</td>      <td>129.0</td>      <td>322.0</td>      <td>126.0</td>      <td>8.3252</td>      <td>452600.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>1</th>      <td>-122.22</td>      <td>37.86</td>      <td>21.0</td>      <td>7099.0</td>      <td>1106.0</td>      <td>2401.0</td>      <td>1138.0</td>      <td>8.3014</td>      <td>358500.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>2</th>      <td>-122.24</td>      <td>37.85</td>      <td>52.0</td>      <td>1467.0</td>      <td>190.0</td>      <td>496.0</td>      <td>177.0</td>      <td>7.2574</td>      <td>352100.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>3</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1274.0</td>      <td>235.0</td>      <td>558.0</td>      <td>219.0</td>      <td>5.6431</td>      <td>341300.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>4</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1627.0</td>      <td>280.0</td>      <td>565.0</td>      <td>259.0</td>      <td>3.8462</td>      <td>342200.0</td>      <td>NEAR BAY</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>longitude               0latitude                0housing_median_age      0total_rooms             0total_bedrooms        207population              0households              0median_income           0median_house_value      0ocean_proximity         0dtype: int64</code></pre><h2 id="Univariate-feature-imputation"><a href="#Univariate-feature-imputation" class="headerlink" title="Univariate feature imputation"></a>Univariate feature imputation</h2><p>This method imputes values in the i-th feature dimension using only non-missing values in that feature dimension. Missing values can be imputed with a provided constant value, or using the statistics (mean, median or most frequent) of each column in which the missing values are located. </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>impute <span class="token keyword">import</span> SimpleImputers_imp <span class="token operator">=</span> SimpleImputer<span class="token punctuation">(</span>missing_values<span class="token operator">=</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> strategy<span class="token operator">=</span><span class="token string">'median'</span><span class="token punctuation">)</span>s_imp<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SimpleImputer(strategy='median')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div></div></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">s_imp<span class="token punctuation">.</span>statistics_<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([-1.1849e+02,  3.4260e+01,  2.9000e+01,  2.1270e+03,  4.3500e+02,        1.1660e+03,  4.0900e+02,  3.5348e+00,  1.7970e+05])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([-1.1849e+02,  3.4260e+01,  2.9000e+01,  2.1270e+03,  4.3500e+02,        1.1660e+03,  4.0900e+02,  3.5348e+00,  1.7970e+05])</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># After transform by the imputer, the result is a plain Numpy array, therefore it needs to be put back into a Pandas DataFrame.</span>housing_s <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>s_imp<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span>housing_s<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>longitude             0latitude              0housing_median_age    0total_rooms           0total_bedrooms        0population            0households            0median_income         0median_house_value    0dtype: int64</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_s<span class="token punctuation">[</span><span class="token string">'total_bedrooms'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>435.0</code></pre><h2 id="Multivariate-feature-imputation"><a href="#Multivariate-feature-imputation" class="headerlink" title="Multivariate feature imputation"></a>Multivariate feature imputation</h2><p>As its names stands, multivariate imputation algorithms use the entire set of available feature dimensions to estimate the missing values. This algorithm models each feature with missing values as a function of other features, and uses that estimate for imputation.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>experimental <span class="token keyword">import</span> enable_iterative_imputer<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>impute <span class="token keyword">import</span> IterativeImputerm_imp <span class="token operator">=</span> IterativeImputer<span class="token punctuation">(</span>max_iter<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>m_imp<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>IterativeImputer(random_state=0)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">IterativeImputer</label><div class="sk-toggleable__content"><pre>IterativeImputer(random_state=0)</pre></div></div></div></div></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_m <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>m_imp<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"ocean_proximity"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span>housing_m<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>longitude             0latitude              0housing_median_age    0total_rooms           0total_bedrooms        0population            0households            0median_income         0median_house_value    0dtype: int64</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing_m<span class="token punctuation">[</span><span class="token string">'total_bedrooms'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>435.0</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltfig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s_heights<span class="token punctuation">,</span> s_bins <span class="token operator">=</span> np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>housing_s<span class="token punctuation">[</span><span class="token string">'total_bedrooms'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>m_heights<span class="token punctuation">,</span> m_bins <span class="token operator">=</span> np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>housing_m<span class="token punctuation">[</span><span class="token string">'total_bedrooms'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span>s_bins<span class="token punctuation">)</span>width <span class="token operator">=</span> <span class="token punctuation">(</span>s_bins<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> m_bins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span>ax<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>s_bins<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_heights<span class="token punctuation">,</span> width<span class="token operator">=</span>width<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'cornflowerblue'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>m_bins<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>width<span class="token punctuation">,</span> m_heights<span class="token punctuation">,</span> width<span class="token operator">=</span>width<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'seagreen'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>&lt;BarContainer object of 25 artists&gt;</code></pre><p><img src="https://media.publit.io/file/Imputation-of-missing-values-using-Scikit-Learn-output-13-1.png" alt="Single vs mutivariate imputation visualization "></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> snsdf <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>housing_s<span class="token punctuation">[</span><span class="token string">'total_bedrooms'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> housing_m<span class="token punctuation">[</span><span class="token string">'total_bedrooms'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'total_bedrooms_s'</span><span class="token punctuation">,</span> <span class="token string">'total_bedrooms_m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>rc<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'figure.figsize'</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>df<span class="token punctuation">.</span>melt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'value'</span><span class="token punctuation">,</span> hue<span class="token operator">=</span><span class="token string">'variable'</span><span class="token punctuation">,</span> multiple<span class="token operator">=</span><span class="token string">'dodge'</span><span class="token punctuation">,</span> shrink<span class="token operator">=</span><span class="token number">.75</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/Imputation-of-missing-values-using-Scikit-Learn-output-14-0.png" alt="Single vs mutivariate imputation visualization by Seaborn"></p>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> seaborn </tag>
            
            <tag> sklearn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Exams Correlations in the Dataset</title>
      <link href="/20240123/exams-correlations-in-the-dataset/"/>
      <url>/20240123/exams-correlations-in-the-dataset/</url>
      
        <content type="html"><![CDATA[<h2 id="Data-Preparation"><a href="#Data-Preparation" class="headerlink" title="Data Preparation"></a>Data Preparation</h2><p>We are going to use a widely used dataset: <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a> to note down two common ways to illustrate the correlations between every pair of attributes in the dataset.</p><p>The first step is to download the data from Kaggle and read it by using Pandas. </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdhousing <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'housing.csv'</span><span class="token punctuation">)</span>housing<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>longitude</th>      <th>latitude</th>      <th>housing_median_age</th>      <th>total_rooms</th>      <th>total_bedrooms</th>      <th>population</th>      <th>households</th>      <th>median_income</th>      <th>median_house_value</th>      <th>ocean_proximity</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-122.23</td>      <td>37.88</td>      <td>41.0</td>      <td>880.0</td>      <td>129.0</td>      <td>322.0</td>      <td>126.0</td>      <td>8.3252</td>      <td>452600.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>1</th>      <td>-122.22</td>      <td>37.86</td>      <td>21.0</td>      <td>7099.0</td>      <td>1106.0</td>      <td>2401.0</td>      <td>1138.0</td>      <td>8.3014</td>      <td>358500.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>2</th>      <td>-122.24</td>      <td>37.85</td>      <td>52.0</td>      <td>1467.0</td>      <td>190.0</td>      <td>496.0</td>      <td>177.0</td>      <td>7.2574</td>      <td>352100.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>3</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1274.0</td>      <td>235.0</td>      <td>558.0</td>      <td>219.0</td>      <td>5.6431</td>      <td>341300.0</td>      <td>NEAR BAY</td>    </tr>    <tr>      <th>4</th>      <td>-122.25</td>      <td>37.85</td>      <td>52.0</td>      <td>1627.0</td>      <td>280.0</td>      <td>565.0</td>      <td>259.0</td>      <td>3.8462</td>      <td>342200.0</td>      <td>NEAR BAY</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">housing<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'scatter'</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'longitude'</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token string">'latitude'</span><span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>&lt;Axes: xlabel='longitude', ylabel='latitude'&gt;</code></pre><p><img src="https://media.publit.io/file/Exams-Correlations-in-the-Dataset-output-2-1.png" alt="high density area"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span>matplotlib inline<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plthousing<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'scatter'</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'longitude'</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token string">'latitude'</span><span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span>            s<span class="token operator">=</span>housing<span class="token punctuation">[</span><span class="token string">'population'</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'Population'</span><span class="token punctuation">,</span>            c<span class="token operator">=</span><span class="token string">'median_house_value'</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>get_cmap<span class="token punctuation">(</span><span class="token string">'jet'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>colorbar<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>&lt;matplotlib.legend.Legend at 0x26bee165690&gt;</code></pre><p><img src="https://media.publit.io/file/Exams-Correlations-in-the-Dataset-output-3-1.png" alt="population vs location density"></p><h2 id="Method-1-Standard-Correlation-Coefficient"><a href="#Method-1-Standard-Correlation-Coefficient" class="headerlink" title="Method 1: Standard Correlation Coefficient"></a>Method 1: Standard Correlation Coefficient</h2><p>If the dataset is not too large, it is easy to calculate the standard correlation coefficient by using the corr() method.</p><p>The correlation coefficient ranges from -1 to 1, when it is close to -1, it means that there is a strong negative correlation, while when the coefficient is close to 1, it means that there is a strong positive correlation. Finally, coefficients close to zero mean that there is no linear correlation.</p><p>The correlation coefficient only measures linear correlations (“if x goes up, then y generally goes up or down”). It may completely miss out on nonlinear relationships.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>corr_matrix <span class="token operator">=</span> housing<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span>corr_matrix<span class="token punctuation">[</span><span class="token string">'median_house_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>median_house_value    1.000000median_income         0.688075total_rooms           0.134153housing_median_age    0.105623households            0.065843total_bedrooms        0.049686population           -0.024650longitude            -0.045967latitude             -0.144160Name: median_house_value, dtype: float64</code></pre><h2 id="Method-2-Pandas-scatter-matrix-Function"><a href="#Method-2-Pandas-scatter-matrix-Function" class="headerlink" title="Method 2: Pandas scatter_matrix Function"></a>Method 2: Pandas scatter_matrix Function</h2><p>Pandas’ scatter_matrix function plots every numerical attribute against every other numerical attribute, this could help to find out the correlation bettween each attribute visually.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pandas<span class="token punctuation">.</span>plotting <span class="token keyword">import</span> scatter_matrixattributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'median_house_value'</span><span class="token punctuation">,</span> <span class="token string">'median_income'</span><span class="token punctuation">,</span> <span class="token string">'total_rooms'</span><span class="token punctuation">,</span> <span class="token string">'housing_median_age'</span><span class="token punctuation">]</span>scatter_matrix<span class="token punctuation">(</span>housing<span class="token punctuation">[</span>attributes<span class="token punctuation">]</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>array([[&lt;Axes: xlabel='median_house_value', ylabel='median_house_value'&gt;,        &lt;Axes: xlabel='median_income', ylabel='median_house_value'&gt;,        &lt;Axes: xlabel='total_rooms', ylabel='median_house_value'&gt;,        &lt;Axes: xlabel='housing_median_age', ylabel='median_house_value'&gt;],       [&lt;Axes: xlabel='median_house_value', ylabel='median_income'&gt;,        &lt;Axes: xlabel='median_income', ylabel='median_income'&gt;,        &lt;Axes: xlabel='total_rooms', ylabel='median_income'&gt;,        &lt;Axes: xlabel='housing_median_age', ylabel='median_income'&gt;],       [&lt;Axes: xlabel='median_house_value', ylabel='total_rooms'&gt;,        &lt;Axes: xlabel='median_income', ylabel='total_rooms'&gt;,        &lt;Axes: xlabel='total_rooms', ylabel='total_rooms'&gt;,        &lt;Axes: xlabel='housing_median_age', ylabel='total_rooms'&gt;],       [&lt;Axes: xlabel='median_house_value', ylabel='housing_median_age'&gt;,        &lt;Axes: xlabel='median_income', ylabel='housing_median_age'&gt;,        &lt;Axes: xlabel='total_rooms', ylabel='housing_median_age'&gt;,        &lt;Axes: xlabel='housing_median_age', ylabel='housing_median_age'&gt;]],      dtype=object)</code></pre><p><img src="https://media.publit.io/file/Exams-Correlations-in-the-Dataset-output-7-1.png" alt="scatter matrix"></p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p>Aurelien Geron, <a href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/">Hands-On Machine Learning with Scikit-Learn &amp; TensorFlow</a></p>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>keras入门：第一个深度学习项目</title>
      <link href="/20240121/keras-ru-men-di-yi-ge-shen-du-xue-xi-xiang-mu/"/>
      <url>/20240121/keras-ru-men-di-yi-ge-shen-du-xue-xi-xiang-mu/</url>
      
        <content type="html"><![CDATA[<h2 id="从Keras自带MNIST数据集中读取数据"><a href="#从Keras自带MNIST数据集中读取数据" class="headerlink" title="从Keras自带MNIST数据集中读取数据"></a>从Keras自带MNIST数据集中读取数据</h2><p>MNIST dataset, a large database of handwritten digits that is commonly used for training various image processing systems. MNIST dataset has 60,000 training images, plus 10,000 test images, assembled by the National Institute of Standards and Technology in the 1980s.</p><p>参考链接：</p><p><a href="https://en.wikipedia.org/wiki/MNIST_database">https://en.wikipedia.org/wiki/MNIST_database</a></p><p><a href="https://github.com/mbornet-hl/MNIST">https://github.com/mbornet-hl/MNIST</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> mnist<span class="token punctuation">(</span>train_images<span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test_images<span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz11490434/11490434 [==============================] - 1s 0us/step</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_images<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>(60000, 28, 28)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">test_labels<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>array([7, 2, 1, ..., 4, 5, 6], dtype=uint8)</code></pre><h2 id="设计神经网络架构"><a href="#设计神经网络架构" class="headerlink" title="设计神经网络架构"></a>设计神经网络架构</h2><p>首先将训练数据导入神经网络，网络学习图片和label之间的关系，最终生成模型。模型可以用于预测测试图片的label，最终我们通过测试label和预测的label比较来评估模型。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> keras <span class="token keyword">import</span> models<span class="token keyword">from</span> keras <span class="token keyword">import</span> layerswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>network <span class="token operator">=</span> models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>network<span class="token punctuation">.</span>add<span class="token punctuation">(</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>network<span class="token punctuation">.</span>add<span class="token punctuation">(</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="网络编译"><a href="#网络编译" class="headerlink" title="网络编译"></a>网络编译</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">network<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'rmsprop'</span><span class="token punctuation">,</span>                loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span>                metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="数据转换和重组"><a href="#数据转换和重组" class="headerlink" title="数据转换和重组"></a>数据转换和重组</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_images <span class="token operator">=</span> train_images<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">60000</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>train_images <span class="token operator">=</span> train_images<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span>test_images <span class="token operator">=</span> test_images<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_images <span class="token operator">=</span> test_images<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span>warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="模型训练"><a href="#模型训练" class="headerlink" title="模型训练"></a>模型训练</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> to_categoricaltrain_labels <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>train_labels<span class="token punctuation">)</span>test_labels <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>test_labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">network<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_images<span class="token punctuation">,</span> train_labels<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>Epoch 1/5469/469 [==============================] - 4s 8ms/step - loss: 0.0286 - accuracy: 0.9915Epoch 2/5469/469 [==============================] - 4s 7ms/step - loss: 0.0210 - accuracy: 0.9939Epoch 3/5469/469 [==============================] - 3s 7ms/step - loss: 0.0160 - accuracy: 0.9959Epoch 4/5469/469 [==============================] - 3s 7ms/step - loss: 0.0122 - accuracy: 0.9968Epoch 5/5469/469 [==============================] - 3s 7ms/step - loss: 0.0089 - accuracy: 0.9979</code></pre><h2 id="模型评估"><a href="#模型评估" class="headerlink" title="模型评估"></a>模型评估</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">test_loss<span class="token punctuation">,</span> test_acc <span class="token operator">=</span> network<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_images<span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Model test accuracy: "</span><span class="token punctuation">,</span> test_acc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>313/313 [==============================] - 1s 3ms/step - loss: 0.0582 - accuracy: 0.9832Model test accuracy:  0.9832000136375427</code></pre><p>参考：</p><p>Francois Chollet, Deep Learning with Python</p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python中关于时间的处理方式</title>
      <link href="/20211220/python-zhong-guan-yu-shi-jian-de-chu-li-fang-shi/"/>
      <url>/20211220/python-zhong-guan-yu-shi-jian-de-chu-li-fang-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="Python中关于时间的处理方式"><a href="#Python中关于时间的处理方式" class="headerlink" title="Python中关于时间的处理方式"></a>Python中关于时间的处理方式</h2><p>由于时间是不同于一般数字的另外一种格式，如何处理包含日期在内的时间问题，和各种之间格式之间的转换在面对财务时间数据分析时特别重要，Python提供了多种时间处理方式，这份笔记简单记录这些方法。</p><h3 id="datetime库"><a href="#datetime库" class="headerlink" title="datetime库"></a>datetime库</h3><h4 id="datetime对象"><a href="#datetime对象" class="headerlink" title="datetime对象"></a>datetime对象</h4><p>datetime库中的datetime对象提供了绝大部分日期和时间相关的操作。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入datetime库</span><span class="token keyword">import</span> datetime <span class="token keyword">as</span> dt<span class="token comment"># 获取当前时间</span>dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>datetime.datetime(2021, 12, 20, 15, 40, 23, 156963)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 另外一种获取当前时间的方式</span>dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>datetime.datetime(2021, 12, 20, 15, 41, 43, 422976)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 如果给定一个datetime对象，可以通过weekday()获取到这一天是星期几（结果从0开始到6分别表示星期一到星期日）</span>dt<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">.</span>weekday<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>6</code></pre><p>从上面结果可以看到，时间的默认精确度到了微秒，有时候这个级别的精确度不重要，可以用replace函数将其去掉。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">d <span class="token operator">=</span> dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"现在的时间是： </span><span class="token interpolation"><span class="token punctuation">{</span>d<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>new_d <span class="token operator">=</span> d<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>microsecond<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"现在的时间是： </span><span class="token interpolation"><span class="token punctuation">{</span>new_d<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>现在的时间是： 2021-12-20 15:51:56.736694现在的时间是： 2021-12-20 15:51:56</code></pre><h4 id="timedelta对象"><a href="#timedelta对象" class="headerlink" title="timedelta对象"></a>timedelta对象</h4><p>时间间隔是用timedelta对象表示，这在计算两个时间点之间的时间长度比较重要，比如计算2021年1月1日到现在的时间可以通过下面的方式计算出来。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">start <span class="token operator">=</span> dt<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>delta_time <span class="token operator">=</span> dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'总共时间间隔： </span><span class="token interpolation"><span class="token punctuation">{</span>delta_time<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'天数：</span><span class="token interpolation"><span class="token punctuation">{</span>delta_time<span class="token punctuation">.</span>days<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'秒数：</span><span class="token interpolation"><span class="token punctuation">{</span>delta_time<span class="token punctuation">.</span>seconds<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'微秒数：</span><span class="token interpolation"><span class="token punctuation">{</span>delta_time<span class="token punctuation">.</span>microseconds<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'总共秒数：</span><span class="token interpolation"><span class="token punctuation">{</span>delta_time<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>总共时间间隔： 353 days, 16:02:54.882767天数：353秒数：57774微秒数：882767总共秒数：30556974.882767</code></pre><h4 id="时间格式"><a href="#时间格式" class="headerlink" title="时间格式"></a>时间格式</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ISO标准时间格式</span>d<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>'2021-12-20T15:51:56.736694'</code></pre><p>如果需要变化成其他格式表示，可以通过strftime()函数，详细的格式可以参考<a href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior">Python官方文档</a>。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">d<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%A, %d. %B %Y %I:%M%p"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>'Monday, 20. December 2021 03:51PM'</code></pre><h4 id="不同时区时间"><a href="#不同时区时间" class="headerlink" title="不同时区时间"></a>不同时区时间</h4><p>除了now()可以用来获取当前所在位置时间外，使用utcnow()可以获取到UTC时区所对应的当前时间。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>datetime.datetime(2021, 12, 20, 15, 20, 42, 275498)</code></pre><p>但是datetime只提供了显示当前UTC所对应的时间，如果需要知道其他时区当前时间可以通过新建<a href="https://docs.python.org/3/library/datetime.html#datetime.tzinfo">tzinfo</a>类的方式来获取，同时也可以通过导入pytz库的方式来获取。pytz的方式更加简单方便。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入pytz库</span><span class="token keyword">import</span> pytz<span class="token comment"># 获取中国所在的时区</span>pytz<span class="token punctuation">.</span>country_timezones<span class="token punctuation">[</span><span class="token string">'CN'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>['Asia/Shanghai', 'Asia/Urumqi']</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 获取美国东部当前时间</span>d <span class="token operator">=</span> dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>d<span class="token punctuation">.</span>astimezone<span class="token punctuation">(</span>pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">"EST"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>datetime.datetime(2021, 12, 20, 10, 31, 41, 949550, tzinfo=&lt;StaticTzInfo 'EST'&gt;)</code></pre><h3 id="NumPy"><a href="#NumPy" class="headerlink" title="NumPy"></a>NumPy</h3><p>NumPy也提供了一些处理时间的方法</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npnd <span class="token operator">=</span> np<span class="token punctuation">.</span>datetime64<span class="token punctuation">(</span><span class="token string">'2021-12-20'</span><span class="token punctuation">)</span>nd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>numpy.datetime64('2021-12-20')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将datetime格式的时间转化为numpy格式</span>d <span class="token operator">=</span> dt<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>datetime64<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>numpy.datetime64('2021-12-20T00:00:00.000000')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将numpy时间格式转化为datetime格式可以使用astype函数</span>nd<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>dt<span class="token punctuation">.</span>datetime<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>datetime.date(2021, 12, 20)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用arange生成时间序列，时间间隔1小时</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token string">'2021-12-19T00:00:00'</span><span class="token punctuation">,</span><span class="token string">'2021-12-20T12:00:00'</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'datetime64[h]'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>array(['2021-12-19T00', '2021-12-19T01', '2021-12-19T02', '2021-12-19T03',       '2021-12-19T04', '2021-12-19T05', '2021-12-19T06', '2021-12-19T07',       '2021-12-19T08', '2021-12-19T09', '2021-12-19T10', '2021-12-19T11',       '2021-12-19T12', '2021-12-19T13', '2021-12-19T14', '2021-12-19T15',       '2021-12-19T16', '2021-12-19T17', '2021-12-19T18', '2021-12-19T19',       '2021-12-19T20', '2021-12-19T21', '2021-12-19T22', '2021-12-19T23',       '2021-12-20T00', '2021-12-20T01', '2021-12-20T02', '2021-12-20T03',       '2021-12-20T04', '2021-12-20T05', '2021-12-20T06', '2021-12-20T07',       '2021-12-20T08', '2021-12-20T09', '2021-12-20T10', '2021-12-20T11'],      dtype='datetime64[h]')</code></pre><h3 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h3><p>pandas时间处理方法主要包含Timestamp和to_pydatetime函数。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Timestamp<span class="token punctuation">(</span><span class="token string">'2021-12-20'</span><span class="token punctuation">)</span>ts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Timestamp('2021-12-20 00:00:00')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">d <span class="token operator">=</span> ts<span class="token punctuation">.</span>to_pydatetime<span class="token punctuation">(</span><span class="token punctuation">)</span>d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>datetime.datetime(2021, 12, 20, 0, 0)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">'2021-12-20'</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>Timestamp('2021-12-20 00:00:00')</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用date_range生成时间序列，时间间隔为1个月</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2021-1-1'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'M'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>DatetimeIndex(['2021-01-31', '2021-02-28', '2021-03-31', '2021-04-30',               '2021-05-31', '2021-06-30', '2021-07-31', '2021-08-31',               '2021-09-30', '2021-10-31', '2021-11-30', '2021-12-31'],              dtype='datetime64[ns]', freq='M')</code></pre><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p>-<a href="https://www.oreilly.com/library/view/python-for-finance/9781492024323/">Yves Hilpisch, Python for Finance - Analyze Big Financial Data</a></p>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> pandas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>backtrader：设计一个简单的SMA策略</title>
      <link href="/20211219/backtrader-she-ji-yi-ge-jian-dan-de-sma-ce-lue/"/>
      <url>/20211219/backtrader-she-ji-yi-ge-jian-dan-de-sma-ce-lue/</url>
      
        <content type="html"><![CDATA[<h2 id="backtrader：设计一个简单的SMA策略"><a href="#backtrader：设计一个简单的SMA策略" class="headerlink" title="backtrader：设计一个简单的SMA策略"></a>backtrader：设计一个简单的SMA策略</h2><h3 id="SMA策略"><a href="#SMA策略" class="headerlink" title="SMA策略"></a>SMA策略</h3><p>SMA的全称是Simple Moving Average，计算的是给定一个时间区间，该区间内价格的平均，统计上来看SMA结果可以平滑掉一些瞬时波动，所以它在描述波动时会有延迟性。由于这个特性，如果当时的股价上涨超过SMA时，则说明后续股价很有可能继续上升，因此建议做多，反之如果当时的股价下跌超过SMA时，则说明后续股价有可能继续下跌，则做空。</p><p>以下我们通过一个简单的例子来看一下如何使用backtrader平台来设计SMA策略，并将这个策略用到股票AAPL的购买上，然后看一下这个策略在全年的收益率，最后比较这个策略与除了第一天全部购买最后一天全部卖出外完全不做任何操作的策略（Buy-and-Hold策略）来看看这个简单的SMA策略的性能。</p><h3 id="导入各种所需的Python库"><a href="#导入各种所需的Python库" class="headerlink" title="导入各种所需的Python库"></a>导入各种所需的Python库</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> <span class="token punctuation">(</span>absolute_import<span class="token punctuation">,</span> division<span class="token punctuation">,</span> print_function<span class="token punctuation">,</span>                        unicode_literals<span class="token punctuation">)</span><span class="token keyword">import</span> backtrader <span class="token keyword">as</span> bt<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> datetime<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token operator">%</span>matplotlib inline<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="设计一个SMA均值策略"><a href="#设计一个SMA均值策略" class="headerlink" title="设计一个SMA均值策略"></a>设计一个SMA均值策略</h3><p>当日Close价格上涨突破均值时，则做多，当日Close价格跌破均值时，则做空</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyStrategy</span><span class="token punctuation">(</span>bt<span class="token punctuation">.</span>Strategy<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment">#设定全局交易策略参数，这里默认SMA的period为20</span>    params <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'period'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sma <span class="token operator">=</span> bt<span class="token punctuation">.</span>indicators<span class="token punctuation">.</span>SimpleMovingAverage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">,</span> period<span class="token operator">=</span>self<span class="token punctuation">.</span>params<span class="token punctuation">.</span>period<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># 如果Close值大于均值，则做多</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>sma <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>close<span class="token punctuation">:</span>            submitted_order <span class="token operator">=</span> self<span class="token punctuation">.</span>buy<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># 如果Close值小于均值，则做空</span>        <span class="token keyword">elif</span> self<span class="token punctuation">.</span>sma <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>close<span class="token punctuation">:</span>            submitted_order <span class="token operator">=</span> self<span class="token punctuation">.</span>sell<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'回测准备启动'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'回测已经结束'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">notify_order</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> order<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'收到一个Order'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h3><p>仍然通过<a href="https://pypi.org/project/yfinance/">yfinance</a>库从雅虎财经上获取，如何获取可以参考<a href="https://www.wenvenn.com/20211215/shi-yong-python-bao-yfinance-du-qu-ya-hu-cai-jing-shang-de-gu-piao-shu-ju/">这里</a>。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'AAPL_20211216.csv'</span><span class="token punctuation">)</span>aapl<span class="token punctuation">[</span><span class="token string">'datetime'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>aapl<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>aapl<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'datetime'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>aapl_daily <span class="token operator">=</span> bt<span class="token punctuation">.</span>feeds<span class="token punctuation">.</span>PandasData<span class="token punctuation">(</span>dataname <span class="token operator">=</span> aapl<span class="token punctuation">,</span>                                fromdate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                todate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="回测设置"><a href="#回测设置" class="headerlink" title="回测设置"></a>回测设置</h3><p>首先启动一个Cerebro。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro <span class="token operator">=</span> bt<span class="token punctuation">.</span>Cerebro<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后将数据传入回测系统</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>adddata<span class="token punctuation">(</span>aapl_daily<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>接下来将交易策略加载到回测系统中 </p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>addstrategy<span class="token punctuation">(</span>MyStrategy<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>设置初始资本为10 000，交易手续费为0.2%（买入和卖出过程中都会产生）。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>broker<span class="token punctuation">.</span>setcash<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span> cerebro<span class="token punctuation">.</span>broker<span class="token punctuation">.</span>setcommission<span class="token punctuation">(</span>commission<span class="token operator">=</span><span class="token number">0.002</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="执行回测"><a href="#执行回测" class="headerlink" title="执行回测"></a>执行回测</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>回测后打印整个策略的表现，最终收益率仅6.17%</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'初始资金：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"回测时间：</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'最终资金：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>cerebro<span class="token punctuation">.</span>broker<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'最终收益：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>cerebro<span class="token punctuation">.</span>broker<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'收益率：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cerebro<span class="token punctuation">.</span>broker<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>初始资金：10000回测时间：2020-01-01:2021-12-15最终资金：10616.64最终收益：616.64收益率：0.0617</code></pre><p>通过cerebro自带的plot函数可以将整个结果画出来，这里可以看到在股票价格上升时买入，在股票价格下降时卖出，符合我们所定的策略规律。</p><p>但同时也可以看到操作的频率比较高，而且整个AAPL在2021年是整体上升的，在不做任何参数优化的前提下，可能从最开始保有股票不做任何操作再到年底全部卖出（Buy-and-hold策略）拿到的收益会更多，下面我们算一下。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span>matplotlib inlineplt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'figure.figsize'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>cerebro<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>iplot<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://media.publit.io/file/backtrader-SMA-fig1.png" alt="一个简单的SMA策略"></p><p>假设选择第一天将所有资金全部购买股票，在最后一天将所持股票卖出，通过下面的计算最终的收益率可以达到38.85%，这么看来我们的SMA策略还有很大的优化空间。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 定义一个mask以便拿到在2021-1-1到2021-12-15之间所有数据 </span>mask <span class="token operator">=</span> <span class="token punctuation">(</span>aapl<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'datetime'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token string">'2021-1-1'</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>aapl<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'datetime'</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token string">'2021-12-15'</span><span class="token punctuation">)</span><span class="token comment"># 获取第一天价格</span>start_price <span class="token operator">=</span> aapl<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Close<span class="token comment"># 将全部10000资金买入，这里假设可以购买小数位股票。</span>num_shares <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10000</span> <span class="token operator">-</span> <span class="token number">10000</span><span class="token operator">*</span><span class="token number">0.002</span><span class="token punctuation">)</span><span class="token operator">/</span>start_price<span class="token comment"># 获取最后一天价格，通过与第一天价格比较可以得到最终收益和收益率</span>end_price <span class="token operator">=</span> aapl<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Close<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'初始资金：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'最终资金：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>num_shares <span class="token operator">*</span> end_price<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'最终收益：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>num_shares <span class="token operator">*</span> end_price <span class="token operator">-</span> <span class="token number">10000</span> <span class="token operator">-</span> num_shares <span class="token operator">*</span> end_price <span class="token operator">*</span> <span class="token number">0.002</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'收益率：</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num_shares <span class="token operator">*</span> end_price <span class="token operator">-</span> <span class="token number">10000</span> <span class="token operator">-</span> num_shares <span class="token operator">*</span> end_price <span class="token operator">*</span> <span class="token number">0.002</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>初始资金：10000最终资金：13912.72最终收益：3884.9收益率：0.3885</code></pre>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> backtrader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>历史回测平台backtrader的快速上手</title>
      <link href="/20211217/li-shi-hui-ce-ping-tai-backtrader-de-kuai-su-shang-shou/"/>
      <url>/20211217/li-shi-hui-ce-ping-tai-backtrader-de-kuai-su-shang-shou/</url>
      
        <content type="html"><![CDATA[<h2 id="历史回测平台backtrader的快速上手"><a href="#历史回测平台backtrader的快速上手" class="headerlink" title="历史回测平台backtrader的快速上手"></a>历史回测平台backtrader的快速上手</h2><p><a href="https://www.backtrader.com/">backtrader</a>是目前全球范围内基于Python功能最完善的量化回测平台之一，有比较大的社区环境，所以很容易找到帮助。框架也很容易理解，对于一个回测需求，使用backtrader主要包含以下7个步骤。</p><ul><li>创立一个Cerebro，Cerebro是西班牙语大脑的意思，这一步就相当于创立一个大脑，后续把数据和策略放进大脑以后我们就可以得到分析结果。</li><li>添加Data Feeds，这里是数据的输入，原始数据需要先做一些处理得到Cerebro能够读取的格式，Data Feeds可以添加pandas（PandasData）的DataFrame数据或者CSV（BackTraderCSVData）原始数据。</li><li>添加策略</li><li>添加其他内容，比如添加writer（addwriter），分析（addanalyzer）或者观察者（addobserver），这一步骤不是必须的。</li><li>修改Broker信息，比如佣金，杠杆率等，这一步骤也不是必须的</li><li>运行策略</li><li>作图画出结果，以便后续修改策略和其他内容再进一步回测。</li></ul><p>以下通过AAPL的历史数据来记录backtrader的快速上手流程。</p><h3 id="导入所需的各种Python包"><a href="#导入所需的各种Python包" class="headerlink" title="导入所需的各种Python包"></a>导入所需的各种Python包</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> <span class="token punctuation">(</span>absolute_import<span class="token punctuation">,</span> division<span class="token punctuation">,</span> print_function<span class="token punctuation">,</span>                        unicode_literals<span class="token punctuation">)</span><span class="token keyword">import</span> backtrader <span class="token keyword">as</span> bt<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> datetime<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="创建一个Cerebro"><a href="#创建一个Cerebro" class="headerlink" title="创建一个Cerebro"></a>创建一个Cerebro</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro <span class="token operator">=</span> bt<span class="token punctuation">.</span>Cerebro<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="添加数据-data-feed"><a href="#添加数据-data-feed" class="headerlink" title="添加数据 data feed"></a>添加数据 data feed</h3><p>这里的数据通过<a href="https://pypi.org/project/yfinance/">yfinance</a>包从雅虎财经上获取，如何获取可以参考<a href="https://www.wenvenn.com/20211215/shi-yong-python-bao-yfinance-du-qu-ya-hu-cai-jing-shang-de-gu-piao-shu-ju/">这里</a>。以下通过pandas读取AAPL的历史数据。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'AAPL_20211216.csv'</span><span class="token punctuation">)</span>aapl<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Date</th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1980-12-12</td>      <td>0.100453</td>      <td>0.100890</td>      <td>0.100453</td>      <td>0.100453</td>      <td>469033600</td>    </tr>    <tr>      <th>1</th>      <td>1980-12-15</td>      <td>0.095649</td>      <td>0.095649</td>      <td>0.095213</td>      <td>0.095213</td>      <td>175884800</td>    </tr>    <tr>      <th>2</th>      <td>1980-12-16</td>      <td>0.088661</td>      <td>0.088661</td>      <td>0.088224</td>      <td>0.088224</td>      <td>105728000</td>    </tr>    <tr>      <th>3</th>      <td>1980-12-17</td>      <td>0.090408</td>      <td>0.090845</td>      <td>0.090408</td>      <td>0.090408</td>      <td>86441600</td>    </tr>    <tr>      <th>4</th>      <td>1980-12-18</td>      <td>0.093029</td>      <td>0.093466</td>      <td>0.093029</td>      <td>0.093029</td>      <td>73449600</td>    </tr>  </tbody></table></div><p>pandas读取上来的数据需要做一些处理，比如时间格式和整个dataframe的index设置。这里采用2009年1月1日开始到现在的天级历史数据作为data feed输入。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl<span class="token punctuation">[</span><span class="token string">'datetime'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>aapl<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>aapl<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'datetime'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>aapl_daily <span class="token operator">=</span> bt<span class="token punctuation">.</span>feeds<span class="token punctuation">.</span>PandasData<span class="token punctuation">(</span>dataname <span class="token operator">=</span> aapl<span class="token punctuation">,</span>                                fromdate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2009</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                todate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>添加Data Feed到Cerebro。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>adddata<span class="token punctuation">(</span>aapl_daily<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="添加策略"><a href="#添加策略" class="headerlink" title="添加策略"></a>添加策略</h3><p>这里添加backtrader自带的默认空策略，仅用于展示功能。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>addstrategy<span class="token punctuation">(</span>bt<span class="token punctuation">.</span>Strategy<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="运行回测"><a href="#运行回测" class="headerlink" title="运行回测"></a>运行回测</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="画出结果图"><a href="#画出结果图" class="headerlink" title="画出结果图"></a>画出结果图</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">cerebro<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> heigth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="data:image/png;base64,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2uPvwQcfbPLjIxorKCiwv+fw2LFj9vu7dOmCI0eOtOr+TNwpGoSG0YHCR825qDcndeei3nzUvPP84Ac/sMffP/7jP9r/3PC9hY3t3bvX/vV9+/bZ7//e976HsrKyVt2fiTtFg9AwOlD4qDkX9eak7lzUm4+ad57777+/yauClmVh+vTpuHz5ss9tDx8+bP96bm4uAODq1av4xje+gfPnz7fq/kzcKRqEhtGBwkfNuag3J3Xnot581LzzdOnSpdlB+P777ze57bFjx5r8+ldffYW///u/9/lew+sxcadoEBpGBwofNeei3pzUnYt681HzztP4ewgbrtOnTzd727/97W/2bd566y0AwCeffNLszyZsiYk7RYPQMDpQ+Kg5F/XmpO5c1JuPmneOd9991x54vXr1gmVZqKmpafH2n3/+uX37RYsWAQA++ugjPPDAA62+TxN3igahYXSg8FFzLurNSd25qDcfNe8cP/zhD+2BN2/ePPsH0LekqqrKvv3cuXMBALm5ufjFL37R6vs0cadoEBpGBwofNeei3pzUnYt681HzztH4j4m+8cYbN7x9TU2Nz186AwDLly/Hc8891+r7NHGnGDUIc3Jy4Ha70aVLF3g8HsorPz+/0x+DLjXXpd661F2XeutS89v9ajwIx40bd8PbFxUV2bePj4+Hx+PBqFGj0Lt371bfpwahn5j4RLcXj0f/hYmNmnNRb07qzkW9+ah552g8COfPn9/qj/nGN76B8ePHIzs7G9HR0YiPj2/1fZq4UzQIDaMDhY+ac1FvTurORb35qHnnsCwLP/nJT9o8CLt164YXX3zRHpPDhw9v9X2auFM0CA2jA4WPmnNRb07qzkW9+ah5vaNHj7b4Ix/am9frtX/EhGVZWLBgQas+bvPmzfjpT3/q8+riK6+80ur7NXGnaBAaRgcKHzXnot6c1J2LevNR83qWZSE8PNwv93Xp0iVYloW6ujpYloVly5a1+mO7du3qMwinTJnS6o81cadoEBpGBwofNeei3pzUnYt681HzepZloU+fPn65ry+//BLf/OY3AdT/LMG6urpWf+zvf/97n0E4bdq0Vn+siTtFg9AwOlD4qDkX9eak7lzUm4+a17MsC7/97W/9cl9lZWX43ve+d1Mfe+HCBZ9B+Nprr7X6Y03cKRqEhtGBwkfNuag3J3Xnot581LyeZVn49a9/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mLsuJue9a9cuV5w3LRymTZuG1q1bB7VusIXwH//4R1C3R+FjYk8xthBqLAYAC6HG3E1+4kCBY946MXddTM5bRPDll1+GexqOO3PmDJo3b44+ffoEtX6whbBkyZJB3R6FDwuhQ1gIWQg1MfmJAwWOeevE3HUxNe/jx49DRPDpp5+GeyqOmzdvHkQEo0ePDmr9YAuhiJFP1VVjIXQICyELoSamPnGg4DBvnZi7LibkvW/fPtx1110+bw9dv349RARTp04N48ycl5aWhiuvvBIigrFjxwa1jWAynzx5srrHOhKwEDqEhZCFUBMTnjiQfZi3TsxdFxPynjhxIkQEK1euxPLlywEAo0ePtl612rdvX5hnGFoDBw5Eo0aNsGHDBsydOxcigrJlyyItLS2o7ZmQOdmDhdAhLIQshJrwIKIL89aJuetiQt59+/a1PsPmfdti06ZNce2110JEsG7dujDPMLRq165tld8XXngBIoKuXbsGvT0TMid7sBA6hIWQhVATHkR0Yd46MXddTMj70UcftQqRtxCWLVsWw4YNg4hg06ZNyMzMRHp6ephnGhq33nqrz/0XEXTr1i3o7ZmQOdmDhdAhLIQshJrwIKIL89aJuetiQt516tRBw4YNrTL06aefQkRw6tQpXH755RARlClTBhUqVEBsbGzEfdHMhffdu0ybNi3o7ZmQOdmDhdAhLIQshJrwIKIL89aJuevi9ryzsrJQvHhxvPPOO36lCIDfZSKCRx55JMyztte//vUvjBo1yuczk/k5/6LbMyf7sBA6hIWQhVATHkR0Yd46MXdd3J53cnIyypQpg88//9yn9D399NMAgGLFivkVwo4dO4Z51vaqWbMmNm/ebNv23J452YeF0CEshCyEmvAgogvz1om56+LmvLt164YRI0agadOmOHr0KKpXr26VvlWrVgEASpQo4VcIe/bsGeaZ2+fMmTMoUKAAjh07Zts23Zw52YuF0CEshOcLocbHQON95kFEF+atE3PXxc15ewveyy+/bF2Wnp6O5ORk6y2TxYsX9yuEAwYMCNeUg/bjjz/i5MmTAM6/Tfall17CsWPH8OKLL+L666+39bbcnDnZi4XQISyELISa8CCiC/PWibnr4ta8z507BxHBZZddhv379+c47s4774SIWOfnExEMHTrUwZnaQ0TQp08fAMCvv/5qfXlOx44d8f77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7xMnTvi96nfvvfcCADp27Ij4+HgAwKxZsyAiqFKliu1zeOyxxyAiWLZsmS3b++yzzyAiGDRoEL744oscx02aNMm6zytWrMCOHTtCcv/yg3/jerAQOoSFkIVQEx5EdGHeOjF3XUKR9zfffONTBuvXr49nnjl/fPcWpuTkZIgIbr75Zhw8eND2OZw5cwaNGjXC3LlzsWPHDmzatClf23v99dfRo0ePPI1dsWIFRAQLFy7EihUrcPfdd+frtu3Gv3E9WAgdwkLIQqhJTgcR07KjvOGTBp2Yuy6hyHvQoEHo0aMH1q9fj7179/pc9/PPP/uUxccff9z22/eKjo7Ghx9+iPLly1/ybZ550b59e7z33nt5GvvXX39BRPDOO+9g/PjxePLJJ/N123bj37geLIQOYSFkIdSEhVAXPmnQibnrEoq8b7zxRqxevTrH61955RWrEH7yySe2375XTEwMxo4diyuuuCJfhTArKwvVqlXDxo0b87zOoEGD8OKLL6JPnz4YPHhw0LcdCvwb14OF0CEshCyEmrAQ6sInDToxd10CyfvcuXP466+/LjnG4/GgUKFCOH78eI5jZs+ene9X7PLi+eefR3R0dK5fBJObHTt24KqrroLH48nzOtOnT8c999yDZs2aYerUqUHfdijwb1wPFkKHsBCyEGqivRB676eG+wrwSYNWzF2XQPLu1atXrsXq1KlTuZ46wuPxOHKS9oEDB+K2227LdyFctGgRGjduHNA63sdBRLBkyZKgbzsU+DeuBwuhQ1gIWQg1YSFkIaTIx9x18eadlZWF9PT0bMd8++23OHPmDB588EGISI7jAODQoUO2nToiv4YPH259frBMmTJBbSMjIwOTJk1CdHR0wOt63xpr16kv7MK/cT1YCB3CQshCqAkLIQshRT7mros37/j4eFSqVCnbMSKC9u3b4/7774eI4Nlnn/W5fu/evahSpQpOnz6NXbt2oXLlyiGfd1588sknEBFERUWhWrVqAa9/9OhRXH311RARxMXFBbz+jh07ICL4/vvvA143lPg3rgcLoUNYCFkINWEhZCGkyMfcI19GRgb++OMPAOfzTk9Pt97euHz5cp+xF771UUQwatQo65yCXh9//DFEBLt27cKsWbNQv359x+7LpRw8eNA6tUXhwoVx4sSJS473eDwYO3YsUlJSAABlypSx7vdzzz0X8O1nZGRYj4ub8G9cDxZCh7AQshBqwkLIQkiRj7lHhszMTDz//PM4cuQI/vzzT/z666/WdSNGjICIICkpCVu3brVOEH/ttdeib9++Ptu5+DQRv/zyC0QEBw4csMZ4P1u4efNmDBs2DL1793bsfl7KuXPnICIYOXIkKlSogN27d19y/NGjR63zB65atQoiYr0qOnz48KDmcOTIkaDWCyX+jevBQugQFkIWQk0CKYSR+PiwEJIGzD0yrF27FiKCjh07olu3bhAR64tcevbsCRHBNddcg5deesl6BWzq1Kn497//bW3j4MGDGDRoEO644w4kJydj3759AIC6deti/PjxyMzMxMSJEyEiqFixIlauXIl+/fq56jQLderUQWpqKq6//nrMnj0bf//9d45jf/rpJ5/y6/0imhMnTgT0DaNux79xPVgIHXJhIYy0J7+5YSHUm/nFWAgjE5806MTcI0OPHj3Qtm1bVK5c2foymMmTJ2PcuHEQETz99NOoXr066tatix49euDUqVNYs2aNz9s9X3/9dYiI3zdstmrVCiKCDh06WMWpRYsWmD9/PuLi4vDmm286fXdzVbFiRYgIBgwYkOOYlStXWvfn7rvvzvUUG6bi37geLIQOYSFkIdSEhZCFkCIfc48M99xzj/WlKhcuVatWhYhg27Zt1mXHjh0DAOzbtw8igu3btwMARo4cme3J472vMFavXh0igjFjxqBDhw744IMP0KFDB0ycONHx+5sb7339z3/+k+OYadOm4d///rf1eEQq/o3rwULoEBZCFkJNWAhZCCnyMffIcP3112Pr1q1WEbryyiutf3/yySfIzMzM9vx8NWrUwOLFiwEA/fv3x8CBA/22/eqrr0JEUKxYMYgI5s6di549e2LkyJF45JFHMGfOHEfuYyB++eUXtGrVCi+//HKOY3r37o1evXo5OKvw4N+4HjkVwpMnT+KWW27BihUrMGbMGPTq1Qs9evRwxVujWQgNw0KoN/OLsRBGJj5p0Im5m69Tp04QEezfvx9z5szBgQMHcPjwYXz11VcYPHiw9Tm6o0ePYtKkST7rdu7cGddccw3S0tIQGxub7ds/3333XatMNmnSBKdPn8bAgQMxYMAA1K9fH2vXrnXkfgZq0KBBEBHrW0Qv5PF4ULFiRXz22WdhmJmz+DeuR06F8JVXXsHIkSOxdOlSdOnSBQAwbtw4rF+/3sHZZY+F0DAshHozvxgLYWTikwadmLv5vGUtIyMj17EX571w4UKICNavX48WLVpg7ty5fuvMmDHDug3v5+zefPNNdOzYERUqVMBvv/1mzx2xmffzkz///LPfdSdPnoSIICsrKwwzcxb/xvWIiopCQkICEhMTrctWrlyJ+fPn46OPPsKcOXOsbxZetmyZK17dZyE0DAuh3swvxkIYmfikQSfmbr569ephyJAheRqbXd4NGzbEihUrUKtWLWzatMnv+uTkZFxzzTU+l134DZ3p6elBzTvUMjIyULBgQWzYsMHvuqNHj6JYsWJhmJXz+DeuR3avEPbv3x9xcXG477778OCDD1qvEI4fPx7r1q1zeIb+WAgNw0KoN/OLsRBGJj5p0Im5u1NmZiZiY2Px9ddf5zo2KioKP/zwQ562m13ezZs3R5MmTVC0aFGcOnUqT9vJysrK9jOJbtO4cWO/L8kBzn+hTpkyZcIwI+fxb1yPS32pzEcffYQVK1bgrbfeQnx8POLi4vgZwmCxELIQasJCyEJIkY+5u4v3LZnvv/8+RARt27bFuXPnLrlO6dKl8ccff+Rp+9nlXbt2bYgIKlWqFNBc//zzT0ybNi2gdZwWHR2NyZMn+13+888/o3LlymGYkfP4N64Hv2XUISyELISasBCyEFLkY+7usWLFCogIZsyYgebNm6Nfv37Wq3CZmZk+Yz0eDxYvXoxTp04F9LbN7PK+/fbbrW8mjTS9evVC7969ERcXh19++cW6PD4+HkWLFg3jzJzDv3E9WAgdwkLIQqgJCyELIUU+5u4OR48e9TuHYHJyss/PF769a/PmzRARfPDBByhdunSebye7vO+55x6ICEqUKGHLfXGTIUOGWI/fwoULAcDnMdWAf+N6sBA6pGaZ8iyELIRqsBCyEFLkY+7uMH36dJ+i4j39Q58+fazL/u///s8aP3PmTIgIHnroIVStWjXPt5Nd3k2bNo3YguT9plHv+ROTkpJYCClisRA6hIXQ/kJoyhNuzZlfjIUwMvFJg07M3V4HDhwIeJ1Dhw5ZBaVIkSJ47rnnkJaW5jOmWbNmmD9/PgBg48aNPqUmkC9HyS7v//73vxH7CuHcuXMhIrjqqqvwwAMP+Dxu2Z1iIxLxb1wPFkKHsBCyEGoSiYUwkL9fk34/7cAnDToxd/ukpKRARDB9+nQAwKhRo3D55Zfju+++u+R627Zts0rKqFGjsh2TkJCAHj16WK8Y/utf/8KGDRswefJkv/J4KTnlPWvWLKxevTrP2zHF559/DhHBDTfcYD3GjzzyCK6++mq/z2VGKv6N68FC6BAWQhZCTVgIzfn9tAOfNOjE3O0zePBgq3QULlzY+nd8fHyO6+zduxdvvPEGatSoccltT5482Za3OmrL+4cffoCIWF+cIyJ49tlnwz0tR2nLXDMWQoewELIQasJCaM7vpx34pEEn5m6PjIwMn8JWp04diAg6dOiA7t2757hekSJFICJo2LDhJbe/adMmiAhmzZqV53MFZkdb3vv374eIWG8XHTRoEA4dOhTuaTlKW+aasRA6hIXQvifJLIShZcdjy0Jozu+nHfikQSfmbo8DBw6gVKlS6N+/v88reNOnT8djjz2W7TodOnSwCuRDDz10ye2fO3cOIhLUZxQvpC3v06dPW5+zFJF8lWlTactcMxZCh7AQ2l8InXo883sbpmXOQpg9FsKc8UmDTszdHt9//z1q1KiBAwcOYMqUKdbly5cvz/bVv++//x4igp49e0JEcNdddzkyT415x8TEoFKlSmq+VfRiGjPXioUwQLt370ZMTAyio6MBAPPnz0dMTAx69eqFHj16ICMjI9v1WAhZCE3BQpg9FsKc8UmDTszdHmPGjMF9993nd/mWLVuy/Xzgyy+/jN69ewMAEhMTsXPnzpDPEdCbd/ny5VkIKeKxEAYpOjoaKSkpiImJsS671LdOsRCyEJqChTB7LIQ545MGnZh7/v38888QETRv3tzvuotPLv/EE08gKysLd955p3WidCdpzfuyyy5jIaSIx0IYpOjoaGzevBljxowBcP5Er23atMGePXt8xiUmJiIhIQGVy16J+fPnW0tSUpKaZc2aNUhKSsKqEWOtJT/b827Dqcczv7fhlszz+tjbkZM387zMwS2PT15zzMtc7fpdN2XJKW8ukb0w98CWbdu2YdKkSVi7di2SkpKwdetWdO/eHddffz1WrVrlN9771tALl+rVqyMqKgrffPMN83Zoef311/HSSy+FfR7hWLRmrnFhIQxSdq8QDhkyJMe3bkTCK4TBzj0pKXyvENrxBTSR8gphXh8DvkKYPb5CmLOc8qbIxtzzzuPxoGLFihARVKpUCUeOHMHo0aMhIujVq1eO6y1duhQigoULF1ql8J13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" width="900">]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> backtrader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Numpy：数组的基本操作</title>
      <link href="/20211216/numpy-shu-zu-de-ji-ben-cao-zuo/"/>
      <url>/20211216/numpy-shu-zu-de-ji-ben-cao-zuo/</url>
      
        <content type="html"><![CDATA[<h2 id="数组的基本操作"><a href="#数组的基本操作" class="headerlink" title="数组的基本操作"></a>数组的基本操作</h2><p>数组生成后我们需要对数组进行一系列的操作，比如查看数组的特征，读取数组中某一个元素的值，数组切片、重组以及合并和拆分等，本Note总结这部分内容。</p><h3 id="读取数组的特征（attribute）"><a href="#读取数组的特征（attribute）" class="headerlink" title="读取数组的特征（attribute）"></a>读取数组的特征（attribute）</h3><p>数组的特征包含维度，每一维的元素个数，总的元素个数，数据类型，元素及数组占用的数据空间大小等。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token comment"># 生成一个均值为0，方差为1的正态分布随机数组成的3*4*5数组</span>x1 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 获取数组的维度，结果输出 3</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 dimention: "</span><span class="token punctuation">,</span> x1<span class="token punctuation">.</span>ndim<span class="token punctuation">)</span><span class="token comment"># x1 dimention:  3</span><span class="token comment"># 获取数组每一维度的元素个数，结果输出（3,4,5）</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 shape: "</span><span class="token punctuation">,</span> x1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment"># x1 shape:  (3, 4, 5)</span><span class="token comment"># 获取数组总的元素个数，结果输出 60</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 size: "</span><span class="token punctuation">,</span> x1<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token comment"># x1 size:  60</span><span class="token comment"># 获取数组的数据类型，结果输出 float64</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 data type: "</span><span class="token punctuation">,</span> x1<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span><span class="token comment"># x1 data type:  float64</span><span class="token comment"># 获取数组单个元素占用的数据空间大小（单位bytes），结果输出 8 bytes</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 item size: "</span><span class="token punctuation">,</span> x1<span class="token punctuation">.</span>itemsize<span class="token punctuation">)</span><span class="token comment"># x1 item size:  8</span><span class="token comment"># 获取数组总占用数据空间大小，结果输出 480 bytes</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 total size: "</span><span class="token punctuation">,</span> x1<span class="token punctuation">.</span>nbytes<span class="token punctuation">)</span><span class="token comment"># x1 total size:  480</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="数组索引（indexing）-读取-修改单个元素"><a href="#数组索引（indexing）-读取-修改单个元素" class="headerlink" title="数组索引（indexing）- 读取/修改单个元素"></a>数组索引（indexing）- 读取/修改单个元素</h3><p>NumPy的数组索引和Python List的索引类似，从0索引开始。以下以读取元素为例</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 生成一个含10个元素的一维随机数组</span>x2 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment"># array([0.91457994, 0.06262808, 0.36183464, 0.17594106, 0.33792884, 0.33788772, 0.91892014, 0.81608134, 0.08148799, 0.9756082 ])</span><span class="token comment"># 提取第5个元素，两种方法</span>x2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token comment"># 0.33792883685065367</span>x2<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token comment"># 0.33792883685065367</span><span class="token comment"># 生成一个含10个元素的二维随机数组</span>x3 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[0.09044767, 0.58838914, 0.68890439, 0.18176692, 0.22996167],</span><span class="token comment">#        [0.59272893, 0.11073436, 0.99616773, 0.99205917, 0.81407968]])</span><span class="token comment"># 提取第一维第4个元素</span>x3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment"># x3[0,-2], x3[-2,3], x3[-2,-2] 也可以提取同一元素</span><span class="token comment"># 0.181766923314293</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="数组切片（Slicing）"><a href="#数组切片（Slicing）" class="headerlink" title="数组切片（Slicing）"></a>数组切片（Slicing）</h3><p>NumPy数组切片也和Python List切片操作一致，x[start:stop:step]表示提取从索引start开始到索引stop截止步长为step的所有元素组成新的数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 生成一个从0到9总共10个元素的一维数组</span>x4 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment"># array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span><span class="token comment"># 提取前5个元素</span>x4<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token comment"># array([0, 1, 2, 3, 4])</span><span class="token comment"># 提取后5个元素</span>x4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># array([5, 6, 7, 8, 9])</span><span class="token comment"># 提取从索引3到索引6的元素</span>x4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token comment"># array([3, 4, 5])</span><span class="token comment"># 从数组第一个元素开始隔一个元素取一个（步长为2）</span>x4<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token comment"># array([0, 2, 4, 6, 8])</span><span class="token comment"># 从数组第二个元素开始各一个元素取一个</span>x4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token comment"># array([1, 3, 5, 7, 9])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>多维数组的切片操作与一维数组一致，只需要对每一个维度按照一维数组切片操作即可。</p><h3 id="数组重组（reshaping）"><a href="#数组重组（reshaping）" class="headerlink" title="数组重组（reshaping）"></a>数组重组（reshaping）</h3><p>比如将一个1x10的数组改成一个2x5的数组从而实现数组的重组。需要注意的是重组前后的数组大小是一样的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 生成一个从0到9总共10个元素的一维数组</span>x5 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment"># array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span><span class="token comment"># 重组成2x5的二维数组</span>x5<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment"># array([[0, 1, 2, 3, 4],</span><span class="token comment">#        [5, 6, 7, 8, 9]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="数组合并（Concatenation）"><a href="#数组合并（Concatenation）" class="headerlink" title="数组合并（Concatenation）"></a>数组合并（Concatenation）</h3><p>当合并的数组具有相同的维度时，可以使用concatenate()，可以同时合并2个或2个以上数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 生成两个一维数组</span>x6 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># array([1, 2, 3])</span>x7 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment"># array([4, 5, 6])</span><span class="token comment"># 合并这两个数组</span>np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>x6<span class="token punctuation">,</span>x7<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># array([1, 2, 3, 4, 5, 6])</span><span class="token comment"># 生成一个二维数组</span>x8 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3],</span><span class="token comment">#        [4, 5, 6]])</span><span class="token comment"># 合并二维数组 (默认以第一个axis为标准合并)</span>np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>x8<span class="token punctuation">,</span> x8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3],</span><span class="token comment">#        [4, 5, 6],</span><span class="token comment">#        [1, 2, 3],</span><span class="token comment">#        [4, 5, 6]])</span><span class="token comment"># 以第二个axis为标准合并二维数组</span>np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>x8<span class="token punctuation">,</span> x8<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3, 1, 2, 3],</span><span class="token comment">#        [4, 5, 6, 4, 5, 6]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>不同维度的数组合并时，可以使用vstack()或者hstack()，一个是垂直合并，一个是水平合并。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 生成一个二维数组</span>x9 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3],</span><span class="token comment">#        [4, 5, 6]])</span><span class="token comment"># 生成一个一维数组</span>x10 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># array([9, 9, 9])</span><span class="token comment"># 垂直合并这两个数组</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>x9<span class="token punctuation">,</span>x10<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3],</span><span class="token comment">#        [4, 5, 6],</span><span class="token comment">#        [9, 9, 9]])</span><span class="token comment"># 生成一个二维数组</span>x11 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># array([[9],</span><span class="token comment">#        [9]])</span><span class="token comment"># 水平合并X9和X11两个数组</span>np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>x9<span class="token punctuation">,</span>x11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3, 9],</span><span class="token comment">#        [4, 5, 6, 9]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Python包yfinance读取雅虎财经上的股票数据</title>
      <link href="/20211215/shi-yong-python-bao-yfinance-du-qu-ya-hu-cai-jing-shang-de-gu-piao-shu-ju/"/>
      <url>/20211215/shi-yong-python-bao-yfinance-du-qu-ya-hu-cai-jing-shang-de-gu-piao-shu-ju/</url>
      
        <content type="html"><![CDATA[<h2 id="使用Python包yfinance读取雅虎财经上的股票数据"><a href="#使用Python包yfinance读取雅虎财经上的股票数据" class="headerlink" title="使用Python包yfinance读取雅虎财经上的股票数据"></a>使用Python包yfinance读取雅虎财经上的股票数据</h2><h3 id="安装yfinance"><a href="#安装yfinance" class="headerlink" title="安装yfinance"></a>安装yfinance</h3><p><a href="https://github.com/ranaroussi/yfinance">yfinance</a>是一个使用简单但是功能强大的开源Python包，通过这个包我们可以获取在雅虎财经上列出来的包含历史数据的所有证券信息。除了通过GitHub上的源码安装外，建议使用传统的pip来安装。</p><pre><code>python3 -m pip install yfinance --upgrade --no-cache-dir</code></pre><h3 id="导入yfinance"><a href="#导入yfinance" class="headerlink" title="导入yfinance"></a>导入yfinance</h3><p>yfinance包有一个Ticker模块，可以通过该模块获取到相应证券的市场数据。以下抓取苹果公司（AAPL）的相关数据为例。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yfaapl <span class="token operator">=</span> yf<span class="token punctuation">.</span>Ticker<span class="token punctuation">(</span><span class="token string">'AAPL'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>aapl<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>yfinance.Ticker object &lt;AAPL&gt;</code></pre><h3 id="获取股票所对应信息-info"><a href="#获取股票所对应信息-info" class="headerlink" title="获取股票所对应信息 - info"></a>获取股票所对应信息 - info</h3><p>调用Ticker对象的info函数可以获取该股票的所有信息，返回一个dictionary结构数据，里面包含比如该公司所属sector，员工数，所在城市，和各种财务表现等。由于整个dictionary比较大，下面只选择打印了几个信息。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_info <span class="token operator">=</span> aapl<span class="token punctuation">.</span>info<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'AAPL sector: '</span><span class="token punctuation">,</span> aapl_info<span class="token punctuation">[</span><span class="token string">'sector'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'AAPL EBITA Margins: '</span><span class="token punctuation">,</span> aapl_info<span class="token punctuation">[</span><span class="token string">'ebitdaMargins'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'AAPL Profit Margins: '</span><span class="token punctuation">,</span> aapl_info<span class="token punctuation">[</span><span class="token string">'profitMargins'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'AAPL Gross Margins: '</span><span class="token punctuation">,</span> aapl_info<span class="token punctuation">[</span><span class="token string">'grossMargins'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'AAPL Day High: '</span><span class="token punctuation">,</span> aapl_info<span class="token punctuation">[</span><span class="token string">'dayHigh'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>AAPL sector:  TechnologyAAPL EBITA Margins:  0.32867AAPL Profit Margins:  0.25882AAPL Gross Margins:  0.41779AAPL Day High:  177.725</code></pre><h3 id="获取股票历史数据-history"><a href="#获取股票历史数据-history" class="headerlink" title="获取股票历史数据 - history"></a>获取股票历史数据 - history</h3><p>调用history函数可以获取到该股票的历史数据。该函数有以下几个参数可供配置。</p><ul><li>period，表示获取多久的数据，有10种选择：1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max。</li><li>interval，表示数据的精度，有13种选择：1m, 2m, 5m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo。天以内的数据只能最多采集60天以内的，精度越高，能采集的数据天数更少，比如1m数据只能采集7天以内的。</li><li>start，如果没有配置period，也可以使用start即数据开始时间和end即数据结束时间来定义应该获取多久的数据</li><li>end，同上</li><li>prepost，是否包含盘前和盘后价格，默认False不包含</li><li>auto_adjust，是否按照美国线（英语：Open-High-Low-Close chart，OHLC chart）来调整，含开盘价、最高价、最低价、收盘价，默认True</li><li>actions，是否包含分红和扩股信息，默认包含</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 获取AAPL所有的历史数据，并打印最开始5天的记录</span>aapl_history_max <span class="token operator">=</span> aapl<span class="token punctuation">.</span>history<span class="token punctuation">(</span>period<span class="token operator">=</span><span class="token string">'max'</span><span class="token punctuation">)</span>aapl_history_max<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>      <th>Dividends</th>      <th>Stock Splits</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>1980-12-12</th>      <td>0.100453</td>      <td>0.100890</td>      <td>0.100453</td>      <td>0.100453</td>      <td>469033600</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>1980-12-15</th>      <td>0.095649</td>      <td>0.095649</td>      <td>0.095213</td>      <td>0.095213</td>      <td>175884800</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>1980-12-16</th>      <td>0.088661</td>      <td>0.088661</td>      <td>0.088224</td>      <td>0.088224</td>      <td>105728000</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>1980-12-17</th>      <td>0.090408</td>      <td>0.090845</td>      <td>0.090408</td>      <td>0.090408</td>      <td>86441600</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>1980-12-18</th>      <td>0.093029</td>      <td>0.093466</td>      <td>0.093029</td>      <td>0.093029</td>      <td>73449600</td>      <td>0.0</td>      <td>0.0</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 获取AAPL从2021年12月1日到2021年12月15日精度为2分钟的历史数据，并打印最开始的5条记录。</span>aapl_history_1m <span class="token operator">=</span> aapl<span class="token punctuation">.</span>history<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">"2021-12-01"</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">"2021-12-15"</span><span class="token punctuation">,</span> interval<span class="token operator">=</span><span class="token string">"2m"</span><span class="token punctuation">)</span>aapl_history_1m<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Open</th>      <th>High</th>      <th>Low</th>      <th>Close</th>      <th>Volume</th>      <th>Dividends</th>      <th>Stock Splits</th>    </tr>    <tr>      <th>Datetime</th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2021-12-01 09:30:00-05:00</th>      <td>166.839996</td>      <td>167.095901</td>      <td>166.559998</td>      <td>166.845001</td>      <td>7578140</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2021-12-01 09:32:00-05:00</th>      <td>166.845001</td>      <td>166.990005</td>      <td>166.429993</td>      <td>166.429993</td>      <td>1212147</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2021-12-01 09:34:00-05:00</th>      <td>166.242203</td>      <td>166.500000</td>      <td>166.139999</td>      <td>166.259995</td>      <td>1304022</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2021-12-01 09:36:00-05:00</th>      <td>166.250000</td>      <td>166.800003</td>      <td>166.089996</td>      <td>166.468796</td>      <td>1390514</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2021-12-01 09:38:00-05:00</th>      <td>167.000000</td>      <td>167.419907</td>      <td>167.000000</td>      <td>167.399994</td>      <td>1572092</td>      <td>0</td>      <td>0</td>    </tr>  </tbody></table></div><h3 id="获取股票的分红和扩股数据-actions"><a href="#获取股票的分红和扩股数据-actions" class="headerlink" title="获取股票的分红和扩股数据 - actions"></a>获取股票的分红和扩股数据 - actions</h3><p>其实在获取历史数据的时候我们就可以直接获取到股票的分红和扩股数据，但是并不是每一条历史数据上都有分红或者扩股，使用actions函数可以直接获取到该信息。结合上面的历史数据信息我们可以看到AAPL在1980年发行以后到1987年5月11日才开始第一次分红，同年的6月16日开始第一次扩股。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_actions <span class="token operator">=</span> aapl<span class="token punctuation">.</span>actionsaapl_actions<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Dividends</th>      <th>Stock Splits</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>1987-05-11</th>      <td>0.000536</td>      <td>0.0</td>    </tr>    <tr>      <th>1987-06-16</th>      <td>0.000000</td>      <td>2.0</td>    </tr>    <tr>      <th>1987-08-10</th>      <td>0.000536</td>      <td>0.0</td>    </tr>    <tr>      <th>1987-11-17</th>      <td>0.000714</td>      <td>0.0</td>    </tr>    <tr>      <th>1988-02-12</th>      <td>0.000714</td>      <td>0.0</td>    </tr>  </tbody></table></div><h4 id="获取股票的分红数据-dividends"><a href="#获取股票的分红数据-dividends" class="headerlink" title="获取股票的分红数据 - dividends"></a>获取股票的分红数据 - dividends</h4><p>actions函数的返回结果同时记录了分红和扩股信息，如果只想看分红信息，可以直接使用dividends。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_dividends <span class="token operator">=</span> aapl<span class="token punctuation">.</span>dividendsaapl_dividends<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>Date1987-05-11    0.0005361987-08-10    0.0005361987-11-17    0.0007141988-02-12    0.0007141988-05-16    0.000714Name: Dividends, dtype: float64</code></pre><h4 id="获取股票的分红数据-splits"><a href="#获取股票的分红数据-splits" class="headerlink" title="获取股票的分红数据 - splits"></a>获取股票的分红数据 - splits</h4><p>actions函数的返回结果同时记录了分红和扩股信息，如果只想看扩股信息，可以直接使用splits。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_splits <span class="token operator">=</span> aapl<span class="token punctuation">.</span>splitsaapl_splits<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>Date1987-06-16    2.02000-06-21    2.02005-02-28    2.02014-06-09    7.02020-08-31    4.0Name: Stock Splits, dtype: float64</code></pre><h3 id="获取重要持股人信息-major-holders"><a href="#获取重要持股人信息-major-holders" class="headerlink" title="获取重要持股人信息 - major_holders"></a>获取重要持股人信息 - major_holders</h3><p>可以看到AAPL主要由机构持股。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_major_holders <span class="token operator">=</span> aapl<span class="token punctuation">.</span>major_holdersaapl_major_holders<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>      <th>1</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0.07%</td>      <td>% of Shares Held by All Insider</td>    </tr>    <tr>      <th>1</th>      <td>58.81%</td>      <td>% of Shares Held by Institutions</td>    </tr>    <tr>      <th>2</th>      <td>58.86%</td>      <td>% of Float Held by Institutions</td>    </tr>    <tr>      <th>3</th>      <td>4959</td>      <td>Number of Institutions Holding Shares</td>    </tr>  </tbody></table></div><h4 id="获取重要机构持股人信息-institutional-holders"><a href="#获取重要机构持股人信息-institutional-holders" class="headerlink" title="获取重要机构持股人信息 - institutional_holders"></a>获取重要机构持股人信息 - institutional_holders</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_institutional_holders <span class="token operator">=</span> aapl<span class="token punctuation">.</span>institutional_holdersaapl_institutional_holders<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Holder</th>      <th>Shares</th>      <th>Date Reported</th>      <th>% Out</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>Vanguard Group, Inc. (The)</td>      <td>1266332667</td>      <td>2021-09-29</td>      <td>0.0772</td>      <td>179186072380</td>    </tr>    <tr>      <th>1</th>      <td>Blackrock Inc.</td>      <td>1026223983</td>      <td>2021-09-29</td>      <td>0.0626</td>      <td>145210693594</td>    </tr>    <tr>      <th>2</th>      <td>Berkshire Hathaway, Inc</td>      <td>887135554</td>      <td>2021-09-29</td>      <td>0.0541</td>      <td>125529680891</td>    </tr>    <tr>      <th>3</th>      <td>State Street Corporation</td>      <td>622163541</td>      <td>2021-09-29</td>      <td>0.0379</td>      <td>88036141051</td>    </tr>    <tr>      <th>4</th>      <td>FMR, LLC</td>      <td>350617759</td>      <td>2021-09-29</td>      <td>0.0214</td>      <td>49612412898</td>    </tr>  </tbody></table></div><h4 id="获取共同基金持股人信息-mutualfund-holders"><a href="#获取共同基金持股人信息-mutualfund-holders" class="headerlink" title="获取共同基金持股人信息 - mutualfund_holders"></a>获取共同基金持股人信息 - mutualfund_holders</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_mutualfund_holders <span class="token operator">=</span> aapl<span class="token punctuation">.</span>mutualfund_holdersaapl_mutualfund_holders<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Holder</th>      <th>Shares</th>      <th>Date Reported</th>      <th>% Out</th>      <th>Value</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>Vanguard Total Stock Market Index Fund</td>      <td>443797660</td>      <td>2021-09-29</td>      <td>0.0271</td>      <td>62797368890</td>    </tr>    <tr>      <th>1</th>      <td>Vanguard 500 Index Fund</td>      <td>329777051</td>      <td>2021-09-29</td>      <td>0.0201</td>      <td>46663452716</td>    </tr>    <tr>      <th>2</th>      <td>SPDR S&amp;P 500 ETF Trust</td>      <td>166047529</td>      <td>2021-09-29</td>      <td>0.0101</td>      <td>23495725353</td>    </tr>    <tr>      <th>3</th>      <td>Fidelity 500 Index Fund</td>      <td>152173622</td>      <td>2021-10-30</td>      <td>0.0093</td>      <td>22795608575</td>    </tr>    <tr>      <th>4</th>      <td>Invesco ETF Tr-Invesco QQQ Tr, Series 1 ETF</td>      <td>145254426</td>      <td>2021-10-30</td>      <td>0.0089</td>      <td>21759113014</td>    </tr>  </tbody></table></div><h3 id="获取详细财务信息"><a href="#获取详细财务信息" class="headerlink" title="获取详细财务信息"></a>获取详细财务信息</h3><h4 id="当季财年信息-calendar"><a href="#当季财年信息-calendar" class="headerlink" title="当季财年信息 - calendar"></a>当季财年信息 - calendar</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_calendar <span class="token operator">=</span> aapl<span class="token punctuation">.</span>calendaraapl_calendar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>      <th>1</th>    </tr>  </thead>  <tbody>    <tr>      <th>Earnings Date</th>      <td>2022-01-25 21:00:00</td>      <td>2022-01-31 21:00:00</td>    </tr>    <tr>      <th>Earnings Average</th>      <td>1.88</td>      <td>1.88</td>    </tr>    <tr>      <th>Earnings Low</th>      <td>1.75</td>      <td>1.75</td>    </tr>    <tr>      <th>Earnings High</th>      <td>1.97</td>      <td>1.97</td>    </tr>    <tr>      <th>Revenue Average</th>      <td>118137000000</td>      <td>118137000000</td>    </tr>    <tr>      <th>Revenue Low</th>      <td>111806000000</td>      <td>111806000000</td>    </tr>    <tr>      <th>Revenue High</th>      <td>121303000000</td>      <td>121303000000</td>    </tr>  </tbody></table></div><h4 id="年度营业收入和税后收益-earnings"><a href="#年度营业收入和税后收益-earnings" class="headerlink" title="年度营业收入和税后收益 - earnings"></a>年度营业收入和税后收益 - earnings</h4><p>只显示最近四次财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_earnings <span class="token operator">=</span> aapl<span class="token punctuation">.</span>earningsaapl_earnings<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Revenue</th>      <th>Earnings</th>    </tr>    <tr>      <th>Year</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2018</th>      <td>265595000000</td>      <td>59531000000</td>    </tr>    <tr>      <th>2019</th>      <td>260174000000</td>      <td>55256000000</td>    </tr>    <tr>      <th>2020</th>      <td>274515000000</td>      <td>57411000000</td>    </tr>    <tr>      <th>2021</th>      <td>365817000000</td>      <td>94680000000</td>    </tr>  </tbody></table></div><h4 id="季度营业收入和税后收益-quarterly-earnings"><a href="#季度营业收入和税后收益-quarterly-earnings" class="headerlink" title="季度营业收入和税后收益 - quarterly_earnings"></a>季度营业收入和税后收益 - quarterly_earnings</h4><p>只显示最近四次财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_quarterly_earnings <span class="token operator">=</span> aapl<span class="token punctuation">.</span>quarterly_earningsaapl_quarterly_earnings<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Revenue</th>      <th>Earnings</th>    </tr>    <tr>      <th>Quarter</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>4Q2020</th>      <td>111439000000</td>      <td>28755000000</td>    </tr>    <tr>      <th>1Q2021</th>      <td>89584000000</td>      <td>23630000000</td>    </tr>    <tr>      <th>2Q2021</th>      <td>81434000000</td>      <td>21744000000</td>    </tr>    <tr>      <th>3Q2021</th>      <td>83360000000</td>      <td>20551000000</td>    </tr>  </tbody></table></div><h4 id="年度详细财报-financials"><a href="#年度详细财报-financials" class="headerlink" title="年度详细财报 - financials"></a>年度详细财报 - financials</h4><p>只显示最近四个财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_financials <span class="token operator">=</span> aapl<span class="token punctuation">.</span>financialsaapl_financials<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2021-09-25</th>      <th>2020-09-26</th>      <th>2019-09-28</th>      <th>2018-09-29</th>    </tr>  </thead>  <tbody>    <tr>      <th>Research Development</th>      <td>21914000000.0</td>      <td>18752000000.0</td>      <td>16217000000.0</td>      <td>14236000000.0</td>    </tr>    <tr>      <th>Effect Of Accounting Charges</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Income Before Tax</th>      <td>109207000000.0</td>      <td>67091000000.0</td>      <td>65737000000.0</td>      <td>72903000000.0</td>    </tr>    <tr>      <th>Minority Interest</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Net Income</th>      <td>94680000000.0</td>      <td>57411000000.0</td>      <td>55256000000.0</td>      <td>59531000000.0</td>    </tr>    <tr>      <th>Selling General Administrative</th>      <td>21973000000.0</td>      <td>19916000000.0</td>      <td>18245000000.0</td>      <td>16705000000.0</td>    </tr>    <tr>      <th>Gross Profit</th>      <td>152836000000.0</td>      <td>104956000000.0</td>      <td>98392000000.0</td>      <td>101839000000.0</td>    </tr>    <tr>      <th>Ebit</th>      <td>108949000000.0</td>      <td>66288000000.0</td>      <td>63930000000.0</td>      <td>70898000000.0</td>    </tr>    <tr>      <th>Operating Income</th>      <td>108949000000.0</td>      <td>66288000000.0</td>      <td>63930000000.0</td>      <td>70898000000.0</td>    </tr>    <tr>      <th>Other Operating Expenses</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Interest Expense</th>      <td>-2645000000.0</td>      <td>-2873000000.0</td>      <td>-3576000000.0</td>      <td>-3240000000.0</td>    </tr>    <tr>      <th>Extraordinary Items</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Non Recurring</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Other Items</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Income Tax Expense</th>      <td>14527000000.0</td>      <td>9680000000.0</td>      <td>10481000000.0</td>      <td>13372000000.0</td>    </tr>    <tr>      <th>Total Revenue</th>      <td>365817000000.0</td>      <td>274515000000.0</td>      <td>260174000000.0</td>      <td>265595000000.0</td>    </tr>    <tr>      <th>Total Operating Expenses</th>      <td>256868000000.0</td>      <td>208227000000.0</td>      <td>196244000000.0</td>      <td>194697000000.0</td>    </tr>    <tr>      <th>Cost Of Revenue</th>      <td>212981000000.0</td>      <td>169559000000.0</td>      <td>161782000000.0</td>      <td>163756000000.0</td>    </tr>    <tr>      <th>Total Other Income Expense Net</th>      <td>258000000.0</td>      <td>803000000.0</td>      <td>1807000000.0</td>      <td>2005000000.0</td>    </tr>    <tr>      <th>Discontinued Operations</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Net Income From Continuing Ops</th>      <td>94680000000.0</td>      <td>57411000000.0</td>      <td>55256000000.0</td>      <td>59531000000.0</td>    </tr>    <tr>      <th>Net Income Applicable To Common Shares</th>      <td>94680000000.0</td>      <td>57411000000.0</td>      <td>55256000000.0</td>      <td>59531000000.0</td>    </tr>  </tbody></table></div><h4 id="季度详细财报-quarterly-financials"><a href="#季度详细财报-quarterly-financials" class="headerlink" title="季度详细财报 - quarterly_financials"></a>季度详细财报 - quarterly_financials</h4><p>只显示最近四个财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_quarterly_financials <span class="token operator">=</span> aapl<span class="token punctuation">.</span>quarterly_financialsaapl_quarterly_financials<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2021-09-25</th>      <th>2021-06-26</th>      <th>2021-03-27</th>      <th>2020-12-26</th>    </tr>  </thead>  <tbody>    <tr>      <th>Research Development</th>      <td>5772000000.0</td>      <td>5717000000.0</td>      <td>5262000000.0</td>      <td>5163000000.0</td>    </tr>    <tr>      <th>Effect Of Accounting Charges</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Income Before Tax</th>      <td>23248000000.0</td>      <td>24369000000.0</td>      <td>28011000000.0</td>      <td>33579000000.0</td>    </tr>    <tr>      <th>Minority Interest</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Net Income</th>      <td>20551000000.0</td>      <td>21744000000.0</td>      <td>23630000000.0</td>      <td>28755000000.0</td>    </tr>    <tr>      <th>Selling General Administrative</th>      <td>5616000000.0</td>      <td>5412000000.0</td>      <td>5314000000.0</td>      <td>5631000000.0</td>    </tr>    <tr>      <th>Gross Profit</th>      <td>35174000000.0</td>      <td>35255000000.0</td>      <td>38079000000.0</td>      <td>44328000000.0</td>    </tr>    <tr>      <th>Ebit</th>      <td>23786000000.0</td>      <td>24126000000.0</td>      <td>27503000000.0</td>      <td>33534000000.0</td>    </tr>    <tr>      <th>Operating Income</th>      <td>23786000000.0</td>      <td>24126000000.0</td>      <td>27503000000.0</td>      <td>33534000000.0</td>    </tr>    <tr>      <th>Other Operating Expenses</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Interest Expense</th>      <td>-672000000.0</td>      <td>-665000000.0</td>      <td>-670000000.0</td>      <td>-638000000.0</td>    </tr>    <tr>      <th>Extraordinary Items</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Non Recurring</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Other Items</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Income Tax Expense</th>      <td>2697000000.0</td>      <td>2625000000.0</td>      <td>4381000000.0</td>      <td>4824000000.0</td>    </tr>    <tr>      <th>Total Revenue</th>      <td>83360000000.0</td>      <td>81434000000.0</td>      <td>89584000000.0</td>      <td>111439000000.0</td>    </tr>    <tr>      <th>Total Operating Expenses</th>      <td>59574000000.0</td>      <td>57308000000.0</td>      <td>62081000000.0</td>      <td>77905000000.0</td>    </tr>    <tr>      <th>Cost Of Revenue</th>      <td>48186000000.0</td>      <td>46179000000.0</td>      <td>51505000000.0</td>      <td>67111000000.0</td>    </tr>    <tr>      <th>Total Other Income Expense Net</th>      <td>-538000000.0</td>      <td>243000000.0</td>      <td>508000000.0</td>      <td>45000000.0</td>    </tr>    <tr>      <th>Discontinued Operations</th>      <td>None</td>      <td>None</td>      <td>None</td>      <td>None</td>    </tr>    <tr>      <th>Net Income From Continuing Ops</th>      <td>20551000000.0</td>      <td>21744000000.0</td>      <td>23630000000.0</td>      <td>28755000000.0</td>    </tr>    <tr>      <th>Net Income Applicable To Common Shares</th>      <td>20551000000.0</td>      <td>21744000000.0</td>      <td>23630000000.0</td>      <td>28755000000.0</td>    </tr>  </tbody></table></div><h4 id="年度资产负债表-balance-sheet"><a href="#年度资产负债表-balance-sheet" class="headerlink" title="年度资产负债表 - balance_sheet"></a>年度资产负债表 - balance_sheet</h4><p>只显示最近四个财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_balance_sheet <span class="token operator">=</span> aapl<span class="token punctuation">.</span>balance_sheetaapl_balance_sheet<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2021-09-25</th>      <th>2020-09-26</th>      <th>2019-09-28</th>      <th>2018-09-29</th>    </tr>  </thead>  <tbody>    <tr>      <th>Total Liab</th>      <td>2.879120e+11</td>      <td>2.585490e+11</td>      <td>2.480280e+11</td>      <td>2.585780e+11</td>    </tr>    <tr>      <th>Total Stockholder Equity</th>      <td>6.309000e+10</td>      <td>6.533900e+10</td>      <td>9.048800e+10</td>      <td>1.071470e+11</td>    </tr>    <tr>      <th>Other Current Liab</th>      <td>5.357700e+10</td>      <td>4.786700e+10</td>      <td>4.324200e+10</td>      <td>3.929300e+10</td>    </tr>    <tr>      <th>Total Assets</th>      <td>3.510020e+11</td>      <td>3.238880e+11</td>      <td>3.385160e+11</td>      <td>3.657250e+11</td>    </tr>    <tr>      <th>Common Stock</th>      <td>5.736500e+10</td>      <td>5.077900e+10</td>      <td>4.517400e+10</td>      <td>4.020100e+10</td>    </tr>    <tr>      <th>Other Current Assets</th>      <td>1.411100e+10</td>      <td>1.126400e+10</td>      <td>1.235200e+10</td>      <td>1.208700e+10</td>    </tr>    <tr>      <th>Retained Earnings</th>      <td>5.562000e+09</td>      <td>1.496600e+10</td>      <td>4.589800e+10</td>      <td>7.040000e+10</td>    </tr>    <tr>      <th>Other Liab</th>      <td>4.305000e+10</td>      <td>4.610800e+10</td>      <td>5.050300e+10</td>      <td>4.891400e+10</td>    </tr>    <tr>      <th>Treasury Stock</th>      <td>1.630000e+08</td>      <td>-4.060000e+08</td>      <td>-5.840000e+08</td>      <td>-3.454000e+09</td>    </tr>    <tr>      <th>Other Assets</th>      <td>3.876200e+10</td>      <td>3.395200e+10</td>      <td>3.297800e+10</td>      <td>2.228300e+10</td>    </tr>    <tr>      <th>Cash</th>      <td>3.494000e+10</td>      <td>3.801600e+10</td>      <td>4.884400e+10</td>      <td>2.591300e+10</td>    </tr>    <tr>      <th>Total Current Liabilities</th>      <td>1.254810e+11</td>      <td>1.053920e+11</td>      <td>1.057180e+11</td>      <td>1.159290e+11</td>    </tr>    <tr>      <th>Short Long Term Debt</th>      <td>9.613000e+09</td>      <td>8.773000e+09</td>      <td>1.026000e+10</td>      <td>8.784000e+09</td>    </tr>    <tr>      <th>Other Stockholder Equity</th>      <td>1.630000e+08</td>      <td>-4.060000e+08</td>      <td>-5.840000e+08</td>      <td>-3.454000e+09</td>    </tr>    <tr>      <th>Property Plant Equipment</th>      <td>4.952700e+10</td>      <td>4.533600e+10</td>      <td>3.737800e+10</td>      <td>4.130400e+10</td>    </tr>    <tr>      <th>Total Current Assets</th>      <td>1.348360e+11</td>      <td>1.437130e+11</td>      <td>1.628190e+11</td>      <td>1.313390e+11</td>    </tr>    <tr>      <th>Long Term Investments</th>      <td>1.278770e+11</td>      <td>1.008870e+11</td>      <td>1.053410e+11</td>      <td>1.707990e+11</td>    </tr>    <tr>      <th>Net Tangible Assets</th>      <td>6.309000e+10</td>      <td>6.533900e+10</td>      <td>9.048800e+10</td>      <td>1.071470e+11</td>    </tr>    <tr>      <th>Short Term Investments</th>      <td>2.769900e+10</td>      <td>5.292700e+10</td>      <td>5.171300e+10</td>      <td>4.038800e+10</td>    </tr>    <tr>      <th>Net Receivables</th>      <td>5.150600e+10</td>      <td>3.744500e+10</td>      <td>4.580400e+10</td>      <td>4.899500e+10</td>    </tr>    <tr>      <th>Long Term Debt</th>      <td>1.091060e+11</td>      <td>9.866700e+10</td>      <td>9.180700e+10</td>      <td>9.373500e+10</td>    </tr>    <tr>      <th>Inventory</th>      <td>6.580000e+09</td>      <td>4.061000e+09</td>      <td>4.106000e+09</td>      <td>3.956000e+09</td>    </tr>    <tr>      <th>Accounts Payable</th>      <td>5.476300e+10</td>      <td>4.229600e+10</td>      <td>4.623600e+10</td>      <td>5.588800e+10</td>    </tr>  </tbody></table></div><h4 id="季度资产负债表-quarterly-balance-sheet"><a href="#季度资产负债表-quarterly-balance-sheet" class="headerlink" title="季度资产负债表 - quarterly_balance_sheet"></a>季度资产负债表 - quarterly_balance_sheet</h4><p>只显示最近四个财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_quarterly_balance_sheet <span class="token operator">=</span> aapl<span class="token punctuation">.</span>quarterly_balance_sheetaapl_quarterly_balance_sheet<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2021-09-25</th>      <th>2021-06-26</th>      <th>2021-03-27</th>      <th>2020-12-26</th>    </tr>  </thead>  <tbody>    <tr>      <th>Total Liab</th>      <td>2.879120e+11</td>      <td>2.655600e+11</td>      <td>2.679800e+11</td>      <td>2.878300e+11</td>    </tr>    <tr>      <th>Total Stockholder Equity</th>      <td>6.309000e+10</td>      <td>6.428000e+10</td>      <td>6.917800e+10</td>      <td>6.622400e+10</td>    </tr>    <tr>      <th>Other Current Liab</th>      <td>5.357700e+10</td>      <td>5.130600e+10</td>      <td>5.325500e+10</td>      <td>5.589900e+10</td>    </tr>    <tr>      <th>Total Assets</th>      <td>3.510020e+11</td>      <td>3.298400e+11</td>      <td>3.371580e+11</td>      <td>3.540540e+11</td>    </tr>    <tr>      <th>Common Stock</th>      <td>5.736500e+10</td>      <td>5.498900e+10</td>      <td>5.420300e+10</td>      <td>5.174400e+10</td>    </tr>    <tr>      <th>Other Current Assets</th>      <td>1.411100e+10</td>      <td>1.364100e+10</td>      <td>1.337600e+10</td>      <td>1.368700e+10</td>    </tr>    <tr>      <th>Retained Earnings</th>      <td>5.562000e+09</td>      <td>9.233000e+09</td>      <td>1.526100e+10</td>      <td>1.430100e+10</td>    </tr>    <tr>      <th>Other Liab</th>      <td>4.305000e+10</td>      <td>3.835400e+10</td>      <td>3.985300e+10</td>      <td>4.304200e+10</td>    </tr>    <tr>      <th>Treasury Stock</th>      <td>1.630000e+08</td>      <td>5.800000e+07</td>      <td>-2.860000e+08</td>      <td>1.790000e+08</td>    </tr>    <tr>      <th>Other Assets</th>      <td>3.876200e+10</td>      <td>4.485400e+10</td>      <td>4.333900e+10</td>      <td>4.327000e+10</td>    </tr>    <tr>      <th>Cash</th>      <td>3.494000e+10</td>      <td>3.405000e+10</td>      <td>3.846600e+10</td>      <td>3.601000e+10</td>    </tr>    <tr>      <th>Total Current Liabilities</th>      <td>1.254810e+11</td>      <td>1.077540e+11</td>      <td>1.063850e+11</td>      <td>1.325070e+11</td>    </tr>    <tr>      <th>Short Long Term Debt</th>      <td>9.613000e+09</td>      <td>8.039000e+09</td>      <td>8.003000e+09</td>      <td>7.762000e+09</td>    </tr>    <tr>      <th>Other Stockholder Equity</th>      <td>1.630000e+08</td>      <td>5.800000e+07</td>      <td>-2.860000e+08</td>      <td>1.790000e+08</td>    </tr>    <tr>      <th>Property Plant Equipment</th>      <td>4.952700e+10</td>      <td>3.861500e+10</td>      <td>3.781500e+10</td>      <td>3.793300e+10</td>    </tr>    <tr>      <th>Total Current Assets</th>      <td>1.348360e+11</td>      <td>1.144230e+11</td>      <td>1.214650e+11</td>      <td>1.541060e+11</td>    </tr>    <tr>      <th>Long Term Investments</th>      <td>1.278770e+11</td>      <td>1.319480e+11</td>      <td>1.345390e+11</td>      <td>1.187450e+11</td>    </tr>    <tr>      <th>Net Tangible Assets</th>      <td>6.309000e+10</td>      <td>6.428000e+10</td>      <td>6.917800e+10</td>      <td>6.622400e+10</td>    </tr>    <tr>      <th>Short Term Investments</th>      <td>2.769900e+10</td>      <td>2.764600e+10</td>      <td>3.136800e+10</td>      <td>4.081600e+10</td>    </tr>    <tr>      <th>Net Receivables</th>      <td>5.150600e+10</td>      <td>3.390800e+10</td>      <td>3.303600e+10</td>      <td>5.862000e+10</td>    </tr>    <tr>      <th>Long Term Debt</th>      <td>1.091060e+11</td>      <td>1.057520e+11</td>      <td>1.086420e+11</td>      <td>9.928100e+10</td>    </tr>    <tr>      <th>Inventory</th>      <td>6.580000e+09</td>      <td>5.178000e+09</td>      <td>5.219000e+09</td>      <td>4.973000e+09</td>    </tr>    <tr>      <th>Accounts Payable</th>      <td>5.476300e+10</td>      <td>4.040900e+10</td>      <td>4.012700e+10</td>      <td>6.384600e+10</td>    </tr>  </tbody></table></div><h4 id="年度现金流-cashflow"><a href="#年度现金流-cashflow" class="headerlink" title="年度现金流 - cashflow"></a>年度现金流 - cashflow</h4><p>只显示最近四个财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_cashflow <span class="token operator">=</span> aapl<span class="token punctuation">.</span>cashflowaapl_cashflow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2021-09-25</th>      <th>2020-09-26</th>      <th>2019-09-28</th>      <th>2018-09-29</th>    </tr>  </thead>  <tbody>    <tr>      <th>Investments</th>      <td>-2.819000e+09</td>      <td>5.335000e+09</td>      <td>5.809300e+10</td>      <td>3.084500e+10</td>    </tr>    <tr>      <th>Change To Liabilities</th>      <td>1.400200e+10</td>      <td>-1.981000e+09</td>      <td>-2.548000e+09</td>      <td>9.172000e+09</td>    </tr>    <tr>      <th>Total Cashflows From Investing Activities</th>      <td>-1.454500e+10</td>      <td>-4.289000e+09</td>      <td>4.589600e+10</td>      <td>1.606600e+10</td>    </tr>    <tr>      <th>Net Borrowings</th>      <td>1.266500e+10</td>      <td>2.499000e+09</td>      <td>-7.819000e+09</td>      <td>4.320000e+08</td>    </tr>    <tr>      <th>Total Cash From Financing Activities</th>      <td>-9.335300e+10</td>      <td>-8.682000e+10</td>      <td>-9.097600e+10</td>      <td>-8.787600e+10</td>    </tr>    <tr>      <th>Change To Operating Activities</th>      <td>-6.146000e+09</td>      <td>8.810000e+08</td>      <td>-8.960000e+08</td>      <td>3.001600e+10</td>    </tr>    <tr>      <th>Issuance Of Stock</th>      <td>1.105000e+09</td>      <td>8.800000e+08</td>      <td>7.810000e+08</td>      <td>6.690000e+08</td>    </tr>    <tr>      <th>Net Income</th>      <td>9.468000e+10</td>      <td>5.741100e+10</td>      <td>5.525600e+10</td>      <td>5.953100e+10</td>    </tr>    <tr>      <th>Change In Cash</th>      <td>-3.860000e+09</td>      <td>-1.043500e+10</td>      <td>2.431100e+10</td>      <td>5.624000e+09</td>    </tr>    <tr>      <th>Repurchase Of Stock</th>      <td>-9.252700e+10</td>      <td>-7.599200e+10</td>      <td>-6.971400e+10</td>      <td>-7.526500e+10</td>    </tr>    <tr>      <th>Total Cash From Operating Activities</th>      <td>1.040380e+11</td>      <td>8.067400e+10</td>      <td>6.939100e+10</td>      <td>7.743400e+10</td>    </tr>    <tr>      <th>Depreciation</th>      <td>1.128400e+10</td>      <td>1.105600e+10</td>      <td>1.254700e+10</td>      <td>1.090300e+10</td>    </tr>    <tr>      <th>Other Cashflows From Investing Activities</th>      <td>-6.080000e+08</td>      <td>-7.910000e+08</td>      <td>-1.078000e+09</td>      <td>-7.450000e+08</td>    </tr>    <tr>      <th>Dividends Paid</th>      <td>-1.446700e+10</td>      <td>-1.408100e+10</td>      <td>-1.411900e+10</td>      <td>-1.371200e+10</td>    </tr>    <tr>      <th>Change To Inventory</th>      <td>-2.642000e+09</td>      <td>-1.270000e+08</td>      <td>-2.890000e+08</td>      <td>8.280000e+08</td>    </tr>    <tr>      <th>Change To Account Receivables</th>      <td>-1.012500e+10</td>      <td>6.917000e+09</td>      <td>2.450000e+08</td>      <td>-5.322000e+09</td>    </tr>    <tr>      <th>Other Cashflows From Financing Activities</th>      <td>-1.290000e+08</td>      <td>-1.260000e+08</td>      <td>-1.050000e+08</td>      <td>-1.050000e+08</td>    </tr>    <tr>      <th>Change To Netincome</th>      <td>2.985000e+09</td>      <td>6.517000e+09</td>      <td>5.076000e+09</td>      <td>-2.769400e+10</td>    </tr>    <tr>      <th>Capital Expenditures</th>      <td>-1.108500e+10</td>      <td>-7.309000e+09</td>      <td>-1.049500e+10</td>      <td>-1.331300e+10</td>    </tr>  </tbody></table></div><h4 id="季度现金流-quarterly-cashflow"><a href="#季度现金流-quarterly-cashflow" class="headerlink" title="季度现金流 - quarterly_cashflow"></a>季度现金流 - quarterly_cashflow</h4><p>只显示最近四个财务统计期</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_quarterly_cashflow <span class="token operator">=</span> aapl<span class="token punctuation">.</span>quarterly_cashflowaapl_quarterly_cashflow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2021-09-25</th>      <th>2021-06-26</th>      <th>2021-03-27</th>      <th>2020-12-26</th>    </tr>  </thead>  <tbody>    <tr>      <th>Investments</th>      <td>4.608000e+09</td>      <td>5.747000e+09</td>      <td>-7.895000e+09</td>      <td>-5.279000e+09</td>    </tr>    <tr>      <th>Change To Liabilities</th>      <td>1.405000e+10</td>      <td>3.070000e+08</td>      <td>-2.336600e+10</td>      <td>2.301100e+10</td>    </tr>    <tr>      <th>Total Cashflows From Investing Activities</th>      <td>8.350000e+08</td>      <td>3.572000e+09</td>      <td>-1.036800e+10</td>      <td>-8.584000e+09</td>    </tr>    <tr>      <th>Net Borrowings</th>      <td>3.220000e+09</td>      <td>3.220000e+09</td>      <td>1.042300e+10</td>      <td>-9.780000e+08</td>    </tr>    <tr>      <th>Total Cash From Financing Activities</th>      <td>-2.038200e+10</td>      <td>-2.939600e+10</td>      <td>-1.132600e+10</td>      <td>-3.224900e+10</td>    </tr>    <tr>      <th>Change To Operating Activities</th>      <td>-5.602000e+09</td>      <td>-6.048000e+09</td>      <td>1.126500e+10</td>      <td>-5.761000e+09</td>    </tr>    <tr>      <th>Issuance Of Stock</th>      <td>5.440000e+08</td>      <td>5.440000e+08</td>      <td>5.610000e+08</td>      <td>5.610000e+08</td>    </tr>    <tr>      <th>Net Income</th>      <td>2.055100e+10</td>      <td>2.174400e+10</td>      <td>2.363000e+10</td>      <td>2.875500e+10</td>    </tr>    <tr>      <th>Change In Cash</th>      <td>6.530000e+08</td>      <td>-4.730000e+09</td>      <td>2.287000e+09</td>      <td>-2.070000e+09</td>    </tr>    <tr>      <th>Repurchase Of Stock</th>      <td>-2.044900e+10</td>      <td>-2.559500e+10</td>      <td>-1.884700e+10</td>      <td>-2.763600e+10</td>    </tr>    <tr>      <th>Total Cash From Operating Activities</th>      <td>2.020000e+10</td>      <td>2.109400e+10</td>      <td>2.398100e+10</td>      <td>3.876300e+10</td>    </tr>    <tr>      <th>Depreciation</th>      <td>2.989000e+09</td>      <td>2.832000e+09</td>      <td>2.797000e+09</td>      <td>2.666000e+09</td>    </tr>    <tr>      <th>Other Cashflows From Investing Activities</th>      <td>-5.300000e+08</td>      <td>-7.800000e+07</td>      <td>-2.040000e+08</td>      <td>2.040000e+08</td>    </tr>    <tr>      <th>Dividends Paid</th>      <td>-3.640000e+09</td>      <td>-3.767000e+09</td>      <td>-3.447000e+09</td>      <td>-3.613000e+09</td>    </tr>    <tr>      <th>Change To Inventory</th>      <td>-1.429000e+09</td>      <td>1.300000e+07</td>      <td>-2.760000e+08</td>      <td>-9.500000e+08</td>    </tr>    <tr>      <th>Change To Account Receivables</th>      <td>-8.809000e+09</td>      <td>1.031000e+09</td>      <td>8.598000e+09</td>      <td>-1.094500e+10</td>    </tr>    <tr>      <th>Other Cashflows From Financing Activities</th>      <td>-5.700000e+07</td>      <td>-3.400000e+07</td>      <td>-1.600000e+07</td>      <td>-2.200000e+07</td>    </tr>    <tr>      <th>Change To Netincome</th>      <td>-1.550000e+09</td>      <td>1.215000e+09</td>      <td>1.333000e+09</td>      <td>1.987000e+09</td>    </tr>    <tr>      <th>Capital Expenditures</th>      <td>-3.223000e+09</td>      <td>-2.093000e+09</td>      <td>-2.269000e+09</td>      <td>-3.500000e+09</td>    </tr>  </tbody></table></div><h3 id="其他信息"><a href="#其他信息" class="headerlink" title="其他信息"></a>其他信息</h3><h4 id="证券的ISIN号-isin"><a href="#证券的ISIN号-isin" class="headerlink" title="证券的ISIN号 - isin"></a>证券的ISIN号 - isin</h4><p>ISIN表征国际证券识别码（英文：International Securities Identification Number，缩写：ISIN），辨别各种证券，是独一无二的编码。相同公司可能在多地上市，不同的证券交易市场会给与不同的股票代码，但是它的ISIN都是一样的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_isin <span class="token operator">=</span> aapl<span class="token punctuation">.</span>isinaapl_isin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>'US0378331005'</code></pre><h4 id="大机构的推荐信息-recommendations"><a href="#大机构的推荐信息-recommendations" class="headerlink" title="大机构的推荐信息 - recommendations"></a>大机构的推荐信息 - recommendations</h4><p>通过该函数可以获取各大机构在不同时期对该股票做的推荐信息，以下显示最近5个推荐记录。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_recommendations <span class="token operator">=</span> aapl<span class="token punctuation">.</span>recommendationsaapl_recommendations<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Firm</th>      <th>To Grade</th>      <th>From Grade</th>      <th>Action</th>    </tr>    <tr>      <th>Date</th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>2021-10-19 12:55:08</th>      <td>DA Davidson</td>      <td>Buy</td>      <td></td>      <td>main</td>    </tr>    <tr>      <th>2021-10-27 13:11:01</th>      <td>Morgan Stanley</td>      <td>Overweight</td>      <td></td>      <td>main</td>    </tr>    <tr>      <th>2021-10-29 10:56:50</th>      <td>Oppenheimer</td>      <td>Outperform</td>      <td></td>      <td>main</td>    </tr>    <tr>      <th>2021-10-29 11:16:45</th>      <td>Barclays</td>      <td>Equal-Weight</td>      <td></td>      <td>main</td>    </tr>    <tr>      <th>2021-10-29 11:41:38</th>      <td>Morgan Stanley</td>      <td>Overweight</td>      <td></td>      <td>main</td>    </tr>  </tbody></table></div><h4 id="后续期权到期时间-options"><a href="#后续期权到期时间-options" class="headerlink" title="后续期权到期时间 - options"></a>后续期权到期时间 - options</h4><p>以下显示最近5个期权到期时间</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_options <span class="token operator">=</span> aapl<span class="token punctuation">.</span>optionsaapl<span class="token punctuation">.</span>options<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>('2021-12-17', '2021-12-23', '2021-12-31', '2022-01-07', '2022-01-14')</code></pre><h4 id="相关新闻-news"><a href="#相关新闻-news" class="headerlink" title="相关新闻 - news"></a>相关新闻 - news</h4><p>以下打印最近的一条新闻</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_news <span class="token operator">=</span> aapl<span class="token punctuation">.</span>newsaapl_news<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>{'uuid': 'e6b5cca0-ce6d-35bf-9d41-b9d2723aa129', 'title': 'Biden Team Mulls New Clampdown on China’s Largest Chipmaker', 'publisher': 'Bloomberg', 'link': 'https://finance.yahoo.com/news/biden-team-considers-clampdown-china-231703320.html', 'providerPublishTime': 1639556151, 'type': 'STORY'}</code></pre><h4 id="股票分析预测信息-analysis"><a href="#股票分析预测信息-analysis" class="headerlink" title="股票分析预测信息 - analysis"></a>股票分析预测信息 - analysis</h4><p>可以获取当季，下一季度，下一财年等的分析预测信息，以下打印当季分析信息。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl_analysis <span class="token operator">=</span> aapl<span class="token punctuation">.</span>analysisaapl_analysis<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>Max Age                                                   1End Date                                2021-12-31 00:00:00Growth                                                0.119Earnings Estimate Avg                                 1.880Earnings Estimate Low                                 1.750Earnings Estimate High                                1.970Earnings Estimate Year Ago Eps                        1.680Earnings Estimate Number Of Analysts                 25.000Earnings Estimate Growth                              0.119Revenue Estimate Avg                       118137000000.000Revenue Estimate Low                       111806000000.000Revenue Estimate High                      121303000000.000Revenue Estimate Number Of Analysts                  22.000Revenue Estimate Year Ago Revenue                       NaNRevenue Estimate Growth                                 NaNEps Trend Current                                     1.880Eps Trend 7Days Ago                                   1.880Eps Trend 30Days Ago                                  1.880Eps Trend 60Days Ago                                  1.870Eps Trend 90Days Ago                                  1.870Eps Revisions Up Last7Days                            1.000Eps Revisions Up Last30Days                           2.000Eps Revisions Down Last30Days                         0.000Eps Revisions Down Last90Days                           NaNName: 0Q, dtype: object</code></pre><h4 id="可持续金融信息-sustainability"><a href="#可持续金融信息-sustainability" class="headerlink" title="可持续金融信息 - sustainability"></a>可持续金融信息 - sustainability</h4><p>可持续金融用来衡量企业追求环境目标，尤其是促进能源转型的金融法规，标准，规范和产品。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">aapl<span class="token punctuation">.</span>sustainability<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Value</th>    </tr>    <tr>      <th>2021-9</th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>palmOil</th>      <td>False</td>    </tr>    <tr>      <th>controversialWeapons</th>      <td>False</td>    </tr>    <tr>      <th>gambling</th>      <td>False</td>    </tr>    <tr>      <th>socialScore</th>      <td>7.99</td>    </tr>    <tr>      <th>nuclear</th>      <td>False</td>    </tr>    <tr>      <th>furLeather</th>      <td>False</td>    </tr>    <tr>      <th>alcoholic</th>      <td>False</td>    </tr>    <tr>      <th>gmo</th>      <td>False</td>    </tr>    <tr>      <th>catholic</th>      <td>False</td>    </tr>    <tr>      <th>socialPercentile</th>      <td>None</td>    </tr>    <tr>      <th>peerCount</th>      <td>53</td>    </tr>    <tr>      <th>governanceScore</th>      <td>8.64</td>    </tr>    <tr>      <th>environmentPercentile</th>      <td>None</td>    </tr>    <tr>      <th>animalTesting</th>      <td>False</td>    </tr>    <tr>      <th>tobacco</th>      <td>False</td>    </tr>    <tr>      <th>totalEsg</th>      <td>16.92</td>    </tr>    <tr>      <th>highestControversy</th>      <td>3</td>    </tr>    <tr>      <th>esgPerformance</th>      <td>UNDER_PERF</td>    </tr>    <tr>      <th>coal</th>      <td>False</td>    </tr>    <tr>      <th>pesticides</th>      <td>False</td>    </tr>    <tr>      <th>adult</th>      <td>False</td>    </tr>    <tr>      <th>percentile</th>      <td>13.68</td>    </tr>    <tr>      <th>peerGroup</th>      <td>Technology Hardware</td>    </tr>    <tr>      <th>smallArms</th>      <td>False</td>    </tr>    <tr>      <th>environmentScore</th>      <td>0.29</td>    </tr>    <tr>      <th>governancePercentile</th>      <td>None</td>    </tr>    <tr>      <th>militaryContract</th>      <td>False</td>    </tr>  </tbody></table></div>]]></content>
      
      
      <categories>
          
          <category> Quantitative Investment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yfinance </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NumPy：快速创建数组（Array）</title>
      <link href="/20211214/numpy-kuai-su-chuang-jian-shu-zu-array/"/>
      <url>/20211214/numpy-kuai-su-chuang-jian-shu-zu-array/</url>
      
        <content type="html"><![CDATA[<h2 id="快速创建数组（Array）"><a href="#快速创建数组（Array）" class="headerlink" title="快速创建数组（Array）"></a>快速创建数组（Array）</h2><p>NumPy为Python提供了高阶数组与矩阵运算，因此数组（Array）也成为使用NumPy的最基本数据单元，本Note记录如何快速的创建数组。</p><h3 id="将Python-List转换成数组"><a href="#将Python-List转换成数组" class="headerlink" title="将Python List转换成数组"></a>将Python List转换成数组</h3><p>如果有现成的Python list，则可以直接通过numpy.array()函数将Python list转成NumPy数组。如下为一维数组实例。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npa_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>a_list<span class="token punctuation">)</span> <span class="token comment"># array([1, 2, 3, 4])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>多维数组实例：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">b_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>b_list<span class="token punctuation">)</span><span class="token comment"># array([[1, 2, 3],</span><span class="token comment">#        [3, 4, 5],</span><span class="token comment">#        [5, 6, 7]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="zeros-生成全0数组"><a href="#zeros-生成全0数组" class="headerlink" title="zeros()生成全0数组"></a>zeros()生成全0数组</h3><p>dtype可以用来限制生成数组内数据类型，默认为float。如下为一维数组实例</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token comment"># array([0, 0, 0, 0, 0])</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ones-生成全1数组"><a href="#ones-生成全1数组" class="headerlink" title="ones()生成全1数组"></a>ones()生成全1数组</h3><p>功能同zeros()，ones()可以用来生成全1数组。如下为3x5数组实例。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token comment"># array([[1, 1, 1, 1, 1],</span><span class="token comment">#        [1, 1, 1, 1, 1],</span><span class="token comment">#        [1, 1, 1, 1, 1]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="full-生成同一值数组"><a href="#full-生成同一值数组" class="headerlink" title="full()生成同一值数组"></a>full()生成同一值数组</h3><p>类似全0和全1，full()可以用来生成由同一值组成的数组。如下为3x5且每一个元素均为2.4的数组实例。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2.4</span><span class="token punctuation">)</span><span class="token comment"># array([[2.4, 2.4, 2.4, 2.4, 2.4],</span><span class="token comment">#        [2.4, 2.4, 2.4, 2.4, 2.4],</span><span class="token comment">#        [2.4, 2.4, 2.4, 2.4, 2.4]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>这个数组也可以用zeros()和ones()来实现。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2.4</span><span class="token comment"># array([[2.4, 2.4, 2.4, 2.4, 2.4],</span><span class="token comment">#        [2.4, 2.4, 2.4, 2.4, 2.4],</span><span class="token comment">#        [2.4, 2.4, 2.4, 2.4, 2.4]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.4</span><span class="token comment"># array([[2.4, 2.4, 2.4, 2.4, 2.4],</span><span class="token comment">#        [2.4, 2.4, 2.4, 2.4, 2.4],</span><span class="token comment">#        [2.4, 2.4, 2.4, 2.4, 2.4]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="arange-生成由递增数列组成的数组"><a href="#arange-生成由递增数列组成的数组" class="headerlink" title="arange()生成由递增数列组成的数组"></a>arange()生成由递增数列组成的数组</h3><p>如下实例，生成从0到18递增（增幅为2）的数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># array([ 0,  2,  4,  6,  8, 10, 12, 14, 16, 18])</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="linspace-生成由递增数列组成的数组"><a href="#linspace-生成由递增数列组成的数组" class="headerlink" title="linspace()生成由递增数列组成的数组"></a>linspace()生成由递增数列组成的数组</h3><p>使用arange()时，我们知道数列的增幅为多少，如果不知道增幅，可以使用lingspace()，如下实例创建一个在0到1之间均匀的生成5个值的数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># array([0.  , 0.25, 0.5 , 0.75, 1.  ])</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="随机值组成的数组"><a href="#随机值组成的数组" class="headerlink" title="随机值组成的数组"></a>随机值组成的数组</h3><p>使用random.random()可以生成一个均匀分布的随机值组成的数组</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[0.61138824, 0.54712149, 0.40095232, 0.39771161, 0.0281933 ],</span><span class="token comment">#        [0.08123355, 0.41283792, 0.00461631, 0.12341322, 0.86842517],</span><span class="token comment">#        [0.93693765, 0.97597066, 0.30344276, 0.8472288 , 0.80629387]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>使用random.norm()可以生成一个均值为0，方差为1的正态分布的随机值组成的数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[ 1.30565338, -1.08954521, -0.209259  ,  0.85940426,  0.68683533],</span><span class="token comment">#        [ 1.20633136,  2.57417898,  0.43243003,  0.3559354 ,  0.82257559],</span><span class="token comment">#        [-1.11870164,  0.04259074,  1.7639825 , -0.30045559,  2.50982843]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>使用random.randint()可以生成一个在给定范围内随机选择的整数组成的数组。如下实例生成一个在0（含）到10（不含）之间随机选择组成的3x5整数数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># array([[0, 7, 0, 9, 9],</span><span class="token comment">#        [4, 4, 8, 2, 8],</span><span class="token comment">#        [8, 2, 0, 7, 2]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="eye-生成单位矩阵"><a href="#eye-生成单位矩阵" class="headerlink" title="eye()生成单位矩阵"></a>eye()生成单位矩阵</h3><p>单位矩阵是一个对角线元素为1，其余元素均为0的矩阵。以下实例生成一个5*5的单位矩阵。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment"># array([[1., 0., 0., 0., 0.],</span><span class="token comment">#        [0., 1., 0., 0., 0.],</span><span class="token comment">#        [0., 0., 1., 0., 0.],</span><span class="token comment">#        [0., 0., 0., 1., 0.],</span><span class="token comment">#        [0., 0., 0., 0., 1.]])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python数据分析：导入在线范例数据集</title>
      <link href="/20211213/python-shu-ju-fen-xi-dao-ru-zai-xian-fan-li-shu-ju-ji/"/>
      <url>/20211213/python-shu-ju-fen-xi-dao-ru-zai-xian-fan-li-shu-ju-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="导入在线范例数据集"><a href="#导入在线范例数据集" class="headerlink" title="导入在线范例数据集"></a>导入在线范例数据集</h2><p>在做数据分析时，经常要使用范例数据集来做模型验证和演示等，其中Iris花卉数据集就是一个比较常见的统计范例数据。该数据包含150个样本，都属于Iris下面三个亚属，数据集通过记录花萼长度和宽度，花瓣长度和宽度，以及所属亚属来表征一个记录。这个数据集是公共可用的，Python的一些包也内嵌了这个数据集，我们可以通过以下方式来直接获取。</p><h3 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h3><p>从Pandas 0.19.2版本开始，如果知道范例数据集的URL，可以直接通过read_csv()的方式将数据集读取。以下以如何获取Iris数据集为例，更多的范例数据集的URL可以从<a href="https://vincentarelbundock.github.io/Rdatasets/datasets.html">此链接</a>获取。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdiris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'https://raw.githubusercontent.com/mwaskom/seaborn-data/master/iris.csv'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>以上方式可能涉及到认证，也可以通过利用request包读取网页内容，然后将内容传递给pandas的方式来读取范例数据集。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> io<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://raw.githubusercontent.com/mwaskom/seaborn-data/master/iris.csv'</span>url_content <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>contentiris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>io<span class="token punctuation">.</span>StringIO<span class="token punctuation">(</span>url_content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>很多Python包实际已经内嵌了Iris数据集，以下是常见的几个包以及获取Iris数据集的方式。</p><h3 id="statsmodels"><a href="#statsmodels" class="headerlink" title="statsmodels"></a>statsmodels</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> smiris <span class="token operator">=</span> sm<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>get_rdataset<span class="token punctuation">(</span><span class="token string">'iris'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="pydataset"><a href="#pydataset" class="headerlink" title="pydataset"></a>pydataset</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pydataset <span class="token keyword">import</span> datairis <span class="token operator">=</span> data<span class="token punctuation">(</span><span class="token string">'iris'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="scikit-learn"><a href="#scikit-learn" class="headerlink" title="scikit-learn"></a>scikit-learn</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_irisiris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>以上导入的不是Pandas的dataframe格式，还需要通过以下代码将导出数据集转成dataframe格式。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npiris <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span> np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>iris<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'feature_names'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="seaborn"><a href="#seaborn" class="headerlink" title="seaborn"></a>seaborn</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> snsiris <span class="token operator">=</span> sns<span class="token punctuation">.</span>load_dataset<span class="token punctuation">(</span><span class="token string">'iris'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="quilt"><a href="#quilt" class="headerlink" title="quilt"></a>quilt</h3><p>更多Quilt的介绍见官网：<a href="https://docs.quiltdata.com/">Introduction - quilt (quiltdata.com)</a></p><p>在读取数据集之前，需要在shell通过quilt将数据集下载下来：</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">quilt install uciml/iris<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>以下即通过quilt读取范例数据集Iris的方式：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> quilt<span class="token punctuation">.</span>data<span class="token punctuation">.</span>uciml<span class="token punctuation">.</span>iris <span class="token keyword">as</span> iriris <span class="token operator">=</span> ir<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p>This note is inspired by the following references: </p><p><a href="https://stackoverflow.com/questions/28417293/sample-datasets-in-pandas">python - Sample datasets in Pandas - Stack Overflow</a></p>]]></content>
      
      
      <categories>
          
          <category> Data Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pandas </tag>
            
            <tag> statsmodels </tag>
            
            <tag> pydataset </tag>
            
            <tag> seaborn </tag>
            
            <tag> quilt </tag>
            
            <tag> sklearn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>创建Python运行的虚拟环境</title>
      <link href="/20211212/chuang-jian-python-yun-xing-de-xu-ni-huan-jing/"/>
      <url>/20211212/chuang-jian-python-yun-xing-de-xu-ni-huan-jing/</url>
      
        <content type="html"><![CDATA[<h1 id="创建Python运行的虚拟环境"><a href="#创建Python运行的虚拟环境" class="headerlink" title="创建Python运行的虚拟环境"></a>创建Python运行的虚拟环境</h1><p>当运行不同的Python项目时，所需要的Python包可能依赖的Python版本不一致，为了“隔离”出一个Python运行环境，在不同的项目运行不同的Python版本而对全局Python版本不产生影响，虚拟环境就是一个很好的手段。</p><h2 id="创建当前Python版本的虚拟环境"><a href="#创建当前Python版本的虚拟环境" class="headerlink" title="创建当前Python版本的虚拟环境"></a>创建当前Python版本的虚拟环境</h2><p>使用<span style="background-color:  #d0d3d4">venv</span>包直接生成虚拟环境myenv</p><pre><code>python3 -m venv myenv</code></pre><p>激活该虚拟环境</p><pre><code>source myenv/bin/activate</code></pre><p>退出该虚拟环境</p><pre><code>deactivate</code></pre><h2 id="创建特定Python版本的虚拟环境"><a href="#创建特定Python版本的虚拟环境" class="headerlink" title="创建特定Python版本的虚拟环境"></a>创建特定Python版本的虚拟环境</h2><p>由于目前新的Ubuntu版本（20.04）的Python3版本都是默认3.8，如果需要创建Python 3.7或者更老版本的虚拟环境，首先需要从<a href="https://launchpad.net/~deadsnakes/+archive/ubuntu/ppa">deadsnakes PPA</a>下载Python3.7.</p><pre><code>sudo add-apt-repository ppa:deadsnakes/ppasudo apt-get updatesudo apt-get install python3.7</code></pre><p>安装好Python 3.7以后可以开始创建虚拟环境，首先安装<span style="background-color:  #d0d3d4">virtualenv</span>包。</p><pre><code>python3.7 -m pip install virtualenv</code></pre><p>新建虚拟环境</p><pre><code>python3.7 -m virtualenv myenv</code></pre><p>激活该虚拟环境</p><pre><code>source myenv/bin/activate</code></pre><p> 退出该虚拟环境</p><pre><code> deactivate</code></pre>]]></content>
      
      
      <categories>
          
          <category> Small Technique </category>
          
      </categories>
      
      
        <tags>
            
            <tag> venv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为GitHub Pages上的个人博客绑定GoDaddy域名</title>
      <link href="/20211211/wei-github-page-shang-de-ge-ren-bo-ke-bang-ding-godaddy-yu-ming/"/>
      <url>/20211211/wei-github-page-shang-de-ge-ren-bo-ke-bang-ding-godaddy-yu-ming/</url>
      
        <content type="html"><![CDATA[<h1 id="为GitHub-Pages上的个人博客绑定GoDaddy域名"><a href="#为GitHub-Pages上的个人博客绑定GoDaddy域名" class="headerlink" title="为GitHub Pages上的个人博客绑定GoDaddy域名"></a>为GitHub Pages上的个人博客绑定GoDaddy域名</h1><p>很多人通过GitHub Pages来搭建自己的博客网站，默认的地址一般是username.github.io，这里的username一般是你GitHub的用户名。这样的地址不被记住，同时GitHub Pages也提供绑定个人域名的功能，所以如果有比较好记忆的域名可以通过GitHub Pages来绑定，通过直接访问域名的方式（而不是username.github.io）来访问挂载在GitHub上的个人博客网站。</p><p>本博客的域名在GoDaddy上购买，点击进入GoDaddy个人域名DNS配置后，将     185.199.108.153，185.199.109.153，185.199.110.153，185.199.111.153这几个IP地址加入到A记录，将个人原Github博客地址username.github.io（将username替换成个人用户名）添加到CNAME记录。针对本博客的A记录和CNAME记录如下截图。</p><p><img src="https://media.publit.io/file/Godaddy-dns.png" alt="GoDaddy DNS" title="GoDaddy DNS"></p><ul><li>A记录：将一个域名解析到一个IP地址，如上面例子即将个人域名解析到那四个配置的IP地址</li><li>CNAME记录：将一个域名解析到另外一个域名，如上面例子及将个人域名解析到username.github.io</li></ul><p>将上述配置好后，然后返回到GitHub Pages配置页，在Custom domain填上个人域名（对于本博客就是<a href="http://www.wenvenn.com/">www.wenvenn.com</a> ），点击Save以后GitHub会自动检测DNS，如果通过的话在填写的域名后面可以看到一个绿色的钩，这里建议同时勾选HTTPS。如下截图。</p><p><img src="https://media.publit.io/file/Github-custom-domain.png" alt="GitHub Pages Custom Domain" title="GitHub Pages Custom Domain"></p><p>有时候在GoDaddy上注册个人域名并配置DNS后不一定会马上生效，这里涉及到DNS广播，一般耗时几个小时，最长48个小时，个人可以通过<a href="https://dnschecker.org/">DNS Checker</a> 或者<a href="https://www.whatsmydns.net/">What’s My DNS</a> 这两个网站来查询DNS状态，如果都打钩的话说明已经OK了。</p>]]></content>
      
      
      <categories>
          
          <category> Small Technique </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitHub </tag>
            
            <tag> 个人网站 </tag>
            
            <tag> DNS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Ubuntu上安装Markdown编辑器Remarkable</title>
      <link href="/20211207/zai-ubuntu-shang-an-zhuang-markdown-bian-ji-qi-remarkable/"/>
      <url>/20211207/zai-ubuntu-shang-an-zhuang-markdown-bian-ji-qi-remarkable/</url>
      
        <content type="html"><![CDATA[<h2 id="在Ubuntu上安装Markdown编辑器Remarkable"><a href="#在Ubuntu上安装Markdown编辑器Remarkable" class="headerlink" title="在Ubuntu上安装Markdown编辑器Remarkable"></a>在Ubuntu上安装Markdown编辑器Remarkable</h2><p>Remarkable是一个非常简洁，轻便的用于Linux环境下开源的Markdown编辑器，支持GitHub风格的格式，支持代码高亮，也可以将md文件转成html和pdf格式，非常适合博客文章的写作。</p><p>由于依赖文件太老或者一些其他原因，<a href="https://remarkableapp.github.io/linux.html">官方网站</a> 上下载的deb文件不能够直接在Ubuntu 20.04上安装。有大神在GitHub上提供了一个<a href="https://github.com/seiferteric/remarkable_debfix">解决方案</a> ，该方案将依赖文件重新打包生成新的deb文件，以下是详细操作：</p><pre><code>git clone https://github.com/seiferteric/remarkable_debfix.gitcd remarkable_debfix/dpkg-deb -Z xz -b old_deb remarkable_1.87_all.deb</code></pre><p>新的deb文件生成后双击即可安装，也可以通过命令行进行安装。命令行安装依赖gdebi，需要提前安装gdebi-core。</p><pre><code>sudo apt-get install gdebi-core</code></pre><p>然后再安装Remarkable 1.87</p><pre><code>sudo gdebi remarkable_1.87_all.deb </code></pre>]]></content>
      
      
      <categories>
          
          <category> Small Technique </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Remarkable </tag>
            
            <tag> Markdown </tag>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
