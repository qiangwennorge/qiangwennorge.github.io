<!DOCTYPE HTML><html lang="en"><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><head><meta charset="utf-8"><meta name="keywords" content="Building a quantitative value investing strategy, Wenvenn"><meta name="description" content="Quantitative Value StrategyQuantitative value intestment means invest in the stocks that are “cheapest” relative to comm"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><script async src="https://www.googletagmanager.com/gtag/js?id=G-VYP094MR3V"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-VYP094MR3V")</script><title>Building a quantitative value investing strategy | Wenvenn</title><link rel="icon" type="image/png" href="/favicon-32x32.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery-3.6.0.min.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Wenvenn" type="application/atom+xml"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/android-chrome-192x192.png" class="logo-img" alt="LOGO"> <span class="logo-span">Wenvenn</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>Home</span></a></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fas fa-chart-bar" style="zoom:.6"></i> <span>Shortcuts</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/tags"><i class="fas fa-tags" style="margin-top:-20px;zoom:.6"></i> <span>Tags</span></a></li><li><a href="/categories"><i class="fas fa-bookmark" style="margin-top:-20px;zoom:.6"></i> <span>Categories</span></a></li><li><a href="/archives"><i class="fas fa-archive" style="margin-top:-20px;zoom:.6"></i> <span>Archives</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fas fa-address-card" style="zoom:.6"></i> <span>About</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/about"><i class="fas fa-user-circle" style="margin-top:-20px;zoom:.6"></i> <span>About</span></a></li><li><a href="/friends"><i class="fas fa-link" style="margin-top:-20px;zoom:.6"></i> <span>Usefull Links</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="/projects" class="waves-effect waves-light"><i class="fas fa-cogs" style="zoom:.6"></i> <span>Projects</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="Search" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/android-chrome-192x192.png" class="logo-img circle responsive-img"><div class="logo-name">Wenvenn</div><div class="logo-desc"></div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> Home</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-chart-bar"></i> Shortcuts <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/tags" style="margin-left:75px"><i class="fa fas fa-tags" style="position:absolute;left:50px"></i> <span>Tags</span></a></li><li><a href="/categories" style="margin-left:75px"><i class="fa fas fa-bookmark" style="position:absolute;left:50px"></i> <span>Categories</span></a></li><li><a href="/archives" style="margin-left:75px"><i class="fa fas fa-archive" style="position:absolute;left:50px"></i> <span>Archives</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-address-card"></i> About <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/about" style="margin-left:75px"><i class="fa fas fa-user-circle" style="position:absolute;left:50px"></i> <span>About</span></a></li><li><a href="/friends" style="margin-left:75px"><i class="fa fas fa-link" style="position:absolute;left:50px"></i> <span>Usefull Links</span></a></li></ul></li><li class="m-nav-item"><a href="/projects" class="waves-effect waves-light"><i class="fa-fw fas fa-cogs"></i> Projects</a></li></ul></div></div></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/11.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">Building a quantitative value investing strategy</h1></div></div></div></div></div><main class="container content"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/yfinance/"><span class="chip bg-color">yfinance</span> </a><a href="/tags/xlsxwriter/"><span class="chip bg-color">xlsxwriter</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Quantitative-Investment/" class="post-category">Quantitative Investment</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp; 2024-02-28</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp; 2024-03-01</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp; 2.1k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp; 13 Min</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><link rel="stylesheet" href="/libs/prism/prism.css"><div class="card-content article-card-content"><div id="articleContent"><h2 id="Quantitative-Value-Strategy"><a href="#Quantitative-Value-Strategy" class="headerlink" title="Quantitative Value Strategy"></a>Quantitative Value Strategy</h2><p>Quantitative value intestment means invest in the stocks that are “cheapest” relative to common measures of business value (like earnings or assets), which focuses on identifying undervalued assets and purchasing them at a price below their intrinsic value (true worth), this strategy is a cornerstone of successful long-term investing.</p><ul><li><strong>Intrinsic value</strong>: the price level that reflects the actual worth or value of the company</li><li><strong>Margin of safety</strong>: the difference between purchase value and the true value</li></ul><p>Quantitative value investing relies on various financial ratios to assess the value of potential investments, here below are the commonly used ratios in quantitative value investing.</p><ul><li><strong>Price-to-Earnings (P/E) Ratio</strong>: a lower P/E ratio is often seen as an indicator of undervaluation.</li><li><strong>Return on Equity (ROE)</strong>: a higher ROE is generally desirable.</li><li><strong>Price-to-book (P/B) Ratio</strong>: a P/B ratio below 1 can suggest that a stock is undervalued.</li><li><strong>Price-to-Sales (P/S) Ratio</strong>: a lower P/S ratio can indicate undervaluation.</li><li><strong>Price-to-Cash Flow (P/CF) Ratio</strong>: a lower P/CF ratio may indicate that the stock is undervalued. It reflects how much cash the company generates relative to its stock price.</li><li><strong>Dividend Yield</strong>: it measures the annual dividends paid by a company as a percentage of its stock price, therefore a higher dividend yield may be attractive to income-focused investors.</li><li><strong>Earnings Yield</strong>: it is the inverse of the P/E ratio. It’s a measure of how much a company earns in relation to its stock price.</li><li><strong>Debt-to-Equity (D/E) Ratio</strong>: a lower D/E ratio indicates lower financial risk.</li><li><strong>Current Ratio</strong>: it measures a company’s ability to cover its short-term liabilities with its short-term assets. A higher current ratio is often preferred.</li><li><strong>Free Cash Flow (FCF) Yield</strong>: it compares a company’s free cash flow to its market capitalisation. A higher FCF yield can indicate value and financial health.</li><li><strong>Enterprise Value divided by Earnings Before Interest, Taxes, Depreciation, and Amortization (EV/EBITDA)</strong>, it takes into account a company’s debt and cash levels in addition to its stock price and relates that value to the firm’s cash profitability. Higher enterprise multiples are expected in high-growth industries and lower multiples in industries with slow growth.</li><li><strong>Enterprise Value divided by Gross Profit (EV/GP)</strong>, it is a profitability financial ratio that estimates the enterprise value of a company to its gross profit. Generally, the lower the ratio, the lower is the company’s net worth.</li></ul><p>The goal of this section is trying to create an investing strategy following the instruction on <a target="_blank" rel="noopener" href="https://github.com/nickmccullum/algorithmic-trading-python/tree/master">https://github.com/nickmccullum/algorithmic-trading-python/tree/master</a>, with this strategy it selects the 50 stocks in S&amp;P 600 list with the highest value metric (we start with P/E ratio). From there, the trades with an equal-weight portfolio of these 50 stocks will be calculated.</p><h2 id="Load-the-list-of-S-amp-P-600-companies-from-Wikepedia"><a href="#Load-the-list-of-S-amp-P-600-companies-from-Wikepedia" class="headerlink" title="Load the list of S&amp;P 600 companies from Wikepedia"></a>Load the list of S&amp;P 600 companies from Wikepedia</h2><p>The S&amp;P 600 is an index of small-cap company stocks created by Standard &amp; Poor’s, selected by a committee based on recent profitability and other factors.</p><p>Currently there are 3 S&amp;P Small Cap 600 ETFs traded on the U.S. markets, the largest one is iShares S&amp;P Small-Cap 600 Value ETF IJS with around 7.09 Billon USD in assets.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the list of S&amp;P 600 stocks from Wikepedia</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    html <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> html

<span class="token comment"># Load the list of S&amp;P 600 companies</span>
url <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/List_of_S%26P_600_companies'</span>
df <span class="token operator">=</span> load_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Symbol</th><th>Company</th><th>GICS Sector</th><th>GICS Sub-Industry</th><th>Headquarters Location</th><th>SEC filings</th><th>CIK</th></tr></thead><tbody><tr><th>0</th><td>AAON</td><td>AAON, Inc.</td><td>Industrials</td><td>Building Products</td><td>Tulsa, Oklahoma</td><td>view</td><td>824142</td></tr><tr><th>1</th><td>AAP</td><td>Advance Auto Parts, Inc.</td><td>Consumer Discretionary</td><td>Automotive Retail</td><td>Raleigh, North Carolina</td><td>view</td><td>1158449</td></tr><tr><th>2</th><td>AAT</td><td>American Assets Trust</td><td>Real Estate</td><td>Diversified REITs</td><td>San Diego, California</td><td>view</td><td>1500217</td></tr><tr><th>3</th><td>ABCB</td><td>Ameris Bancorp</td><td>Financials</td><td>Regional Banks</td><td>Atlanta, Georgia</td><td>view</td><td>351569</td></tr><tr><th>4</th><td>ABG</td><td>Asbury Automotive Group</td><td>Consumer Discretionary</td><td>Automotive Retail</td><td>Duluth, Georgia</td><td>view</td><td>1144980</td></tr></tbody></table></div><h2 id="Retrieve-the-latest-stock-info-using-yfinance"><a href="#Retrieve-the-latest-stock-info-using-yfinance" class="headerlink" title="Retrieve the latest stock info using yfinance"></a>Retrieve the latest stock info using yfinance</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf

<span class="token keyword">def</span> <span class="token function">retrieveQuote</span><span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">:</span>
    stock_dict <span class="token operator">=</span> yf<span class="token punctuation">.</span>Ticker<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">.</span>info
    stock <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">.</span>from_dict<span class="token punctuation">(</span>stock_dict<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span>
    stock <span class="token operator">=</span> stock<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
    stock <span class="token operator">=</span> stock<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'index'</span><span class="token punctuation">:</span> <span class="token string">'Item'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'Value'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> stock<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="P-E-Ratio"><a href="#P-E-Ratio" class="headerlink" title="P/E Ratio"></a>P/E Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'trailingPE'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>40</th><td>trailingPE</td><td>41.000004</td></tr></tbody></table></div><h3 id="Return-on-Equity-ROE"><a href="#Return-on-Equity-ROE" class="headerlink" title="Return on Equity (ROE)"></a>Return on Equity (ROE)</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token string">'returnOnEquity'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>122</th><td>returnOnEquity</td><td>0.28097</td></tr></tbody></table></div><h3 id="P-B-Ratio"><a href="#P-B-Ratio" class="headerlink" title="P/B Ratio"></a>P/B Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'priceToBook'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>70</th><td>priceToBook</td><td>10.003571</td></tr></tbody></table></div><h3 id="P-S-Ratio"><a href="#P-S-Ratio" class="headerlink" title="P/S Ratio"></a>P/S Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'priceToSalesTrailing12Months'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>54</th><td>priceToSalesTrailing12Months</td><td>6.116228</td></tr></tbody></table></div><h3 id="Price-to-Cash-Flow-P-CF-Ratio"><a href="#Price-to-Cash-Flow-P-CF-Ratio" class="headerlink" title="Price-to-Cash Flow (P/CF) Ratio"></a>Price-to-Cash Flow (P/CF) Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">price <span class="token operator">=</span> yf<span class="token punctuation">.</span>Ticker<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>history<span class="token punctuation">(</span>period<span class="token operator">=</span><span class="token string">'1d'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
price<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>84.05000305175781
</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'totalCashPerShare'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>113</th><td>totalCashPerShare</td><td>0.035</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Price-to-Cash Flow (P/CF) Ratio for AAON is: '</span><span class="token punctuation">,</span> price<span class="token operator">/</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'totalCashPerShare'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>Price-to-Cash Flow (P/CF) Ratio for AAON is:  2401.4286586216517
</code></pre><h3 id="EV-EBITDA"><a href="#EV-EBITDA" class="headerlink" title="EV/EBITDA"></a>EV/EBITDA</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'enterpriseToEbitda'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>87</th><td>enterpriseToEbitda</td><td>26.208</td></tr></tbody></table></div><h3 id="Dividend-Yield"><a href="#Dividend-Yield" class="headerlink" title="Dividend Yield"></a>Dividend Yield</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'dividendYield'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>35</th><td>dividendYield</td><td>0.0038</td></tr></tbody></table></div><h3 id="Debt-to-Equity-D-E-Ratio"><a href="#Debt-to-Equity-D-E-Ratio" class="headerlink" title="Debt-to-Equity (D/E) Ratio"></a>Debt-to-Equity (D/E) Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'debtToEquity'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>119</th><td>debtToEquity</td><td>8.581</td></tr></tbody></table></div><h3 id="Current-Ratio"><a href="#Current-Ratio" class="headerlink" title="Current Ratio"></a>Current Ratio</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'currentRatio'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>117</th><td>currentRatio</td><td>3.027</td></tr></tbody></table></div><h3 id="Free-Cash-Flow-FCF-Yield"><a href="#Free-Cash-Flow-FCF-Yield" class="headerlink" title="Free Cash Flow (FCF) Yield"></a>Free Cash Flow (FCF) Yield</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'freeCashflow'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>123</th><td>freeCashflow</td><td>16578000</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'marketCap'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Item</th><th>Value</th></tr></thead><tbody><tr><th>51</th><td>marketCap</td><td>6828633600</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"FCF Yield for AAON is: "</span><span class="token punctuation">,</span> retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'freeCashflow'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span><span class="token string">'AAON'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'marketCap'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>FCF Yield for AAON is:  0.002427718482362269
</code></pre><h2 id="Retrieve-the-latest-stock-price-using-yfinance"><a href="#Retrieve-the-latest-stock-price-using-yfinance" class="headerlink" title="Retrieve the latest stock price using yfinance"></a>Retrieve the latest stock price using yfinance</h2><p>We retrieve the latest day’s stock price using yfinance.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yfinance <span class="token keyword">as</span> yf
<span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> yf<span class="token punctuation">.</span>download<span class="token punctuation">(</span>
            <span class="token comment"># tickers list</span>
            tickers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment"># valid periods: 1d, 5d, 1mo, 3mo, 6mo, 1y, 5y, 10y, ytd, max</span>
            period <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>
            <span class="token comment"># valid intervals: 1m, 2m, 5m, 15m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo</span>
            interval <span class="token operator">=</span> <span class="token string">'1d'</span><span class="token punctuation">,</span>
            <span class="token comment"># group by ticker</span>
            group_by <span class="token operator">=</span> <span class="token string">'ticker'</span><span class="token punctuation">,</span>
            <span class="token comment"># adjust all OHLC automatically</span>
            auto_adjust <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
            <span class="token comment"># download pre/post regular market hours data</span>
            prepost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
            <span class="token comment"># use threads for mass downloading</span>
            threads <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
            <span class="token comment"># proxy URL scheme when downloading</span>
            proxy <span class="token operator">=</span> <span class="token boolean">None</span>
            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>[*********************100%%**********************]  602 of 602 completed

2 Failed downloads:
['MOG.A', 'CWEN.A']: Exception('%ticker%: No data found, symbol may be delisted')
</code></pre><h2 id="Calculate-PE-ratio-and-remove-the-highest-PE-ratio-stocks"><a href="#Calculate-PE-ratio-and-remove-the-highest-PE-ratio-stocks" class="headerlink" title="Calculate PE ratio and remove the highest PE ratio stocks"></a>Calculate PE ratio and remove the highest PE ratio stocks</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Get the available tickers</span>
tickers_unavailable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'MOG.A'</span><span class="token punctuation">,</span> <span class="token string">'CWEN.A'</span><span class="token punctuation">]</span>
tickers <span class="token operator">=</span> <span class="token punctuation">[</span>ticker <span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Symbol'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> ticker <span class="token keyword">not</span> <span class="token keyword">in</span> tickers_unavailable<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Number of available tickers: '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Number of available tickers:  600
</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Create the format of the dataframe that stores the stock price, market cap and number of shares to buy</span>
my_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> <span class="token string">'Price'</span><span class="token punctuation">,</span> <span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">,</span> <span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">]</span>
final_dataframe <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> my_columns<span class="token punctuation">)</span>
final_dataframe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ticker</th><th>Price</th><th>Price-to-Earnings Ratio</th><th>Number of Shares to Buy</th></tr></thead><tbody></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Input the value of the portforlio, i.e. example here is 1M USD</span>

portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    val <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span>
<span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"That's not a number! \n Try again:"</span><span class="token punctuation">)</span>
    portfolio_size <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter the value of your portfolio:"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Enter the value of your portfolio:1000000
</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Retrieve the PE ratio</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ticker <span class="token operator">=</span> tickers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    
    trailingPE <span class="token operator">=</span> retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'trailingPE'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> trailingPE<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        pe_ratio <span class="token operator">=</span> retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span>retrieveQuote<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'trailingPE'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        pe_ratio <span class="token operator">=</span> <span class="token string">"NA"</span>
    final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
            pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>
            <span class="token punctuation">[</span>
                ticker<span class="token punctuation">,</span>
                data<span class="token punctuation">[</span>ticker<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                pe_ratio<span class="token punctuation">,</span>
                <span class="token string">'NA'</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
                index <span class="token operator">=</span> my_columns<span class="token punctuation">)</span><span class="token punctuation">,</span>
                ignore_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ticker</th><th>Price</th><th>Price-to-Earnings Ratio</th><th>Number of Shares to Buy</th></tr></thead><tbody><tr><th>0</th><td>AAON</td><td>84.050003</td><td>41.000004</td><td>NA</td></tr><tr><th>1</th><td>AAP</td><td>61.099998</td><td>17.761627</td><td>NA</td></tr><tr><th>2</th><td>AAT</td><td>21.530001</td><td>25.630955</td><td>NA</td></tr><tr><th>3</th><td>ABCB</td><td>45.880001</td><td>11.794345</td><td>NA</td></tr><tr><th>4</th><td>ABG</td><td>214.619995</td><td>7.467641</td><td>NA</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># remove none PE ratio stocks</span>
final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span>final_dataframe<span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'NA'</span><span class="token punctuation">]</span>
final_dataframe<span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">]</span> <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Remove the high stocks, only keep the lowest 50</span>
final_dataframe<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
final_dataframe <span class="token operator">=</span> final_dataframe<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span>
final_dataframe<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ticker</th><th>Price</th><th>Price-to-Earnings Ratio</th><th>Number of Shares to Buy</th></tr></thead><tbody><tr><th>0</th><td>VTLE</td><td>46.610001</td><td>1.393840</td><td>NA</td></tr><tr><th>1</th><td>BFH</td><td>36.779999</td><td>2.495251</td><td>NA</td></tr><tr><th>2</th><td>AMCX</td><td>12.430000</td><td>2.536735</td><td>NA</td></tr><tr><th>3</th><td>CPE</td><td>31.280001</td><td>3.039845</td><td>NA</td></tr><tr><th>4</th><td>CCOI</td><td>78.790001</td><td>3.492465</td><td>NA</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Calculate the number of shares to buy</span>
<span class="token keyword">import</span> math
position_size <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>portfolio_size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tickers<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>final_dataframe<span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    final_dataframe<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>position_size <span class="token operator">/</span> final_dataframe<span class="token punctuation">[</span><span class="token string">'Price'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
final_dataframe<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><p></p><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ticker</th><th>Price</th><th>Price-to-Earnings Ratio</th><th>Number of Shares to Buy</th></tr></thead><tbody><tr><th>0</th><td>VTLE</td><td>46.610001</td><td>1.393840</td><td>35</td></tr><tr><th>1</th><td>BFH</td><td>36.779999</td><td>2.495251</td><td>45</td></tr><tr><th>2</th><td>AMCX</td><td>12.430000</td><td>2.536735</td><td>134</td></tr><tr><th>3</th><td>CPE</td><td>31.280001</td><td>3.039845</td><td>53</td></tr><tr><th>4</th><td>CCOI</td><td>78.790001</td><td>3.492465</td><td>21</td></tr></tbody></table></div><h2 id="Save-the-output-in-Excel-using-XlsxWriter"><a href="#Save-the-output-in-Excel-using-XlsxWriter" class="headerlink" title="Save the output in Excel using XlsxWriter"></a>Save the output in Excel using XlsxWriter</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Initiate the XlsxWriter object, save the output in xlsx format.</span>
<span class="token keyword">import</span> xlsxwriter

writer <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'quantitative value.xlsx'</span><span class="token punctuation">,</span> engine <span class="token operator">=</span> <span class="token string">'xlsxwriter'</span><span class="token punctuation">)</span>
final_dataframe<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token string">'Recommended Trades'</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Create-the-formats"><a href="#Create-the-formats" class="headerlink" title="Create the formats:"></a>Create the formats:</h3><ul><li>String format for tickers</li><li>$xx.xx format for stock prices</li><li>$xx,xxx for market capitalization</li><li>Integer format for the number of shares to buy</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">background_color <span class="token operator">=</span> <span class="token string">'#0a0a23'</span>
font_color <span class="token operator">=</span> <span class="token string">'#ffffff'</span>

string_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>
            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>
            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

dollar_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$0.00'</span><span class="token punctuation">,</span>
            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>
            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>
            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

capital_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'$#,##0'</span><span class="token punctuation">,</span>
            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>
            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>
            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

integer_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0'</span><span class="token punctuation">,</span>
            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>
            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>
            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

float_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0.000'</span><span class="token punctuation">,</span>
            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>
            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>
            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

percent_format <span class="token operator">=</span> writer<span class="token punctuation">.</span>book<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">'num_format'</span><span class="token punctuation">:</span><span class="token string">'0.0%'</span><span class="token punctuation">,</span>
            <span class="token string">'font_color'</span><span class="token punctuation">:</span> font_color<span class="token punctuation">,</span>
            <span class="token string">'bg_color'</span><span class="token punctuation">:</span> background_color<span class="token punctuation">,</span>
            <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Apply the formats to the columns of the output file</span>
column_formats <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Ticker'</span><span class="token punctuation">,</span> string_format<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Stock Price'</span><span class="token punctuation">,</span> dollar_format<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Price-to-Earnings Ratio'</span><span class="token punctuation">,</span> float_format<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Number of Shares to Buy'</span><span class="token punctuation">,</span> integer_format<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> column <span class="token keyword">in</span> column_formats<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_column<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    writer<span class="token punctuation">.</span>sheets<span class="token punctuation">[</span><span class="token string">'Recommended Trades'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>column<span class="token punctuation">}</span></span><span class="token string">1'</span></span><span class="token punctuation">,</span> column_formats<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> string_format<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Save the output</span>
writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">Author: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">wenvenn</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">Link: </i></span><span class="reprint-info"><a href="https://www.wenvenn.com/20240228/building-a-quantitative-value-investing-strategy/">https://www.wenvenn.com/20240228/building-a-quantitative-value-investing-strategy/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">Reprint policy: </i></span><span class="reprint-info">All articles in this blog are used except for special statements <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> reprint policy. If reproduced, please indicate source <a href="/about" target="_blank">wenvenn</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/yfinance/"><span class="chip bg-color">yfinance</span> </a><a href="/tags/xlsxwriter/"><span class="chip bg-color">xlsxwriter</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;Previous</div><div class="card"><a href="/20240301/calculate-capital-asset-pricing-model-capm-with-python/"><div class="card-image"><img src="/medias/featureimages/17.jpg" class="responsive-img" alt="Calculate Capital Asset Pricing Model (CAPM) with Python"> <span class="card-title">Calculate Capital Asset Pricing Model (CAPM) with Python</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-03-01 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Quantitative-Investment/" class="post-category">Quantitative Investment</a></span></div></div><div class="card-action article-tags"><a href="/tags/yfinance/"><span class="chip bg-color">yfinance</span> </a><a href="/tags/plotly/"><span class="chip bg-color">plotly</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">Next&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/20240226/building-a-quantitative-momentum-investing-strategy/"><div class="card-image"><img src="/medias/featureimages/16.jpg" class="responsive-img" alt="Building a quantitative momentum investing strategy"> <span class="card-title">Building a quantitative momentum investing strategy</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-02-26 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Quantitative-Investment/" class="post-category">Quantitative Investment</a></span></div></div><div class="card-action article-tags"><a href="/tags/yfinance/"><span class="chip bg-color">yfinance</span> </a><a href="/tags/xlsxwriter/"><span class="chip bg-color">xlsxwriter</span></a></div></div></div></div></article></div><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2021-2025</span> <a href="/about" target="_blank">Wenvenn</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;Total Words:&nbsp;<span class="white-color">42.4k</span> <span id="busuanzi_container_site_pv">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span> </span><span id="busuanzi_container_site_uv">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span></span><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=new Date,t="2021",n=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),r=e.getHours(),o=e.getMinutes(),s=e.getSeconds(),e=Date.UTC(t,"12","6","22","0","0"),i=Date.UTC(n,a,i,r,o,s)-e,r=Math.floor(i/31536e6),o=Math.floor(i/864e5-365*r),s=Math.floor(i/36e5-365*r*24-24*o),e=Math.floor(i/6e4-365*r*24*60-24*o*60-60*s);Math.floor(i/1e3-365*r*24*60*60-24*o*60*60-60*s*60-60*e);t===String(n)?(document.getElementById("year").innerHTML=n,e="This site has been running for "+o+" days",document.getElementById("sitetime").innerHTML=e):(document.getElementById("year").innerHTML=t+" - "+n,o="This site has been running for "+r+" years and "+o+" days",document.getElementById("sitetime").innerHTML=o)};calcSiteTime()</script><br><div class="github-badge"><a style="color:#fff" rel="license" href="https://github.com/" target="_blank" title="静态网页托管于 GitHub Pages"><span class="badge-subject">Hosted</span> <span class="badge-value bg-brightgreen">GitHub</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://www.cloudflare.com/" target="_blank" title="Cloudflare提供域名相关服务"><span class="badge-subject">DNS</span> <span class="badge-value bg-blueviolet">Cloudflare</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://publit.io/" target="_blank" title="Publitio提供图片存储"><span class="badge-subject">Image</span> <span class="badge-value bg-red">Publitio</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="本站点采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可"><span class="badge-subject"><i class="fa fa-copyright"></i></span> <span class="badge-value bg-lightgrey">CC BY 4.0</span></a></div><style>.github-badge{display:inline-block;border-radius:4px;text-shadow:none;font-size:13px;color:#fff;line-height:15px;background-color:#abbac3;margin-bottom:5px}.github-badge .badge-subject{display:inline-block;background-color:#4d4d4d;padding:4px 4px 4px 6px;border-top-left-radius:4px;border-bottom-left-radius:4px}.github-badge .badge-value{display:inline-block;padding:4px 6px 4px 4px;border-top-right-radius:4px;border-bottom-right-radius:4px}.github-badge .bg-brightgreen{background-color:#4dc820!important}.github-badge .bg-orange{background-color:orange!important}.github-badge .bg-yellow{background-color:#d8b024!important}.github-badge .bg-blueviolet{background-color:#8833d7!important}.github-badge .bg-pink{background-color:#f26bae!important}.github-badge .bg-red{background-color:#e05d44!important}.github-badge .bg-blue{background-color:#007ec6!important}.github-badge .bg-lightgrey{background-color:#9f9f9f!important}.github-badge .bg-gray,.github-badge .bg-grey{background-color:#555!important}.github-badge .bg-lightgray,.github-badge .bg-lightgrey{background-color:#9f9f9f!important}</style></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/qiangwennorge" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:qiang.wen.norge@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span> <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword" class="search-input"></div><div id="searchResult"></div></div></div><script type="text/javascript">$(function(){!function(t,r,s){"use strict";$.ajax({url:t,dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),t=document.getElementById(r),n=document.getElementById(s);t.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(e.forEach(function(t){var n,e,r,s=!0,i=t.title.trim().toLowerCase(),l=t.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),a=0===(a=t.url).indexOf("/")?t.url:"/"+a,c=-1,u=-1;""!==i&&""!==l&&h.forEach(function(t,e){n=i.indexOf(t),c=l.indexOf(t),n<0&&c<0?s=!1:(c<0&&(c=0),0===e&&(u=c))}),s&&(o+="<li><a href='"+a+"' class='search-result-title'>"+i+"</a>",e=t.content.trim().replace(/<[^>]+>/g,""),0<=u&&(a=u+80,(a=0===(t=(t=u-20)<0?0:t)?100:a)>e.length&&(a=e.length),r=e.substr(t,a),h.forEach(function(t){var e=new RegExp(t,"gi");r=r.replace(e,'<em class="search-keyword">'+t+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})}("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script type="text/javascript">var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>')</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?96c14430edaa02f468fca771961be30b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script type="text/javascript" color="0,0,255" pointcolor="104,33,122" opacity="0.7" zindex="-1" count="99" src="/libs/background/canvas-nest.js"></script><script type="text/javascript" size="150" alpha="0.6" zindex="-1" src="/libs/background/ribbon.min.js" async></script><script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script type="text/javascript">var st,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="Wenvenn",clearTimeout(st)):(document.title="Welcome Back!",st=setTimeout(function(){document.title=OriginTitile},3e3))})</script></body></html>